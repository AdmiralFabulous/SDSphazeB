[
  {
    "title": "Install and integrate Vibe Kanban Web Companion",
    "status": "inprogress",
    "labels": [
      "in-progress"
    ],
    "body": "Goal: Install and integrate the vibe-kanban-web-companion so it renders at the app root in development.\n\nDo:\n1) Detect package manager from lockfiles and use it:\n   - pnpm-lock.yaml \u2192 pnpm add vibe-kanban-web-companion\n   - yarn.lock \u2192 yarn add vibe-kanban-web-companion\n   - package-lock.json \u2192 npm i vibe-kanban-web-companion\n   - bun.lockb \u2192 bun add vibe-kanban-web-companion\n   If already listed in package.json dependencies, skip install.\n\n2) Detect framework and app entry:\n   - Next.js (pages router): pages/_app.(tsx|js)\n   - Next.js (app router): app/layout.(tsx|js) or an app/providers.(tsx|js)\n   - Vite/CRA: src/main.(tsx|jsx|ts|js) and src/App.(tsx|jsx|ts|js)\n   - Monorepo: operate in the correct package for the web app.\n   Confirm by reading package.json and directory structure.\n\n3) Integrate the component:\n   import { VibeKanbanWebCompanion } from 'vibe-kanban-web-companion';\n   - Vite/CRA: render <VibeKanbanWebCompanion /> at the app root.\n   - Next.js (pages): render in pages/_app.*\n   - Next.js (app): render in app/layout.* or a client providers component.\n   - For Next.js, if SSR issues arise, use dynamic import with ssr: false.\n\n4) Verify:\n   - Type-check, lint/format if configured.\n   - Ensure it compiles and renders without SSR/hydration errors.\n\nAcceptance:\n- vibe-kanban-web-companion is installed in the correct package.\n- The component is rendered once at the app root without SSR/hydration errors.\n- Build/type-check passes.\n\n---\n**Branches:**\n- `vk/6ceb-install-and-inte`\n",
    "branches": [
      "vk/6ceb-install-and-inte"
    ]
  },
  {
    "title": "Install and integrate Vibe Kanban Web Companion",
    "status": "done",
    "labels": [
      "done"
    ],
    "body": "Goal: Install and integrate the vibe-kanban-web-companion so it renders at the app root in development.\n\nDo:\n1) Detect package manager from lockfiles and use it:\n   - pnpm-lock.yaml \u2192 pnpm add vibe-kanban-web-companion\n   - yarn.lock \u2192 yarn add vibe-kanban-web-companion\n   - package-lock.json \u2192 npm i vibe-kanban-web-companion\n   - bun.lockb \u2192 bun add vibe-kanban-web-companion\n   If already listed in package.json dependencies, skip install.\n\n2) Detect framework and app entry:\n   - Next.js (pages router): pages/_app.(tsx|js)\n   - Next.js (app router): app/layout.(tsx|js) or an app/providers.(tsx|js)\n   - Vite/CRA: src/main.(tsx|jsx|ts|js) and src/App.(tsx|jsx|ts|js)\n   - Monorepo: operate in the correct package for the web app.\n   Confirm by reading package.json and directory structure.\n\n3) Integrate the component:\n   import { VibeKanbanWebCompanion } from 'vibe-kanban-web-companion';\n   - Vite/CRA: render <VibeKanbanWebCompanion /> at the app root.\n   - Next.js (pages): render in pages/_app.*\n   - Next.js (app): render in app/layout.* or a client providers component.\n   - For Next.js, if SSR issues arise, use dynamic import with ssr: false.\n\n4) Verify:\n   - Type-check, lint/format if configured.\n   - Ensure it compiles and renders without SSR/hydration errors.\n\nAcceptance:\n- vibe-kanban-web-companion is installed in the correct package.\n- The component is rendered once at the app root without SSR/hydration errors.\n- Build/type-check passes.\n\n---\n**Branches:**\n- `vk/8b0a-install-and-inte`\n",
    "branches": [
      "vk/8b0a-install-and-inte"
    ]
  },
  {
    "title": "TEST-E02-S01-T06: Test Mobile Runner",
    "status": "todo",
    "labels": [
      "todo",
      "test"
    ],
    "body": "## Metadata\n- **Task ID:** TEST-E02-S01-T06\n- **Module:** Testing & QA\n- **Epic:** Epic 02\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nRunner completes tasks on mobile\n\n**File:** `e2e/runner-mobile.spec.ts`\n\n## Acceptance Criteria\n- Mobile layout works\r\n- Touch interactions work\r\n- Ruler test pass/fail works\r\n- Task completion works\r\n\r\n---\r\n\r\n# Summary\r\n\r\n| Epic | Story | Tasks | Status |\r\n|------|-------|-------|--------|\r\n| TEST-E01 | S01: Frontend Unit Tests | 5 | Detailed |\r\n| TEST-E01 | S02: Backend Unit Tests | 5 | Detailed |\r\n| TEST-E02 | S01: E2E Flow Tests | 6 | Detailed |\r\n| **Total** | | **16** | |\r\n\r\n---\r\n\r\n*End of TEST Module Detailed Tasks*\n\n---\n**Branches:**\n- `vk/ca16-test-e02-s01-t06`\n- `vk/49d9-test-e02-s01-t06`\n- `vk/2c64-test-e02-s01-t06`\n",
    "branches": [
      "vk/ca16-test-e02-s01-t06",
      "vk/49d9-test-e02-s01-t06",
      "vk/2c64-test-e02-s01-t06"
    ]
  },
  {
    "title": "TEST-E02-S01-T05: Test Admin Flow",
    "status": "todo",
    "labels": [
      "todo",
      "test"
    ],
    "body": "## Metadata\n- **Task ID:** TEST-E02-S01-T05\n- **Module:** Testing & QA\n- **Epic:** Epic 02\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nOperator processes order through states\n\n**File:** `e2e/admin-flow.spec.ts`\n\n## Acceptance Criteria\n- Admin login works\r\n- Queue filtering works\r\n- State transitions work\r\n- Pattern upload works\r\n\r\n---\n\n---\n**Branches:**\n- `vk/f5e9-test-e02-s01-t05`\n- `vk/c8a3-test-e02-s01-t05`\n- `vk/0698-test-e02-s01-t05`\n",
    "branches": [
      "vk/f5e9-test-e02-s01-t05",
      "vk/c8a3-test-e02-s01-t05",
      "vk/0698-test-e02-s01-t05"
    ]
  },
  {
    "title": "TEST-E02-S01-T04: Test Track B Attendee",
    "status": "todo",
    "labels": [
      "todo",
      "test"
    ],
    "body": "## Metadata\n- **Task ID:** TEST-E02-S01-T04\n- **Module:** Testing & QA\n- **Epic:** Epic 02\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nAttendee completes measurements via invite\n\n**File:** `e2e/track-b-attendee.spec.ts`\n\n## Acceptance Criteria\n- Invite link works\r\n- Template locked correctly\r\n- Measurement flow completes\r\n\r\n---\n\n---\n**Branches:**\n- `vk/746a-test-e02-s01-t04`\n- `vk/104b-test-e02-s01-t04`\n- `vk/b8b9-test-e02-s01-t04`\n",
    "branches": [
      "vk/746a-test-e02-s01-t04",
      "vk/104b-test-e02-s01-t04",
      "vk/b8b9-test-e02-s01-t04"
    ]
  },
  {
    "title": "TEST-E02-S01-T03: Test Track B Organizer",
    "status": "todo",
    "labels": [
      "todo",
      "test"
    ],
    "body": "## Metadata\n- **Task ID:** TEST-E02-S01-T03\n- **Module:** Testing & QA\n- **Epic:** Epic 02\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nWedding organizer creates event and invites\n\n**File:** `e2e/track-b-organizer.spec.ts`\n\n## Acceptance Criteria\n- Event creation works\r\n- Template design works\r\n- Invite sending works\r\n\r\n---\n\n---\n**Branches:**\n- `vk/d4cf-test-e02-s01-t03`\n- `vk/15ad-test-e02-s01-t03`\n- `vk/5172-test-e02-s01-t03`\n",
    "branches": [
      "vk/d4cf-test-e02-s01-t03",
      "vk/15ad-test-e02-s01-t03",
      "vk/5172-test-e02-s01-t03"
    ]
  },
  {
    "title": "TEST-E02-S01-T02: Test Track A Journey",
    "status": "todo",
    "labels": [
      "todo",
      "test"
    ],
    "body": "## Metadata\n- **Task ID:** TEST-E02-S01-T02\n- **Module:** Testing & QA\n- **Epic:** Epic 02\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nAnonymous user to checkout flow\n\n**File:** `e2e/track-a-journey.spec.ts`\n\n## Acceptance Criteria\n- Full flow works\r\n- Session persists\r\n- Navigation correct\r\n\r\n---\n\n---\n**Branches:**\n- `vk/c333-test-e02-s01-t02`\n- `vk/94ed-test-e02-s01-t02`\n- `vk/d4e5-test-e02-s01-t02`\n",
    "branches": [
      "vk/c333-test-e02-s01-t02",
      "vk/94ed-test-e02-s01-t02",
      "vk/d4e5-test-e02-s01-t02"
    ]
  },
  {
    "title": "TEST-E02-S01-T01: Configure Playwright",
    "status": "todo",
    "labels": [
      "todo",
      "test"
    ],
    "body": "## Metadata\n- **Task ID:** TEST-E02-S01-T01\n- **Module:** Testing & QA\n- **Epic:** Epic 02\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nSet up E2E testing with Playwright\r\n\r\n**Commands:**\n\n**File:** `playwright.config.ts`\n\n## Acceptance Criteria\n- Playwright configured\r\n- Multiple browsers tested\r\n- Mobile viewports included\r\n\r\n---\n\n---\n**Branches:**\n- `vk/4f01-test-e02-s01-t01`\n- `vk/e467-test-e02-s01-t01`\n- `vk/46d0-test-e02-s01-t01`\n",
    "branches": [
      "vk/4f01-test-e02-s01-t01",
      "vk/e467-test-e02-s01-t01",
      "vk/46d0-test-e02-s01-t01"
    ]
  },
  {
    "title": "TEST-E01-S02-T05: Test Webhook",
    "status": "todo",
    "labels": [
      "todo",
      "test"
    ],
    "body": "## Metadata\n- **Task ID:** TEST-E01-S02-T05\n- **Module:** Testing & QA\n- **Epic:** Epic 01\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\n**File:** `src/app/api/webhook/__tests__/stripe.test.ts`\n\n## Acceptance Criteria\n- Signature verification tested\r\n- Event handling tested\r\n- Order creation tested\r\n\r\n---\r\n\r\n# EPIC TEST-E02: Integration Tests\r\n\r\n## Story TEST-E02-S01: End-to-End Flow Tests\n\n---\n**Branches:**\n- `vk/f6a5-test-e01-s02-t05`\n- `vk/0976-test-e01-s02-t05`\n- `vk/3ed6-test-e01-s02-t05`\n",
    "branches": [
      "vk/f6a5-test-e01-s02-t05",
      "vk/0976-test-e01-s02-t05",
      "vk/3ed6-test-e01-s02-t05"
    ]
  },
  {
    "title": "TEST-E01-S02-T04: Test Order API",
    "status": "todo",
    "labels": [
      "todo",
      "test"
    ],
    "body": "\n\n**File:** `src/app/api/orders/__tests__/state.test.ts`\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/b1c1-test-e01-s02-t04`\n- `vk/90bf-test-e01-s02-t04`\n- `vk/f8a2-test-e01-s02-t04`\n",
    "branches": [
      "vk/b1c1-test-e01-s02-t04",
      "vk/90bf-test-e01-s02-t04",
      "vk/f8a2-test-e01-s02-t04"
    ]
  },
  {
    "title": "TEST-E01-S02-T03: Test Wedding API",
    "status": "todo",
    "labels": [
      "todo",
      "test"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/1aa1-test-e01-s02-t03`\n- `vk/e581-test-e01-s02-t03`\n- `vk/3338-test-e01-s02-t03`\n- `vk/ca4f-test-e01-s02-t03`\n",
    "branches": [
      "vk/1aa1-test-e01-s02-t03",
      "vk/e581-test-e01-s02-t03",
      "vk/3338-test-e01-s02-t03",
      "vk/ca4f-test-e01-s02-t03"
    ]
  },
  {
    "title": "TEST-E01-S02-T02: Test Config API",
    "status": "todo",
    "labels": [
      "todo",
      "test"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/d5b3-test-e01-s02-t02`\n- `vk/2b92-test-e01-s02-t02`\n- `vk/05ca-test-e01-s02-t02`\n- `vk/5ec5-test-e01-s02-t02`\n",
    "branches": [
      "vk/d5b3-test-e01-s02-t02",
      "vk/2b92-test-e01-s02-t02",
      "vk/05ca-test-e01-s02-t02",
      "vk/5ec5-test-e01-s02-t02"
    ]
  },
  {
    "title": "TEST-E01-S02-T01: Test Session API",
    "status": "todo",
    "labels": [
      "todo",
      "test"
    ],
    "body": "## Metadata\n- **Task ID:** TEST-E01-S02-T01\n- **Module:** Testing & QA\n- **Epic:** Epic 01\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nTest session endpoints\n\n**File:** `src/app/api/sessions/__tests__/route.test.ts`\n\n## Acceptance Criteria\n- POST creates session\r\n- GET retrieves session\r\n- Error handling tested\r\n\r\n---\n\n---\n**Branches:**\n- `vk/8ce9-test-e01-s02-t01`\n- `vk/b5b2-test-e01-s02-t01`\n- `vk/4cc2-test-e01-s02-t01`\n- `vk/bb15-test-e01-s02-t01`\n",
    "branches": [
      "vk/8ce9-test-e01-s02-t01",
      "vk/b5b2-test-e01-s02-t01",
      "vk/4cc2-test-e01-s02-t01",
      "vk/bb15-test-e01-s02-t01"
    ]
  },
  {
    "title": "TEST-E01-S01-T05: Test Utilities",
    "status": "todo",
    "labels": [
      "todo",
      "test"
    ],
    "body": "## Metadata\n- **Task ID:** TEST-E01-S01-T05\n- **Module:** Testing & QA\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nTest helper functions\n\n**File:** `src/lib/__tests__/utils.test.ts`\n\n## Acceptance Criteria\n- All utility functions tested\r\n- Edge cases covered\r\n- Calculation accuracy verified\r\n\r\n---\r\n\r\n## Story TEST-E01-S02: Backend Unit Tests\n\n---\n**Branches:**\n- `vk/7db1-test-e01-s01-t05`\n- `vk/4a59-test-e01-s01-t05`\n- `vk/d874-test-e01-s01-t05`\n",
    "branches": [
      "vk/7db1-test-e01-s01-t05",
      "vk/4a59-test-e01-s01-t05",
      "vk/d874-test-e01-s01-t05"
    ]
  },
  {
    "title": "TEST-E01-S01-T04: Test Hooks",
    "status": "todo",
    "labels": [
      "todo",
      "test"
    ],
    "body": "## Metadata\n- **Task ID:** TEST-E01-S01-T04\n- **Module:** Testing & QA\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nTest custom hooks\n\n**File:** `src/hooks/__tests__/useSession.test.ts`\n\n## Acceptance Criteria\n- Hooks return correct values\r\n- Side effects tested\r\n- Async behavior tested\r\n- Cleanup tested\r\n\r\n---\n\n---\n**Branches:**\n- `vk/af99-test-e01-s01-t04`\n- `vk/4b2d-test-e01-s01-t04`\n- `vk/24e5-test-e01-s01-t04`\n- `vk/fc5b-test-e01-s01-t04`\n",
    "branches": [
      "vk/af99-test-e01-s01-t04",
      "vk/4b2d-test-e01-s01-t04",
      "vk/24e5-test-e01-s01-t04",
      "vk/fc5b-test-e01-s01-t04"
    ]
  },
  {
    "title": "TEST-E01-S01-T03: Test UI Components",
    "status": "todo",
    "labels": [
      "todo",
      "test"
    ],
    "body": "## Metadata\n- **Task ID:** TEST-E01-S01-T03\n- **Module:** Testing & QA\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nTest components with React Testing Library\n\n**File:** `src/components/__tests__/FabricSelector.test.tsx`\n\n## Acceptance Criteria\n- Components render correctly\r\n- User interactions work\r\n- Store integration tested\r\n- Loading/error states tested\r\n\r\n---\n\n---\n**Branches:**\n- `vk/9431-test-e01-s01-t03`\n- `vk/1c42-test-e01-s01-t03`\n- `vk/df7b-test-e01-s01-t03`\n",
    "branches": [
      "vk/9431-test-e01-s01-t03",
      "vk/1c42-test-e01-s01-t03",
      "vk/df7b-test-e01-s01-t03"
    ]
  },
  {
    "title": "TEST-E01-S01-T02: Test Zustand Store",
    "status": "todo",
    "labels": [
      "todo",
      "test"
    ],
    "body": "## Metadata\n- **Task ID:** TEST-E01-S01-T02\n- **Module:** Testing & QA\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nTest all store slices and actions\n\n**File:** `src/store/__tests__/sessionSlice.test.ts`\n\n## Acceptance Criteria\n- All slices have tests\r\n- Actions tested\r\n- State changes verified\r\n- Edge cases covered\r\n\r\n---\n\n---\n**Branches:**\n- `vk/ab0e-test-e01-s01-t02`\n- `vk/c78d-test-e01-s01-t02`\n- `vk/52c1-test-e01-s01-t02`\n",
    "branches": [
      "vk/ab0e-test-e01-s01-t02",
      "vk/c78d-test-e01-s01-t02",
      "vk/52c1-test-e01-s01-t02"
    ]
  },
  {
    "title": "TEST-E01-S01-T01: Configure Jest",
    "status": "todo",
    "labels": [
      "todo",
      "test"
    ],
    "body": "## Metadata\n- **Task ID:** TEST-E01-S01-T01\n- **Module:** Testing & QA\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nSet up Jest for Next.js 14\r\n\r\n**Commands:**\n\n**File:** `jest.config.js`\n\n## Acceptance Criteria\n- Jest configured for Next.js\r\n- Testing Library available\r\n- Mocks set up for common modules\r\n- Coverage thresholds defined\r\n\r\n---\n\n---\n**Branches:**\n- `vk/173f-test-e01-s01-t01`\n- `vk/5982-test-e01-s01-t01`\n- `vk/19ef-test-e01-s01-t01`\n",
    "branches": [
      "vk/173f-test-e01-s01-t01",
      "vk/5982-test-e01-s01-t01",
      "vk/19ef-test-e01-s01-t01"
    ]
  },
  {
    "title": "VOICE-E01-S04-T04: Auto-Advance UI",
    "status": "inreview",
    "labels": [
      "in-review",
      "voice"
    ],
    "body": "## Metadata\n- **Task ID:** VOICE-E01-S04-T04\n- **Module:** Voice Integration\n- **Epic:** Epic 01\n- **Story:** Story 04\n- **Phase:** 1\n- **Prerequisites:** None\n\nMove to next step on voice command completion\n\n**File:** `src/components/scanner/AutoAdvanceController.tsx`\n\n## Acceptance Criteria\n- UI advances on completion phrases\r\n- Calibration \u2192 Scanning \u2192 Complete flow\r\n- Auto-navigation to measurements\r\n- Configurable via props\r\n\r\n---\r\n\r\n# Summary\r\n\r\n| Epic | Story | Tasks | Status |\r\n|------|-------|-------|--------|\r\n| VOICE-E01 | S01: Vapi.ai Setup | 5 | Detailed |\r\n| VOICE-E01 | S02: Vision Telemetry Integration | 4 | Detailed |\r\n| VOICE-E01 | S03: State-Driven Dialogue | 4 | Detailed |\r\n| VOICE-E01 | S04: Frontend Integration | 4 | Detailed |\r\n| **Total** | | **17** | |\r\n\r\n---\r\n\r\n*End of VOICE Module Detailed Tasks*\n\n---\n**Branches:**\n- `vk/3b75-voice-e01-s04-t0`\n- `vk/63ee-voice-e01-s04-t0`\n- `vk/b25b-voice-e01-s04-t0`\n",
    "branches": [
      "vk/3b75-voice-e01-s04-t0",
      "vk/63ee-voice-e01-s04-t0",
      "vk/b25b-voice-e01-s04-t0"
    ]
  },
  {
    "title": "VOICE-E01-S04-T03: Handle Function Calls",
    "status": "done",
    "labels": [
      "done",
      "voice"
    ],
    "body": "## Metadata\n- **Task ID:** VOICE-E01-S04-T03\n- **Module:** Voice Integration\n- **Epic:** Epic 01\n- **Story:** Story 04\n- **Phase:** 1\n- **Prerequisites:** None\n\nReact to AI-triggered events in the UI\n\n**File:** `src/hooks/useVoiceEvents.ts`\n\n## Acceptance Criteria\n- UI reacts to voice events\r\n- Speed warning shown visually\r\n- Phase transitions handled\r\n- Progress synchronized\r\n\r\n---\n\n---\n**Branches:**\n- `vk/c02a-voice-e01-s04-t0`\n- `vk/7c4c-voice-e01-s04-t0`\n- `vk/2c54-voice-e01-s04-t0`\n",
    "branches": [
      "vk/c02a-voice-e01-s04-t0",
      "vk/7c4c-voice-e01-s04-t0",
      "vk/2c54-voice-e01-s04-t0"
    ]
  },
  {
    "title": "VOICE-E01-S04-T02: Build Voice Toggle",
    "status": "done",
    "labels": [
      "done",
      "voice"
    ],
    "body": "## Metadata\n- **Task ID:** VOICE-E01-S04-T02\n- **Module:** Voice Integration\n- **Epic:** Epic 01\n- **Story:** Story 04\n- **Phase:** 1\n- **Prerequisites:** None\n\nButton to start/stop voice assistant\n\n**File:** `src/components/scanner/VoiceToggle.tsx`\n\n## Acceptance Criteria\n- Toggle button starts/stops voice\r\n- Visual feedback for state\r\n- Speaking indicator\r\n- Session ID passed to assistant\r\n\r\n---\n\n---\n**Branches:**\n- `vk/6091-voice-e01-s04-t0`\n- `vk/7621-voice-e01-s04-t0`\n- `vk/b215-voice-e01-s04-t0`\n",
    "branches": [
      "vk/6091-voice-e01-s04-t0",
      "vk/7621-voice-e01-s04-t0",
      "vk/b215-voice-e01-s04-t0"
    ]
  },
  {
    "title": "VOICE-E01-S04-T01: Install Vapi SDK",
    "status": "inreview",
    "labels": [
      "in-review",
      "voice"
    ],
    "body": "## Metadata\n- **Task ID:** VOICE-E01-S04-T01\n- **Module:** Voice Integration\n- **Epic:** Epic 01\n- **Story:** Story 04\n- **Phase:** 1\n- **Prerequisites:** None\n\nAdd @vapi-ai/web package\r\n\r\n**Commands:**\n\n**File:** `src/lib/vapi-client.ts`\n\n## Acceptance Criteria\n- SDK installed\r\n- Client singleton created\r\n- Cleanup function available\r\n\r\n---\n\n---\n**Branches:**\n- `vk/0193-voice-e01-s04-t0`\n- `vk/2449-voice-e01-s04-t0`\n- `vk/1add-voice-e01-s04-t0`\n",
    "branches": [
      "vk/0193-voice-e01-s04-t0",
      "vk/2449-voice-e01-s04-t0",
      "vk/1add-voice-e01-s04-t0"
    ]
  },
  {
    "title": "VOICE-E01-S03-T04: Implement Completion",
    "status": "done",
    "labels": [
      "done",
      "voice"
    ],
    "body": "Announce scan complete\r\n\r\n*LLM uses get_scan_status function and celebrates completion*\r\n\r\n---\r\n\r\n## Story VOICE-E01-S04: Frontend Integration\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/d8f2-voice-e01-s03-t0`\n- `vk/622b-voice-e01-s03-t0`\n- `vk/2d0c-voice-e01-s03-t0`\n- `vk/ff7e-voice-e01-s03-t0`\n",
    "branches": [
      "vk/d8f2-voice-e01-s03-t0",
      "vk/622b-voice-e01-s03-t0",
      "vk/2d0c-voice-e01-s03-t0",
      "vk/ff7e-voice-e01-s03-t0"
    ]
  },
  {
    "title": "VOICE-E01-S03-T03: Implement Speed Warning",
    "status": "done",
    "labels": [
      "done",
      "voice"
    ],
    "body": "Interrupt if rotating too fast\r\n\r\n*LLM uses check_speed_warning function and responds accordingly*\r\n\r\n---\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/b82a-voice-e01-s03-t0`\n- `vk/6948-voice-e01-s03-t0`\n- `vk/3893-voice-e01-s03-t0`\n- `vk/f2a5-voice-e01-s03-t0`\n",
    "branches": [
      "vk/b82a-voice-e01-s03-t0",
      "vk/6948-voice-e01-s03-t0",
      "vk/3893-voice-e01-s03-t0",
      "vk/f2a5-voice-e01-s03-t0"
    ]
  },
  {
    "title": "VOICE-E01-S03-T02: Implement Calibration Dialogue",
    "status": "inreview",
    "labels": [
      "in-review",
      "voice"
    ],
    "body": "Guide user to hold calibration paper\r\n\r\n*Implemented via system prompt and function tools*\r\n\r\n---\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/148e-voice-e01-s03-t0`\n- `vk/0be2-voice-e01-s03-t0`\n- `vk/ee18-voice-e01-s03-t0`\n",
    "branches": [
      "vk/148e-voice-e01-s03-t0",
      "vk/0be2-voice-e01-s03-t0",
      "vk/ee18-voice-e01-s03-t0"
    ]
  },
  {
    "title": "VOICE-E01-S03-T01: Define Function Tools",
    "status": "done",
    "labels": [
      "done",
      "voice"
    ],
    "body": "## Metadata\n- **Task ID:** VOICE-E01-S03-T01\n- **Module:** Voice Integration\n- **Epic:** Epic 01\n- **Story:** Story 03\n- **Phase:** 1\n- **Prerequisites:** None\n\nVapi function definitions for scan status\n\n**File:** `src/app/api/vapi/functions/route.ts`\n\n## Acceptance Criteria\n- Functions defined in Vapi\r\n- Server endpoint handles calls\r\n- Returns relevant scan data\r\n\r\n---\n\n---\n**Branches:**\n- `vk/eff3-voice-e01-s03-t0`\n- `vk/0977-voice-e01-s03-t0`\n- `vk/b8fb-voice-e01-s03-t0`\n",
    "branches": [
      "vk/eff3-voice-e01-s03-t0",
      "vk/0977-voice-e01-s03-t0",
      "vk/b8fb-voice-e01-s03-t0"
    ]
  },
  {
    "title": "VOICE-E01-S02-T04: Expose Frame Quality",
    "status": "inreview",
    "labels": [
      "in-review",
      "voice"
    ],
    "body": "Include user_in_frame: boolean in status\r\n\r\n*Implemented in scan/status endpoint above*\r\n\r\n---\r\n\r\n## Story VOICE-E01-S03: State-Driven Dialogue\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/700e-voice-e01-s02-t0`\n- `vk/b7e6-voice-e01-s02-t0`\n- `vk/9b30-voice-e01-s02-t0`\n- `vk/b577-voice-e01-s02-t0`\n",
    "branches": [
      "vk/700e-voice-e01-s02-t0",
      "vk/b7e6-voice-e01-s02-t0",
      "vk/9b30-voice-e01-s02-t0",
      "vk/b577-voice-e01-s02-t0"
    ]
  },
  {
    "title": "VOICE-E01-S02-T03: Expose Rotation Speed",
    "status": "inreview",
    "labels": [
      "in-review",
      "voice"
    ],
    "body": "Include rotation_speed: number in status\r\n\r\n*Implemented in scan/status endpoint above*\r\n\r\n---\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/2a23-voice-e01-s02-t0`\n- `vk/f20f-voice-e01-s02-t0`\n- `vk/62f3-voice-e01-s02-t0`\n",
    "branches": [
      "vk/2a23-voice-e01-s02-t0",
      "vk/f20f-voice-e01-s02-t0",
      "vk/62f3-voice-e01-s02-t0"
    ]
  },
  {
    "title": "VOICE-E01-S02-T02: Expose ArUco Status",
    "status": "inreview",
    "labels": [
      "in-review",
      "voice"
    ],
    "body": "Include aruco_visible: boolean in status\r\n\r\n*Implemented in scan/status endpoint above*\r\n\r\n---\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/ac1c-voice-e01-s02-t0`\n- `vk/1c0d-voice-e01-s02-t0`\n- `vk/63ec-voice-e01-s02-t0`\n- `vk/bbcb-voice-e01-s02-t0`\n",
    "branches": [
      "vk/ac1c-voice-e01-s02-t0",
      "vk/1c0d-voice-e01-s02-t0",
      "vk/63ec-voice-e01-s02-t0",
      "vk/bbcb-voice-e01-s02-t0"
    ]
  },
  {
    "title": "VOICE-E01-S02-T01: Create Telemetry Endpoint",
    "status": "inreview",
    "labels": [
      "in-review",
      "voice"
    ],
    "body": "## Metadata\n- **Task ID:** VOICE-E01-S02-T01\n- **Module:** Voice Integration\n- **Epic:** Epic 01\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nGET /api/scan/status returns current scan state\n\n**File:** `src/app/api/scan/status/route.ts`\n\n## Acceptance Criteria\n- Returns current scan state\r\n- Includes all telemetry data\r\n- Fast response for real-time use\r\n\r\n---\n\n---\n**Branches:**\n- `vk/8e3a-voice-e01-s02-t0`\n- `vk/2389-voice-e01-s02-t0`\n- `vk/cc26-voice-e01-s02-t0`\n",
    "branches": [
      "vk/8e3a-voice-e01-s02-t0",
      "vk/2389-voice-e01-s02-t0",
      "vk/cc26-voice-e01-s02-t0"
    ]
  },
  {
    "title": "VOICE-E01-S01-T05: Select TTS",
    "status": "inreview",
    "labels": [
      "in-review",
      "voice"
    ],
    "body": "## Metadata\n- **Task ID:** VOICE-E01-S01-T05\n- **Module:** Voice Integration\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nConfigure ElevenLabs for natural voice\r\n\r\n**TTS Configuration:**\n\n## Acceptance Criteria\n- ElevenLabs voice selected\r\n- Settings tuned for clarity\r\n- Low latency model chosen\r\n\r\n---\r\n\r\n## Story VOICE-E01-S02: Vision Telemetry Integration\n\n---\n**Branches:**\n- `vk/8e4b-voice-e01-s01-t0`\n- `vk/1d55-voice-e01-s01-t0`\n- `vk/e732-voice-e01-s01-t0`\n",
    "branches": [
      "vk/8e4b-voice-e01-s01-t0",
      "vk/1d55-voice-e01-s01-t0",
      "vk/e732-voice-e01-s01-t0"
    ]
  },
  {
    "title": "VOICE-E01-S01-T04: Select LLM",
    "status": "inreview",
    "labels": [
      "in-review",
      "voice"
    ],
    "body": "## Metadata\n- **Task ID:** VOICE-E01-S01-T04\n- **Module:** Voice Integration\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nConfigure GPT-4o for intelligence\r\n\r\n**LLM Configuration in Vapi:**\n\n## Acceptance Criteria\n- GPT-4o selected\r\n- Temperature set for natural responses\r\n- Token limit prevents rambling\r\n\r\n---\n\n---\n**Branches:**\n- `vk/3789-voice-e01-s01-t0`\n- `vk/9ec7-voice-e01-s01-t0`\n- `vk/b656-voice-e01-s01-t0`\n",
    "branches": [
      "vk/3789-voice-e01-s01-t0",
      "vk/9ec7-voice-e01-s01-t0",
      "vk/b656-voice-e01-s01-t0"
    ]
  },
  {
    "title": "VOICE-E01-S01-T03: Write System Prompt",
    "status": "inreview",
    "labels": [
      "in-review",
      "voice"
    ],
    "body": "## Metadata\n- **Task ID:** VOICE-E01-S01-T03\n- **Module:** Voice Integration\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nDefine personality and goals for the voice assistant\r\n\r\n**System Prompt:**\n\n## Acceptance Criteria\n- Personality defined\r\n- Functions listed\r\n- Example dialogues provided\r\n- Interaction rules clear\r\n\r\n---\n\n---\n**Branches:**\n- `vk/ae40-voice-e01-s01-t0`\n- `vk/bb41-voice-e01-s01-t0`\n- `vk/1b48-voice-e01-s01-t0`\n",
    "branches": [
      "vk/ae40-voice-e01-s01-t0",
      "vk/bb41-voice-e01-s01-t0",
      "vk/1b48-voice-e01-s01-t0"
    ]
  },
  {
    "title": "VOICE-E01-S01-T02: Configure Assistant",
    "status": "inreview",
    "labels": [
      "in-review",
      "voice"
    ],
    "body": "## Metadata\n- **Task ID:** VOICE-E01-S01-T02\n- **Module:** Voice Integration\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nCreate Scan Director persona in Vapi dashboard\r\n\r\n**Vapi Assistant Configuration:**\n\n## Acceptance Criteria\n- Assistant created in Vapi\r\n- Voice and LLM configured\r\n- First message set\r\n\r\n---\n\n---\n**Branches:**\n- `vk/fd29-voice-e01-s01-t0`\n- `vk/335d-voice-e01-s01-t0`\n- `vk/03ab-voice-e01-s01-t0`\n",
    "branches": [
      "vk/fd29-voice-e01-s01-t0",
      "vk/335d-voice-e01-s01-t0",
      "vk/03ab-voice-e01-s01-t0"
    ]
  },
  {
    "title": "VOICE-E01-S01-T01: Create Vapi Account",
    "status": "inreview",
    "labels": [
      "in-review",
      "voice"
    ],
    "body": "## Metadata\n- **Task ID:** VOICE-E01-S01-T01\n- **Module:** Voice Integration\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nSet up Vapi.ai dashboard account\r\n\r\n**Setup Steps:**\r\n1. Sign up at vapi.ai\r\n2. Verify email and complete onboarding\r\n3. Enable billing for production usage\r\n4. Note API credentials\n\n**File:** `src/lib/vapi.ts`\n\n## Acceptance Criteria\n- Vapi account active\r\n- API keys obtained\r\n- Billing configured\r\n\r\n---\n\n---\n**Branches:**\n- `vk/a0c0-voice-e01-s01-t0`\n- `vk/b896-voice-e01-s01-t0`\n- `vk/92b1-voice-e01-s01-t0`\n",
    "branches": [
      "vk/a0c0-voice-e01-s01-t0",
      "vk/b896-voice-e01-s01-t0",
      "vk/92b1-voice-e01-s01-t0"
    ]
  },
  {
    "title": "FIN-E01-S02-T05: Handle Track B Specifics",
    "status": "done",
    "labels": [
      "done",
      "fin"
    ],
    "body": "## Metadata\n- **Task ID:** FIN-E01-S02-T05\n- **Module:** Financial & Payments\n- **Epic:** Epic 01\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nCreate order_items for all wedding attendees\n\n**File:** `src/lib/webhook-handlers/track-b.ts`\n\n## Acceptance Criteria\n- Order linked to wedding event\r\n- Order item per attendee\r\n- Pending measurement status for incomplete attendees\r\n- Organizer notified\r\n\r\n---\r\n\r\n# Summary\r\n\r\n| Epic | Story | Tasks | Status |\r\n|------|-------|-------|--------|\r\n| FIN-E01 | S01: Payment Processing | 5 | Detailed |\r\n| FIN-E01 | S02: Webhook Handling | 5 | Detailed |\r\n| **Total** | | **10** | |\r\n\r\n---\r\n\r\n*End of FIN Module Detailed Tasks*\n\n---\n**Branches:**\n- `vk/4209-fin-e01-s02-t05`\n- `vk/9f4f-fin-e01-s02-t05`\n- `vk/5cb8-fin-e01-s02-t05`\n",
    "branches": [
      "vk/4209-fin-e01-s02-t05",
      "vk/9f4f-fin-e01-s02-t05",
      "vk/5cb8-fin-e01-s02-t05"
    ]
  },
  {
    "title": "FIN-E01-S02-T04: Handle payment_intent.failed",
    "status": "inreview",
    "labels": [
      "in-review",
      "fin"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/5ffc-fin-e01-s02-t04`\n- `vk/7f81-fin-e01-s02-t04`\n- `vk/361b-fin-e01-s02-t04`\n",
    "branches": [
      "vk/5ffc-fin-e01-s02-t04",
      "vk/7f81-fin-e01-s02-t04",
      "vk/361b-fin-e01-s02-t04"
    ]
  },
  {
    "title": "FIN-E01-S02-T03: Handle payment_intent.succeeded",
    "status": "inreview",
    "labels": [
      "in-review",
      "fin"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/9564-fin-e01-s02-t03`\n- `vk/36bd-fin-e01-s02-t03`\n- `vk/2086-fin-e01-s02-t03`\n",
    "branches": [
      "vk/9564-fin-e01-s02-t03",
      "vk/36bd-fin-e01-s02-t03",
      "vk/2086-fin-e01-s02-t03"
    ]
  },
  {
    "title": "FIN-E01-S02-T02: Verify Webhook Signature",
    "status": "inreview",
    "labels": [
      "in-review",
      "fin"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/9e8f-fin-e01-s02-t02`\n- `vk/e9a2-fin-e01-s02-t02`\n- `vk/9192-fin-e01-s02-t02`\n",
    "branches": [
      "vk/9e8f-fin-e01-s02-t02",
      "vk/e9a2-fin-e01-s02-t02",
      "vk/9192-fin-e01-s02-t02"
    ]
  },
  {
    "title": "FIN-E01-S02-T01: Create Webhook Endpoint",
    "status": "inreview",
    "labels": [
      "in-review",
      "fin"
    ],
    "body": "## Metadata\n- **Task ID:** FIN-E01-S02-T01\n- **Module:** Financial & Payments\n- **Epic:** Epic 01\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nPOST /api/webhook/stripe to receive Stripe events\n\n**File:** `src/app/api/webhook/stripe/route.ts`\n\n## Acceptance Criteria\n- Endpoint receives Stripe webhooks\r\n- Signature verified\r\n- Events routed to handlers\r\n\r\n---\n\n---\n**Branches:**\n- `vk/db6c-fin-e01-s02-t01`\n- `vk/c1da-fin-e01-s02-t01`\n- `vk/97f0-fin-e01-s02-t01`\n",
    "branches": [
      "vk/db6c-fin-e01-s02-t01",
      "vk/c1da-fin-e01-s02-t01",
      "vk/97f0-fin-e01-s02-t01"
    ]
  },
  {
    "title": "FIN-E01-S01-T05: Handle Track B Amount",
    "status": "inreview",
    "labels": [
      "in-review",
      "fin"
    ],
    "body": "## Metadata\n- **Task ID:** FIN-E01-S01-T05\n- **Module:** Financial & Payments\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nBatch total calculation for wedding parties\n\n**File:** `src/lib/pricing-wedding.ts`\n\n## Acceptance Criteria\n- Per-suit \u00d7 attendee count\r\n- Bulk discounts applied (5% for 6+, 10% for 10+)\r\n- VAT on discounted total\r\n- Event ID in metadata\r\n\r\n---\r\n\r\n## Story FIN-E01-S02: Webhook Handling\n\n---\n**Branches:**\n- `vk/9373-fin-e01-s01-t05`\n- `vk/8c80-fin-e01-s01-t05`\n- `vk/c671-fin-e01-s01-t05`\n",
    "branches": [
      "vk/9373-fin-e01-s01-t05",
      "vk/8c80-fin-e01-s01-t05",
      "vk/c671-fin-e01-s01-t05"
    ]
  },
  {
    "title": "FIN-E01-S01-T04: Handle Track A Amount",
    "status": "inreview",
    "labels": [
      "in-review",
      "fin"
    ],
    "body": "## Metadata\n- **Task ID:** FIN-E01-S01-T04\n- **Module:** Financial & Payments\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nCalculate base price + fabric modifier for retail\n\n**File:** `src/lib/pricing.ts`\n\n## Acceptance Criteria\n- Base price constant\r\n- Fabric modifier added\r\n- VAT calculated at 20%\r\n- Price formatting utility\r\n\r\n---\n\n---\n**Branches:**\n- `vk/8747-fin-e01-s01-t04`\n- `vk/54b6-fin-e01-s01-t04`\n- `vk/8884-fin-e01-s01-t04`\n",
    "branches": [
      "vk/8747-fin-e01-s01-t04",
      "vk/54b6-fin-e01-s01-t04",
      "vk/8884-fin-e01-s01-t04"
    ]
  },
  {
    "title": "FIN-E01-S01-T03: Create PaymentIntent Endpoint",
    "status": "inreview",
    "labels": [
      "in-review",
      "fin"
    ],
    "body": "## Metadata\n- **Task ID:** FIN-E01-S01-T03\n- **Module:** Financial & Payments\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nPOST /api/create-payment-intent for checkout\n\n**File:** `src/app/api/create-payment-intent/route.ts`\n\n## Acceptance Criteria\n- PaymentIntent created\r\n- Client secret returned\r\n- Metadata includes order info\r\n- Customer linked if authenticated\r\n\r\n---\n\n---\n**Branches:**\n- `vk/e054-fin-e01-s01-t03`\n- `vk/1144-fin-e01-s01-t03`\n- `vk/4e92-fin-e01-s01-t03`\n",
    "branches": [
      "vk/e054-fin-e01-s01-t03",
      "vk/1144-fin-e01-s01-t03",
      "vk/4e92-fin-e01-s01-t03"
    ]
  },
  {
    "title": "FIN-E01-S01-T02: Set Up API Keys",
    "status": "inreview",
    "labels": [
      "in-review",
      "fin"
    ],
    "body": "## Metadata\n- **Task ID:** FIN-E01-S01-T02\n- **Module:** Financial & Payments\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nStore Stripe keys in environment variables\n\n**File:** `.env.local`\n\n## Acceptance Criteria\n- Keys in environment variables\r\n- Not committed to git\r\n- Separate test/live keys\r\n\r\n---\n\n---\n**Branches:**\n- `vk/d313-fin-e01-s01-t02`\n- `vk/ed07-fin-e01-s01-t02`\n- `vk/351c-fin-e01-s01-t02`\n",
    "branches": [
      "vk/d313-fin-e01-s01-t02",
      "vk/ed07-fin-e01-s01-t02",
      "vk/351c-fin-e01-s01-t02"
    ]
  },
  {
    "title": "FIN-E01-S01-T01: Configure Stripe Account",
    "status": "inreview",
    "labels": [
      "in-review",
      "fin"
    ],
    "body": "## Metadata\n- **Task ID:** FIN-E01-S01-T01\n- **Module:** Financial & Payments\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nSet up UK Stripe account with test/live modes\r\n\r\n**Setup Steps:**\r\n1. Create Stripe account at stripe.com\r\n2. Complete business verification for UK\r\n3. Enable payment methods: Card, Apple Pay, Google Pay\r\n4. Configure webhooks endpoint\r\n5. Note down API keys for both test and live modes\n\n**File:** `src/lib/stripe.ts`\n\n## Acceptance Criteria\n- Stripe account active\r\n- Test mode keys available\r\n- Live mode keys secured\r\n- Webhook endpoint configured\r\n\r\n---\n\n---\n**Branches:**\n- `vk/5231-fin-e01-s01-t01`\n- `vk/d352-fin-e01-s01-t01`\n- `vk/4b40-fin-e01-s01-t01`\n",
    "branches": [
      "vk/5231-fin-e01-s01-t01",
      "vk/d352-fin-e01-s01-t01",
      "vk/4b40-fin-e01-s01-t01"
    ]
  },
  {
    "title": "RUNNER-E03-S01-T04: Update State",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "## Metadata\n- **Task ID:** RUNNER-E03-S01-T04\n- **Module:** Runner Mobile App\n- **Epic:** Epic 03\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\n**File:** `src/app/api/runner/tasks/[id]/delivery/route.ts`\n\n## Acceptance Criteria\n- State moves to S09_DELIVERED_TO_RAJA\r\n- History logged\r\n- Task completed\r\n- Photo stored if provided\r\n\r\n---\r\n\r\n# Summary\r\n\r\n| Epic | Story | Tasks | Status |\r\n|------|-------|-------|--------|\r\n| RUNNER-E01 | S01: App Foundation | 3 | Detailed |\r\n| RUNNER-E01 | S02: Task List | 4 | Detailed |\r\n| RUNNER-E02 | S01: Ruler Test | 6 | Detailed |\r\n| RUNNER-E02 | S02: Fabric Reservation | 5 | Detailed |\r\n| RUNNER-E03 | S01: Delivery to Raja | 4 | Detailed |\r\n| **Total** | | **22** | |\r\n\r\n---\r\n\r\n*End of RUNNER Module Detailed Tasks*\n\n---\n**Branches:**\n- `vk/155f-runner-e03-s01-t`\n- `vk/0860-runner-e03-s01-t`\n- `vk/30b4-runner-e03-s01-t`\n",
    "branches": [
      "vk/155f-runner-e03-s01-t",
      "vk/0860-runner-e03-s01-t",
      "vk/30b4-runner-e03-s01-t"
    ]
  },
  {
    "title": "RUNNER-E03-S01-T03: Capture Signature/Photo",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/198e-runner-e03-s01-t`\n- `vk/7fc6-runner-e03-s01-t`\n- `vk/13ab-runner-e03-s01-t`\n",
    "branches": [
      "vk/198e-runner-e03-s01-t",
      "vk/7fc6-runner-e03-s01-t",
      "vk/13ab-runner-e03-s01-t"
    ]
  },
  {
    "title": "RUNNER-E03-S01-T02: Add Confirmation Checklist",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/df6f-runner-e03-s01-t`\n- `vk/ccd9-runner-e03-s01-t`\n- `vk/6260-runner-e03-s01-t`\n",
    "branches": [
      "vk/df6f-runner-e03-s01-t",
      "vk/ccd9-runner-e03-s01-t",
      "vk/6260-runner-e03-s01-t"
    ]
  },
  {
    "title": "RUNNER-E03-S01-T01: Build Delivery Screen",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "## Metadata\n- **Task ID:** RUNNER-E03-S01-T01\n- **Module:** Runner Mobile App\n- **Epic:** Epic 03\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\n**File:** `src/app/runner/tasks/[id]/deliver/page.tsx`\n\n## Acceptance Criteria\n- List of items to deliver\r\n- Checklist completion required\r\n- Photo capture optional\r\n- Notes field available\r\n\r\n---\n\n---\n**Branches:**\n- `vk/6291-runner-e03-s01-t`\n- `vk/49f9-runner-e03-s01-t`\n- `vk/b1a1-runner-e03-s01-t`\n",
    "branches": [
      "vk/6291-runner-e03-s01-t",
      "vk/49f9-runner-e03-s01-t",
      "vk/b1a1-runner-e03-s01-t"
    ]
  },
  {
    "title": "RUNNER-E02-S02-T05: Confirm Reservation",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/e1b6-runner-e02-s02-t`\n- `vk/6ac2-runner-e02-s02-t`\n- `vk/b37a-runner-e02-s02-t`\n",
    "branches": [
      "vk/e1b6-runner-e02-s02-t",
      "vk/6ac2-runner-e02-s02-t",
      "vk/b37a-runner-e02-s02-t"
    ]
  },
  {
    "title": "RUNNER-E02-S02-T04: Link to Order",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/01b9-runner-e02-s02-t`\n- `vk/5c6e-runner-e02-s02-t`\n- `vk/dea3-runner-e02-s02-t`\n",
    "branches": [
      "vk/01b9-runner-e02-s02-t",
      "vk/5c6e-runner-e02-s02-t",
      "vk/dea3-runner-e02-s02-t"
    ]
  },
  {
    "title": "RUNNER-E02-S02-T03: Upload Photo",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "## Metadata\n- **Task ID:** RUNNER-E02-S02-T03\n- **Module:** Runner Mobile App\n- **Epic:** Epic 02\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\n**File:** `src/app/api/runner/tasks/[id]/fabric-photo/route.ts`\n\n## Acceptance Criteria\n- Photo saved to Supabase Storage\r\n- URL linked to order\r\n- Task marked complete\r\n\r\n---\n\n---\n**Branches:**\n- `vk/b427-runner-e02-s02-t`\n- `vk/ff1b-runner-e02-s02-t`\n- `vk/7f93-runner-e02-s02-t`\n",
    "branches": [
      "vk/b427-runner-e02-s02-t",
      "vk/ff1b-runner-e02-s02-t",
      "vk/7f93-runner-e02-s02-t"
    ]
  },
  {
    "title": "RUNNER-E02-S02-T02: Implement File Input",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/261b-runner-e02-s02-t`\n- `vk/6154-runner-e02-s02-t`\n- `vk/892e-runner-e02-s02-t`\n",
    "branches": [
      "vk/261b-runner-e02-s02-t",
      "vk/6154-runner-e02-s02-t",
      "vk/892e-runner-e02-s02-t"
    ]
  },
  {
    "title": "RUNNER-E02-S02-T01: Build Photo Upload Screen",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "## Metadata\n- **Task ID:** RUNNER-E02-S02-T01\n- **Module:** Runner Mobile App\n- **Epic:** Epic 02\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\n**File:** `src/app/runner/tasks/[id]/fabric/page.tsx`\n\n## Acceptance Criteria\n- Camera access\r\n- Photo preview\r\n- Retake option\r\n- Upload with confirmation\r\n\r\n---\n\n---\n**Branches:**\n- `vk/cde1-runner-e02-s02-t`\n- `vk/09db-runner-e02-s02-t`\n- `vk/f399-runner-e02-s02-t`\n",
    "branches": [
      "vk/cde1-runner-e02-s02-t",
      "vk/09db-runner-e02-s02-t",
      "vk/f399-runner-e02-s02-t"
    ]
  },
  {
    "title": "RUNNER-E02-S01-T06: Block Printer Payment",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/2b5d-runner-e02-s01-t`\n- `vk/07e2-runner-e02-s01-t`\n- `vk/bf5b-runner-e02-s01-t`\n",
    "branches": [
      "vk/2b5d-runner-e02-s01-t",
      "vk/07e2-runner-e02-s01-t",
      "vk/bf5b-runner-e02-s01-t"
    ]
  },
  {
    "title": "RUNNER-E02-S01-T05: Handle Fail",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/d026-runner-e02-s01-t`\n- `vk/d521-runner-e02-s01-t`\n- `vk/898c-runner-e02-s01-t`\n",
    "branches": [
      "vk/d026-runner-e02-s01-t",
      "vk/d521-runner-e02-s01-t",
      "vk/898c-runner-e02-s01-t"
    ]
  },
  {
    "title": "RUNNER-E02-S01-T04: Handle Pass",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "## Metadata\n- **Task ID:** RUNNER-E02-S01-T04\n- **Module:** Runner Mobile App\n- **Epic:** Epic 02\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\n**File:** `src/app/api/runner/tasks/[id]/ruler-test/route.ts`\n\n## Acceptance Criteria\n- State updates to S07_PRINT_COLLECTED\r\n- Task marked complete\r\n- History logged\r\n\r\n---\n\n---\n**Branches:**\n- `vk/68cc-runner-e02-s01-t`\n- `vk/f9a2-runner-e02-s01-t`\n- `vk/0625-runner-e02-s01-t`\n",
    "branches": [
      "vk/68cc-runner-e02-s01-t",
      "vk/f9a2-runner-e02-s01-t",
      "vk/0625-runner-e02-s01-t"
    ]
  },
  {
    "title": "RUNNER-E02-S01-T03: Implement Validation",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/7ad2-runner-e02-s01-t`\n- `vk/14fd-runner-e02-s01-t`\n- `vk/ae3e-runner-e02-s01-t`\n",
    "branches": [
      "vk/7ad2-runner-e02-s01-t",
      "vk/14fd-runner-e02-s01-t",
      "vk/ae3e-runner-e02-s01-t"
    ]
  },
  {
    "title": "RUNNER-E02-S01-T02: Add Numeric Input",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/73a7-runner-e02-s01-t`\n- `vk/625b-runner-e02-s01-t`\n- `vk/18c7-runner-e02-s01-t`\n",
    "branches": [
      "vk/73a7-runner-e02-s01-t",
      "vk/625b-runner-e02-s01-t",
      "vk/18c7-runner-e02-s01-t"
    ]
  },
  {
    "title": "RUNNER-E02-S01-T01: Build Ruler Test Screen",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "## Metadata\n- **Task ID:** RUNNER-E02-S01-T01\n- **Module:** Runner Mobile App\n- **Epic:** Epic 02\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nInstructions and input for scale verification\n\n**File:** `src/app/runner/tasks/[id]/ruler-test/page.tsx`\n\n## Acceptance Criteria\n- Clear instructions\r\n- Large input for easy entry\r\n- Visual pass/fail feedback\r\n- Cannot proceed if failed\r\n\r\n---\n\n---\n**Branches:**\n- `vk/945e-runner-e02-s01-t`\n- `vk/c879-runner-e02-s01-t`\n- `vk/0e29-runner-e02-s01-t`\n",
    "branches": [
      "vk/945e-runner-e02-s01-t",
      "vk/c879-runner-e02-s01-t",
      "vk/0e29-runner-e02-s01-t"
    ]
  },
  {
    "title": "RUNNER-E01-S02-T04: Implement Pull to Refresh",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/a3ec-runner-e01-s02-t`\n- `vk/1904-runner-e01-s02-t`\n- `vk/800e-runner-e01-s02-t`\n",
    "branches": [
      "vk/a3ec-runner-e01-s02-t",
      "vk/1904-runner-e01-s02-t",
      "vk/800e-runner-e01-s02-t"
    ]
  },
  {
    "title": "RUNNER-E01-S02-T03: Show Task Details",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/5d05-runner-e01-s02-t`\n- `vk/3cfe-runner-e01-s02-t`\n- `vk/301f-runner-e01-s02-t`\n",
    "branches": [
      "vk/5d05-runner-e01-s02-t",
      "vk/3cfe-runner-e01-s02-t",
      "vk/301f-runner-e01-s02-t"
    ]
  },
  {
    "title": "RUNNER-E01-S02-T02: Filter by Task Type",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/9ab8-runner-e01-s02-t`\n- `vk/3907-runner-e01-s02-t`\n- `vk/8c87-runner-e01-s02-t`\n",
    "branches": [
      "vk/9ab8-runner-e01-s02-t",
      "vk/3907-runner-e01-s02-t",
      "vk/8c87-runner-e01-s02-t"
    ]
  },
  {
    "title": "RUNNER-E01-S02-T01: Build Task List View",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "## Metadata\n- **Task ID:** RUNNER-E01-S02-T01\n- **Module:** Runner Mobile App\n- **Epic:** Epic 01\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nList orders in relevant states for runner\n\n**File:** `src/app/runner/tasks/page.tsx`\n\n## Acceptance Criteria\n- Tasks displayed in cards\r\n- Color-coded by type\r\n- Pull to refresh\r\n- Navigate to task detail\r\n\r\n---\n\n---\n**Branches:**\n- `vk/617e-runner-e01-s02-t`\n- `vk/4d7d-runner-e01-s02-t`\n- `vk/5aea-runner-e01-s02-t`\n",
    "branches": [
      "vk/617e-runner-e01-s02-t",
      "vk/4d7d-runner-e01-s02-t",
      "vk/5aea-runner-e01-s02-t"
    ]
  },
  {
    "title": "RUNNER-E01-S01-T03: Build Mobile Layout",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "## Metadata\n- **Task ID:** RUNNER-E01-S01-T03\n- **Module:** Runner Mobile App\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nTouch-friendly UI with bottom navigation\n\n**File:** `src/components/runner/RunnerLayout.tsx`\n\n## Acceptance Criteria\n- Bottom navigation bar\r\n- Touch-friendly buttons (min 44px)\r\n- Safe area handling for notched phones\r\n- Header with runner name\r\n\r\n---\r\n\r\n## Story RUNNER-E01-S02: Task List\n\n---\n**Branches:**\n- `vk/01fa-runner-e01-s01-t`\n- `vk/3faf-runner-e01-s01-t`\n- `vk/4dcc-runner-e01-s01-t`\n",
    "branches": [
      "vk/01fa-runner-e01-s01-t",
      "vk/3faf-runner-e01-s01-t",
      "vk/4dcc-runner-e01-s01-t"
    ]
  },
  {
    "title": "RUNNER-E01-S01-T02: Implement Runner Auth",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "## Metadata\n- **Task ID:** RUNNER-E01-S01-T02\n- **Module:** Runner Mobile App\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nLogin with runner credentials\n\n**File:** `src/app/runner/login/page.tsx`\n\n## Acceptance Criteria\n- Phone + PIN login\r\n- Session stored locally\r\n- Active status checked\r\n- Logout function\r\n\r\n---\n\n---\n**Branches:**\n- `vk/f416-runner-e01-s01-t`\n- `vk/4b4d-runner-e01-s01-t`\n- `vk/8895-runner-e01-s01-t`\n",
    "branches": [
      "vk/f416-runner-e01-s01-t",
      "vk/4b4d-runner-e01-s01-t",
      "vk/8895-runner-e01-s01-t"
    ]
  },
  {
    "title": "RUNNER-E01-S01-T01: Create PWA Shell",
    "status": "inreview",
    "labels": [
      "in-review",
      "runner"
    ],
    "body": "## Metadata\n- **Task ID:** RUNNER-E01-S01-T01\n- **Module:** Runner Mobile App\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nMobile-optimized React app with offline support\n\n**File:** `src/app/runner/layout.tsx`\n\n## Acceptance Criteria\n- PWA installable on mobile\r\n- Offline page available\r\n- Service worker caches assets\r\n- Manifest configured\r\n\r\n---\n\n---\n**Branches:**\n- `vk/5f6c-runner-e01-s01-t`\n- `vk/0e4b-runner-e01-s01-t`\n- `vk/8417-runner-e01-s01-t`\n",
    "branches": [
      "vk/5f6c-runner-e01-s01-t",
      "vk/0e4b-runner-e01-s01-t",
      "vk/8417-runner-e01-s01-t"
    ]
  },
  {
    "title": "ADMIN-E02-S03-T04: Track Delivery",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "Note field for delivery confirmation\r\n\r\n*Implemented via notes in state transition*\r\n\r\n---\r\n\r\n# Summary\r\n\r\n| Epic | Story | Tasks | Status |\r\n|------|-------|-------|--------|\r\n| ADMIN-E01 | S01: Dashboard Foundation | 3 | Detailed |\r\n| ADMIN-E01 | S02: Order Queue | 5 | Detailed |\r\n| ADMIN-E01 | S03: Order Detail | 5 | Detailed |\r\n| ADMIN-E01 | S04: State Transitions | 4 | Detailed |\r\n| ADMIN-E02 | S01: Measurement Export | 4 | Detailed |\r\n| ADMIN-E02 | S02: Pattern Upload | 5 | Detailed |\r\n| ADMIN-E02 | S03: Print Shop Communication | 4 | Detailed |\r\n| **Total** | | **30** | |\r\n\r\n---\r\n\r\n*End of ADMIN Module Detailed Tasks*\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/7cbe-admin-e02-s03-t0`\n- `vk/efdb-admin-e02-s03-t0`\n- `vk/01e8-admin-e02-s03-t0`\n",
    "branches": [
      "vk/7cbe-admin-e02-s03-t0",
      "vk/efdb-admin-e02-s03-t0",
      "vk/01e8-admin-e02-s03-t0"
    ]
  },
  {
    "title": "ADMIN-E02-S03-T03: Mark as Sent",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/3cb2-admin-e02-s03-t0`\n- `vk/931f-admin-e02-s03-t0`\n- `vk/8cad-admin-e02-s03-t0`\n",
    "branches": [
      "vk/3cb2-admin-e02-s03-t0",
      "vk/931f-admin-e02-s03-t0",
      "vk/8cad-admin-e02-s03-t0"
    ]
  },
  {
    "title": "ADMIN-E02-S03-T02: Implement Email Send",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "## Metadata\n- **Task ID:** ADMIN-E02-S03-T02\n- **Module:** Operator Dashboard\n- **Epic:** Epic 02\n- **Story:** Story 03\n- **Phase:** 1\n- **Prerequisites:** None\n\n**File:** `src/app/api/admin/send-to-print/route.ts`\n\n## Acceptance Criteria\n- Email sent via Resend API\r\n- Pattern file attached\r\n- State auto-transitions\r\n- History logged\r\n\r\n---\n\n---\n**Branches:**\n- `vk/555e-admin-e02-s03-t0`\n- `vk/d806-admin-e02-s03-t0`\n- `vk/00ce-admin-e02-s03-t0`\n",
    "branches": [
      "vk/555e-admin-e02-s03-t0",
      "vk/d806-admin-e02-s03-t0",
      "vk/00ce-admin-e02-s03-t0"
    ]
  },
  {
    "title": "ADMIN-E02-S03-T01: Build Email Interface",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "## Metadata\n- **Task ID:** ADMIN-E02-S03-T01\n- **Module:** Operator Dashboard\n- **Epic:** Epic 02\n- **Story:** Story 03\n- **Phase:** 1\n- **Prerequisites:** None\n\n**File:** `src/components/admin/SendToPrintShop.tsx`\n\n## Acceptance Criteria\n- Email composition interface\r\n- Pattern attachment\r\n- Custom notes field\r\n- Send confirmation\r\n\r\n---\n\n---\n**Branches:**\n- `vk/4f47-admin-e02-s03-t0`\n- `vk/49b7-admin-e02-s03-t0`\n- `vk/b744-admin-e02-s03-t0`\n",
    "branches": [
      "vk/4f47-admin-e02-s03-t0",
      "vk/49b7-admin-e02-s03-t0",
      "vk/b744-admin-e02-s03-t0"
    ]
  },
  {
    "title": "ADMIN-E02-S02-T05: Auto-Transition State",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/fc3c-admin-e02-s02-t0`\n- `vk/104f-admin-e02-s02-t0`\n- `vk/061c-admin-e02-s02-t0`\n",
    "branches": [
      "vk/fc3c-admin-e02-s02-t0",
      "vk/104f-admin-e02-s02-t0",
      "vk/061c-admin-e02-s02-t0"
    ]
  },
  {
    "title": "ADMIN-E02-S02-T04: Update pattern_files Table",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/d96d-admin-e02-s02-t0`\n- `vk/0388-admin-e02-s02-t0`\n- `vk/e53b-admin-e02-s02-t0`\n",
    "branches": [
      "vk/d96d-admin-e02-s02-t0",
      "vk/0388-admin-e02-s02-t0",
      "vk/e53b-admin-e02-s02-t0"
    ]
  },
  {
    "title": "ADMIN-E02-S02-T03: Store Pattern File",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/e51c-admin-e02-s02-t0`\n- `vk/e791-admin-e02-s02-t0`\n- `vk/3973-admin-e02-s02-t0`\n",
    "branches": [
      "vk/e51c-admin-e02-s02-t0",
      "vk/e791-admin-e02-s02-t0",
      "vk/3973-admin-e02-s02-t0"
    ]
  },
  {
    "title": "ADMIN-E02-S02-T02: Validate File Format",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/480b-admin-e02-s02-t0`\n- `vk/157f-admin-e02-s02-t0`\n- `vk/a77a-admin-e02-s02-t0`\n",
    "branches": [
      "vk/480b-admin-e02-s02-t0",
      "vk/157f-admin-e02-s02-t0",
      "vk/a77a-admin-e02-s02-t0"
    ]
  },
  {
    "title": "ADMIN-E02-S02-T01: Build Upload Interface",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "## Metadata\n- **Task ID:** ADMIN-E02-S02-T01\n- **Module:** Operator Dashboard\n- **Epic:** Epic 02\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\n**File:** `src/components/admin/PatternUpload.tsx`\n\n## Acceptance Criteria\n- Drag and drop interface\r\n- PDF and DXF accepted\r\n- File size validation\r\n- Progress indicator\r\n\r\n---\n\n---\n**Branches:**\n- `vk/c42c-admin-e02-s02-t0`\n- `vk/48c3-admin-e02-s02-t0`\n- `vk/94c9-admin-e02-s02-t0`\n",
    "branches": [
      "vk/c42c-admin-e02-s02-t0",
      "vk/48c3-admin-e02-s02-t0",
      "vk/94c9-admin-e02-s02-t0"
    ]
  },
  {
    "title": "ADMIN-E02-S01-T04: Generate Optitex Format",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/7aa5-admin-e02-s01-t0`\n- `vk/20c0-admin-e02-s01-t0`\n- `vk/91bf-admin-e02-s01-t0`\n",
    "branches": [
      "vk/7aa5-admin-e02-s01-t0",
      "vk/20c0-admin-e02-s01-t0",
      "vk/91bf-admin-e02-s01-t0"
    ]
  },
  {
    "title": "ADMIN-E02-S01-T03: Add Export All",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/5009-admin-e02-s01-t0`\n- `vk/458e-admin-e02-s01-t0`\n- `vk/e700-admin-e02-s01-t0`\n",
    "branches": [
      "vk/5009-admin-e02-s01-t0",
      "vk/458e-admin-e02-s01-t0",
      "vk/e700-admin-e02-s01-t0"
    ]
  },
  {
    "title": "ADMIN-E02-S01-T02: Add Copy to Clipboard",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/fdeb-admin-e02-s01-t0`\n- `vk/38af-admin-e02-s01-t0`\n- `vk/1592-admin-e02-s01-t0`\n",
    "branches": [
      "vk/fdeb-admin-e02-s01-t0",
      "vk/38af-admin-e02-s01-t0",
      "vk/1592-admin-e02-s01-t0"
    ]
  },
  {
    "title": "ADMIN-E02-S01-T01: Build Export View",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/f606-admin-e02-s01-t0`\n- `vk/63f4-admin-e02-s01-t0`\n- `vk/00b4-admin-e02-s01-t0`\n",
    "branches": [
      "vk/f606-admin-e02-s01-t0",
      "vk/63f4-admin-e02-s01-t0",
      "vk/00b4-admin-e02-s01-t0"
    ]
  },
  {
    "title": "ADMIN-E01-S04-T04: Add Notes Field",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/7dc6-admin-e01-s04-t0`\n- `vk/b0a0-admin-e01-s04-t0`\n- `vk/38c1-admin-e01-s04-t0`\n",
    "branches": [
      "vk/7dc6-admin-e01-s04-t0",
      "vk/b0a0-admin-e01-s04-t0",
      "vk/38c1-admin-e01-s04-t0"
    ]
  },
  {
    "title": "ADMIN-E01-S04-T03: Add Confirmation Modal",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/8212-admin-e01-s04-t0`\n- `vk/501e-admin-e01-s04-t0`\n- `vk/0686-admin-e01-s04-t0`\n",
    "branches": [
      "vk/8212-admin-e01-s04-t0",
      "vk/501e-admin-e01-s04-t0",
      "vk/0686-admin-e01-s04-t0"
    ]
  },
  {
    "title": "ADMIN-E01-S04-T02: Implement State API Call",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "PATCH /api/orders/:id/state\r\n\r\n*Implemented in API module*\r\n\r\n---\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/8dc5-admin-e01-s04-t0`\n- `vk/0477-admin-e01-s04-t0`\n",
    "branches": [
      "vk/8dc5-admin-e01-s04-t0",
      "vk/0477-admin-e01-s04-t0"
    ]
  },
  {
    "title": "ADMIN-E01-S04-T01: Build Transition Controls",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "## Metadata\n- **Task ID:** ADMIN-E01-S04-T01\n- **Module:** Operator Dashboard\n- **Epic:** Epic 01\n- **Story:** Story 04\n- **Phase:** 1\n- **Prerequisites:** None\n\nButtons for valid next states\n\n**File:** `src/components/admin/OrderStateActions.tsx`\n\n## Acceptance Criteria\n- Only valid transitions shown\r\n- Critical states require confirmation\r\n- Notes can be added\r\n- Loading state during update\r\n\r\n---\n\n---\n**Branches:**\n- `vk/6b9c-admin-e01-s04-t0`\n- `vk/decd-admin-e01-s04-t0`\n",
    "branches": [
      "vk/6b9c-admin-e01-s04-t0",
      "vk/decd-admin-e01-s04-t0"
    ]
  },
  {
    "title": "ADMIN-E01-S03-T05: Show State History",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "## Metadata\n- **Task ID:** ADMIN-E01-S03-T05\n- **Module:** Operator Dashboard\n- **Epic:** Epic 01\n- **Story:** Story 03\n- **Phase:** 1\n- **Prerequisites:** None\n\nTimeline of all state transitions\n\n**File:** `src/components/admin/OrderTimeline.tsx`\n\n## Acceptance Criteria\n- Visual timeline\r\n- All transitions shown\r\n- Who made the change\r\n- Notes displayed\r\n\r\n---\r\n\r\n## Story ADMIN-E01-S04: State Transitions\n\n---\n**Branches:**\n- `vk/468c-admin-e01-s03-t0`\n- `vk/b88b-admin-e01-s03-t0`\n- `vk/a4fb-admin-e01-s03-t0`\n",
    "branches": [
      "vk/468c-admin-e01-s03-t0",
      "vk/b88b-admin-e01-s03-t0",
      "vk/a4fb-admin-e01-s03-t0"
    ]
  },
  {
    "title": "ADMIN-E01-S03-T04: Display Customer Info",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "## Metadata\n- **Task ID:** ADMIN-E01-S03-T04\n- **Module:** Operator Dashboard\n- **Epic:** Epic 01\n- **Story:** Story 03\n- **Phase:** 1\n- **Prerequisites:** None\n\nName, email, shipping address\n\n**File:** `src/components/admin/CustomerInfo.tsx`\n\n## Acceptance Criteria\n- Email displayed\r\n- Phone if available\r\n- Full shipping address\r\n\r\n---\n\n---\n**Branches:**\n- `vk/c31c-admin-e01-s03-t0`\n- `vk/c7e0-admin-e01-s03-t0`\n- `vk/d400-admin-e01-s03-t0`\n",
    "branches": [
      "vk/c31c-admin-e01-s03-t0",
      "vk/c7e0-admin-e01-s03-t0",
      "vk/d400-admin-e01-s03-t0"
    ]
  },
  {
    "title": "ADMIN-E01-S03-T03: Display Configuration",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "## Metadata\n- **Task ID:** ADMIN-E01-S03-T03\n- **Module:** Operator Dashboard\n- **Epic:** Epic 01\n- **Story:** Story 03\n- **Phase:** 1\n- **Prerequisites:** None\n\nFabric, style, and lining choices\n\n**File:** `src/components/admin/ConfigurationDisplay.tsx`\n\n## Acceptance Criteria\n- Fabric name and code\r\n- Style details (lapel, vents, buttons)\r\n- Lining color preview\r\n- All selections visible\r\n\r\n---\n\n---\n**Branches:**\n- `vk/5374-admin-e01-s03-t0`\n- `vk/5f17-admin-e01-s03-t0`\n",
    "branches": [
      "vk/5374-admin-e01-s03-t0",
      "vk/5f17-admin-e01-s03-t0"
    ]
  },
  {
    "title": "ADMIN-E01-S03-T02: Display 28 Measurements",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "## Metadata\n- **Task ID:** ADMIN-E01-S03-T02\n- **Module:** Operator Dashboard\n- **Epic:** Epic 01\n- **Story:** Story 03\n- **Phase:** 1\n- **Prerequisites:** None\n\nClear format for transcription to Optitex\n\n**File:** `src/components/admin/MeasurementsDisplay.tsx`\n\n## Acceptance Criteria\n- All 28 measurements displayed\r\n- Grouped by category\r\n- Click to copy individual\r\n- Export to Optitex format\r\n\r\n---\n\n---\n**Branches:**\n- `vk/a87e-admin-e01-s03-t0`\n- `vk/43d9-admin-e01-s03-t0`\n",
    "branches": [
      "vk/a87e-admin-e01-s03-t0",
      "vk/43d9-admin-e01-s03-t0"
    ]
  },
  {
    "title": "ADMIN-E01-S03-T01: Build Detail View",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "## Metadata\n- **Task ID:** ADMIN-E01-S03-T01\n- **Module:** Operator Dashboard\n- **Epic:** Epic 01\n- **Story:** Story 03\n- **Phase:** 1\n- **Prerequisites:** None\n\nFull order information display\n\n**File:** `src/app/admin/orders/[id]/page.tsx`\n\n## Acceptance Criteria\n- Full order data displayed\r\n- Items listed with configs\r\n- Customer info sidebar\r\n- State history timeline\r\n\r\n---\n\n---\n**Branches:**\n- `vk/7019-admin-e01-s03-t0`\n- `vk/d048-admin-e01-s03-t0`\n",
    "branches": [
      "vk/7019-admin-e01-s03-t0",
      "vk/d048-admin-e01-s03-t0"
    ]
  },
  {
    "title": "ADMIN-E01-S02-T05: Implement Auto-Refresh",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "Poll for new orders or use real-time subscription\r\n\r\n*Implemented in OrderQueue.tsx above with Supabase real-time*\r\n\r\n---\r\n\r\n## Story ADMIN-E01-S03: Order Detail\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/026f-admin-e01-s02-t0`\n- `vk/4f2f-admin-e01-s02-t0`\n",
    "branches": [
      "vk/026f-admin-e01-s02-t0",
      "vk/4f2f-admin-e01-s02-t0"
    ]
  },
  {
    "title": "ADMIN-E01-S02-T04: Add Search",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "Search by order ID or customer email\r\n\r\n*Implemented in OrderQueue.tsx above*\r\n\r\n---\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/b47c-admin-e01-s02-t0`\n- `vk/4f6e-admin-e01-s02-t0`\n",
    "branches": [
      "vk/b47c-admin-e01-s02-t0",
      "vk/4f6e-admin-e01-s02-t0"
    ]
  },
  {
    "title": "ADMIN-E01-S02-T03: Add Sort Options",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "Sort by date or priority\r\n\r\n*Implemented in OrderQueue.tsx above*\r\n\r\n---\n\n---\n*See DETAILED-TASKS markdown files for complete implementation details.*\n\n---\n**Branches:**\n- `vk/9c3e-admin-e01-s02-t0`\n- `vk/ab6f-admin-e01-s02-t0`\n",
    "branches": [
      "vk/9c3e-admin-e01-s02-t0",
      "vk/ab6f-admin-e01-s02-t0"
    ]
  },
  {
    "title": "ADMIN-E01-S02-T02: Implement State Filter",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "## Metadata\n- **Task ID:** ADMIN-E01-S02-T02\n- **Module:** Operator Dashboard\n- **Epic:** Epic 01\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nDropdown to filter orders by state S01-S19\n\n**File:** `src/lib/orderStates.ts`\n\n## Acceptance Criteria\n- All 19 states in dropdown\r\n- Filter applies immediately\r\n- State labels human-readable\r\n- Color coding by state\r\n\r\n---\n\n---\n**Branches:**\n- `vk/7a99-admin-e01-s02-t0`\n- `vk/b24e-admin-e01-s02-t0`\n",
    "branches": [
      "vk/7a99-admin-e01-s02-t0",
      "vk/b24e-admin-e01-s02-t0"
    ]
  },
  {
    "title": "ADMIN-E01-S02-T01: Build Queue View",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "## Metadata\n- **Task ID:** ADMIN-E01-S02-T01\n- **Module:** Operator Dashboard\n- **Epic:** Epic 01\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nTable with orders filtered by state\n\n**File:** `src/app/admin/orders/page.tsx`\n\n## Acceptance Criteria\n- Orders displayed in table\r\n- Real-time updates via subscription\r\n- Clickable rows to view detail\r\n\r\n---\n\n---\n**Branches:**\n- `vk/194e-admin-e01-s02-t0`\n- `vk/5c6e-admin-e01-s02-t0`\n",
    "branches": [
      "vk/194e-admin-e01-s02-t0",
      "vk/5c6e-admin-e01-s02-t0"
    ]
  },
  {
    "title": "ADMIN-E01-S01-T03: Build Admin Layout",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "## Metadata\n- **Task ID:** ADMIN-E01-S01-T03\n- **Module:** Operator Dashboard\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nNavigation sidebar with admin sections\n\n**File:** `src/components/admin/AdminSidebar.tsx`\n\n## Acceptance Criteria\n- Sidebar with navigation links\r\n- Active state highlighting\r\n- Role-based menu visibility\r\n- Header with user info and logout\r\n\r\n---\r\n\r\n## Story ADMIN-E01-S02: Order Queue\n\n---\n**Branches:**\n- `vk/9f32-admin-e01-s01-t0`\n- `vk/a5cd-admin-e01-s01-t0`\n",
    "branches": [
      "vk/9f32-admin-e01-s01-t0",
      "vk/a5cd-admin-e01-s01-t0"
    ]
  },
  {
    "title": "ADMIN-E01-S01-T02: Implement Admin Auth",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "## Metadata\n- **Task ID:** ADMIN-E01-S01-T02\n- **Module:** Operator Dashboard\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nSeparate admin role check\n\n**File:** `src/app/admin/login/page.tsx`\n\n## Acceptance Criteria\n- Separate login page for admin\r\n- Validates admin/operator role after auth\r\n- Rejects non-admin users\r\n- Shows appropriate error messages\r\n\r\n---\n\n---\n**Branches:**\n- `vk/6afa-admin-e01-s01-t0`\n- `vk/0825-admin-e01-s01-t0`\n",
    "branches": [
      "vk/6afa-admin-e01-s01-t0",
      "vk/0825-admin-e01-s01-t0"
    ]
  },
  {
    "title": "ADMIN-E01-S01-T01: Create Admin Route",
    "status": "inreview",
    "labels": [
      "in-review",
      "admin"
    ],
    "body": "## Metadata\n- **Task ID:** ADMIN-E01-S01-T01\n- **Module:** Operator Dashboard\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\n/admin with route protection\n\n**File:** `src/app/admin/layout.tsx`\n\n## Acceptance Criteria\n- Route accessible only to authenticated users\r\n- Redirects to login if not authenticated\r\n- Checks for admin/operator role\r\n\r\n---\n\n---\n**Branches:**\n- `vk/4cd4-admin-e01-s01-t0`\n- `vk/6bd6-admin-e01-s01-t0`\n",
    "branches": [
      "vk/4cd4-admin-e01-s01-t0",
      "vk/6bd6-admin-e01-s01-t0"
    ]
  },
  {
    "title": "FE-E02-S03-T05: Build Lining Selector",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E02-S03-T05\n- **Module:** Frontend\n- **Epic:** Epic 02\n- **Story:** Story 03\n- **Phase:** 1\n- **Prerequisites:** None\n\nColor and pattern picker for jacket lining\n\n**File:** `src/components/configurator/LiningSelector.tsx`\n\n## Acceptance Criteria\n- Color swatches selection\r\n- Custom color picker\r\n- Pattern options\r\n- Preview of selection\r\n\r\n---\r\n\r\nThis concludes Part 1 of the FE module (Epics E01-E02 partial). The file continues with more tasks.\r\n\r\n---\r\n\r\n*Continued in next section...*\n\n---\n**Branches:**\n- `vk/dd1d-fe-e02-s03-t05-b`\n- `vk/1763-fe-e02-s03-t05-b`\n",
    "branches": [
      "vk/dd1d-fe-e02-s03-t05-b",
      "vk/1763-fe-e02-s03-t05-b"
    ]
  },
  {
    "title": "FE-E02-S03-T04: Implement Mesh Swapping",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E02-S03-T04\n- **Module:** Frontend\n- **Epic:** Epic 02\n- **Story:** Story 03\n- **Phase:** 1\n- **Prerequisites:** None\n\nSwap visible mesh components on style change\n\n**File:** `src/components/configurator/JacketVariants.tsx`\n\n## Acceptance Criteria\n- Models swap on style change\r\n- Smooth transition animation\r\n- Preloaded for instant swap\r\n- No flickering\r\n\r\n---\n\n---\n**Branches:**\n- `vk/ad31-fe-e02-s03-t04-i`\n- `vk/5733-fe-e02-s03-t04-i`\n",
    "branches": [
      "vk/ad31-fe-e02-s03-t04-i",
      "vk/5733-fe-e02-s03-t04-i"
    ]
  },
  {
    "title": "FE-E02-S03-T03: Build Style Selector",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E02-S03-T03\n- **Module:** Frontend\n- **Epic:** Epic 02\n- **Story:** Story 03\n- **Phase:** 1\n- **Prerequisites:** None\n\nDropdowns for lapel, vents, buttons\n\n**File:** `src/components/configurator/StyleSelector.tsx`\n\n## Acceptance Criteria\n- All style options available\r\n- Visual selection feedback\r\n- Descriptions for each option\r\n- Images for lapel styles\r\n\r\n---\n\n---\n**Branches:**\n- `vk/e2f6-fe-e02-s03-t03-b`\n- `vk/6814-fe-e02-s03-t03-b`\n",
    "branches": [
      "vk/e2f6-fe-e02-s03-t03-b",
      "vk/6814-fe-e02-s03-t03-b"
    ]
  },
  {
    "title": "FE-E02-S03-T02: Implement Fabric Selection",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E02-S03-T02\n- **Module:** Frontend\n- **Epic:** Epic 02\n- **Story:** Story 03\n- **Phase:** 1\n- **Prerequisites:** None\n\nUpdate store and apply texture on selection\n\n**File:** `src/hooks/useFabricTexture.ts`\n\n## Acceptance Criteria\n- Texture loads on selection\r\n- Store updates immediately\r\n- 3D view re-renders\r\n- Loading state handled\r\n\r\n---\n\n---\n**Branches:**\n- `vk/4194-fe-e02-s03-t02-i`\n- `vk/a291-fe-e02-s03-t02-i`\n",
    "branches": [
      "vk/4194-fe-e02-s03-t02-i",
      "vk/a291-fe-e02-s03-t02-i"
    ]
  },
  {
    "title": "FE-E02-S03-T01: Build Fabric Selector",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E02-S03-T01\n- **Module:** Frontend\n- **Epic:** Epic 02\n- **Story:** Story 03\n- **Phase:** 1\n- **Prerequisites:** None\n\nGrid of fabric swatches from API\n\n**File:** `src/components/configurator/FabricSelector.tsx`\n\n## Acceptance Criteria\n- Fetches fabrics from API\r\n- Grid display with swatches\r\n- Selection state visible\r\n- Out of stock handling\r\n- Category filtering\r\n\r\n---\n\n---\n**Branches:**\n- `vk/c5de-fe-e02-s03-t01-b`\n- `vk/dbdb-fe-e02-s03-t01-b`\n",
    "branches": [
      "vk/c5de-fe-e02-s03-t01-b",
      "vk/dbdb-fe-e02-s03-t01-b"
    ]
  },
  {
    "title": "FE-E02-S02-T03: Implement Suspense Boundaries",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E02-S02-T03\n- **Module:** Frontend\n- **Epic:** Epic 02\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nLoading states for 3D assets\n\n**File:** `src/components/configurator/SceneLoading.tsx`\n\n## Acceptance Criteria\n- Loading state while models load\r\n- GPU detection loading state\r\n- Smooth transitions\r\n- User feedback during load\r\n\r\n---\r\n\r\n## Story FE-E02-S03: Configurator Controls\n\n---\n**Branches:**\n- `vk/b108-fe-e02-s02-t03-i`\n- `vk/277b-fe-e02-s02-t03-i`\n",
    "branches": [
      "vk/b108-fe-e02-s02-t03-i",
      "vk/277b-fe-e02-s02-t03-i"
    ]
  },
  {
    "title": "FE-E02-S02-T02: Create Asset Manager",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E02-S02-T02\n- **Module:** Frontend\n- **Epic:** Epic 02\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nLazy load and dispose textures to prevent memory leaks\n\n**File:** `src/lib/AssetManager.ts`\n\n## Acceptance Criteria\n- Reference counting for assets\r\n- Automatic disposal after timeout\r\n- Preloading support\r\n- No memory leaks\r\n\r\n---\n\n---\n**Branches:**\n- `vk/3c1f-fe-e02-s02-t02-c`\n- `vk/febe-fe-e02-s02-t02-c`\n",
    "branches": [
      "vk/3c1f-fe-e02-s02-t02-c",
      "vk/febe-fe-e02-s02-t02-c"
    ]
  },
  {
    "title": "FE-E02-S02-T01: Implement GLTF Loader",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E02-S02-T01\n- **Module:** Frontend\n- **Epic:** Epic 02\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nLoad GLTF models with Draco compression\n\n**File:** `src/components/configurator/SuitModel.tsx`\n\n## Acceptance Criteria\n- GLTF models load with Draco\r\n- Different quality models based on tier\r\n- Animations supported\r\n- Materials applied from config\r\n\r\n---\n\n---\n**Branches:**\n- `vk/42d8-fe-e02-s02-t01-i`\n- `vk/c37e-fe-e02-s02-t01-i`\n",
    "branches": [
      "vk/42d8-fe-e02-s02-t01-i",
      "vk/c37e-fe-e02-s02-t01-i"
    ]
  },
  {
    "title": "FE-E02-S01-T05: Implement Camera Controls",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E02-S01-T05\n- **Module:** Frontend\n- **Epic:** Epic 02\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nOrbitControls with touch support\n\n**File:** `src/components/configurator/CameraController.tsx`\n\n## Acceptance Criteria\n- Orbit controls work with mouse\r\n- Touch support for mobile\r\n- Distance and angle limits\r\n- Smooth damping\r\n- Auto-rotate option\r\n\r\n---\r\n\r\n## Story FE-E02-S02: Asset Loading\n\n---\n**Branches:**\n- `vk/06dc-fe-e02-s01-t05-i`\n- `vk/bfce-fe-e02-s01-t05-i`\n",
    "branches": [
      "vk/06dc-fe-e02-s01-t05-i",
      "vk/bfce-fe-e02-s01-t05-i"
    ]
  },
  {
    "title": "FE-E02-S01-T04: Set Up Lighting",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E02-S01-T04\n- **Module:** Frontend\n- **Epic:** Epic 02\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nEnvironment map + key light setup\n\n**File:** `src/components/configurator/Lighting.tsx`\n\n## Acceptance Criteria\n- Three-point lighting setup\r\n- Environment map for reflections\r\n- Shadow configuration\r\n- Subtle animation for premium feel\r\n\r\n---\n\n---\n**Branches:**\n- `vk/04e2-fe-e02-s01-t04-s`\n- `vk/eb6a-fe-e02-s01-t04-s`\n",
    "branches": [
      "vk/04e2-fe-e02-s01-t04-s",
      "vk/eb6a-fe-e02-s01-t04-s"
    ]
  },
  {
    "title": "FE-E02-S01-T03: Configure Tiered Rendering",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E02-S01-T03\n- **Module:** Frontend\n- **Epic:** Epic 02\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nTier A/B/C quality settings based on device\n\n**File:** `src/components/configurator/QualityProvider.tsx`\n\n## Acceptance Criteria\n- Three quality tiers defined\r\n- Settings adjust shadows, textures, effects\r\n- Context provides settings to components\r\n- Handles loading state\r\n\r\n---\n\n---\n**Branches:**\n- `vk/e31b-fe-e02-s01-t03-c`\n- `vk/e46a-fe-e02-s01-t03-c`\n",
    "branches": [
      "vk/e31b-fe-e02-s01-t03-c",
      "vk/e46a-fe-e02-s01-t03-c"
    ]
  },
  {
    "title": "FE-E02-S01-T02: Implement GPU Tier Detection",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E02-S01-T02\n- **Module:** Frontend\n- **Epic:** Epic 02\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nUse detect-gpu library to determine device capabilities\n\n**File:** `src/hooks/useGPUTier.ts`\n\n## Acceptance Criteria\n- GPU tier detected on mount\r\n- Returns tier, mobile status, GPU name\r\n- Handles detection failures gracefully\r\n- Loading state available\r\n\r\n---\n\n---\n**Branches:**\n- `vk/fea8-fe-e02-s01-t02-i`\n- `vk/0a14-fe-e02-s01-t02-i`\n",
    "branches": [
      "vk/fea8-fe-e02-s01-t02-i",
      "vk/0a14-fe-e02-s01-t02-i"
    ]
  },
  {
    "title": "FE-E02-S01-T01: Set Up R3F Canvas",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E02-S01-T01\n- **Module:** Frontend\n- **Epic:** Epic 02\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nConfigure React Three Fiber with frameloop=\"demand\"\n\n**File:** `src/components/configurator/Scene.tsx`\n\n## Acceptance Criteria\n- Canvas renders with frameloop=\"demand\"\r\n- Quality settings based on GPU tier\r\n- Suspense boundary for loading\r\n- Proper camera setup\r\n\r\n---\n\n---\n**Branches:**\n- `vk/69c0-fe-e02-s01-t01-s`\n- `vk/786a-fe-e02-s01-t01-s`\n",
    "branches": [
      "vk/69c0-fe-e02-s01-t01-s",
      "vk/786a-fe-e02-s01-t01-s"
    ]
  },
  {
    "title": "FE-E01-S03-T03: Implement Session Restore",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E01-S03-T03\n- **Module:** Frontend\n- **Epic:** Epic 01\n- **Story:** Story 03\n- **Phase:** 1\n- **Prerequisites:** None\n\nLoad existing session data on return visit\n\n**File:** `src/hooks/useSessionRestore.ts`\n\n## Acceptance Criteria\n- Session data restored on return visit\r\n- Measurements loaded if they exist\r\n- Config restored if exists\r\n- 404 sessions cleared from local storage\r\n\r\n---\r\n\r\n# EPIC FE-E02: 3D Suit Configurator\r\n\r\n## Story FE-E02-S01: 3D Scene Setup\n\n---\n**Branches:**\n- `vk/7548-fe-e01-s03-t03-i`\n- `vk/b69c-fe-e01-s03-t03-i`\n",
    "branches": [
      "vk/7548-fe-e01-s03-t03-i",
      "vk/b69c-fe-e01-s03-t03-i"
    ]
  },
  {
    "title": "FE-E01-S03-T02: Call Session API",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E01-S03-T02\n- **Module:** Frontend\n- **Epic:** Epic 01\n- **Story:** Story 03\n- **Phase:** 1\n- **Prerequisites:** None\n\nPOST /api/sessions on first load\n\n**File:** `src/components/SessionInitializer.tsx`\n\n## Acceptance Criteria\n- Session created on first visit\r\n- Loading state during initialization\r\n- Children rendered after session ready\r\n\r\n---\n\n---\n**Branches:**\n- `vk/0853-fe-e01-s03-t02-c`\n- `vk/3d81-fe-e01-s03-t02-c`\n",
    "branches": [
      "vk/0853-fe-e01-s03-t02-c",
      "vk/3d81-fe-e01-s03-t02-c"
    ]
  },
  {
    "title": "FE-E01-S03-T01: Create useSession Hook",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E01-S03-T01\n- **Module:** Frontend\n- **Epic:** Epic 01\n- **Story:** Story 03\n- **Phase:** 1\n- **Prerequisites:** None\n\nGenerate UUID and store in localStorage\n\n**File:** `src/hooks/useSession.ts`\n\n## Acceptance Criteria\n- UUID generated/restored from localStorage\r\n- Session ID available throughout app\r\n- Claim function for auth linking\r\n\r\n---\n\n---\n**Branches:**\n- `vk/33c8-fe-e01-s03-t01-c`\n- `vk/43b4-fe-e01-s03-t01-c`\n",
    "branches": [
      "vk/33c8-fe-e01-s03-t01-c",
      "vk/43b4-fe-e01-s03-t01-c"
    ]
  },
  {
    "title": "FE-E01-S02-T03: Implement Responsive Design",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E01-S02-T03\n- **Module:** Frontend\n- **Epic:** Epic 01\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nMobile-first approach with responsive breakpoints\n\n**File:** `src/components/ui/Container.tsx`\n\n## Acceptance Criteria\n- Mobile-first CSS approach\r\n- Breakpoint hooks available\r\n- Container component for consistent spacing\r\n- Utility functions for common tasks\r\n\r\n---\r\n\r\n## Story FE-E01-S03: Session Management\n\n---\n**Branches:**\n- `vk/50fd-fe-e01-s02-t03-i`\n- `vk/ed96-fe-e01-s02-t03-i`\n",
    "branches": [
      "vk/50fd-fe-e01-s02-t03-i",
      "vk/ed96-fe-e01-s02-t03-i"
    ]
  },
  {
    "title": "FE-E01-S02-T02: Create Layout Components",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E01-S02-T02\n- **Module:** Frontend\n- **Epic:** Epic 01\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nBuild Header, Footer, and Sidebar components\n\n**File:** `src/components/layout/Header.tsx`\n\n## Acceptance Criteria\n- Header with navigation and cart\r\n- Mobile menu toggle\r\n- Footer with links\r\n- Responsive design\r\n\r\n---\n\n---\n**Branches:**\n- `vk/00ce-fe-e01-s02-t02-c`\n- `vk/3c46-fe-e01-s02-t02-c`\n",
    "branches": [
      "vk/00ce-fe-e01-s02-t02-c",
      "vk/3c46-fe-e01-s02-t02-c"
    ]
  },
  {
    "title": "FE-E01-S02-T01: Implement Dual-Track Router",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E01-S02-T01\n- **Module:** Frontend\n- **Epic:** Epic 01\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nParse invite_token URL param to determine Track A vs Track B\n\n**File:** `src/app/layout.tsx`\n\n## Acceptance Criteria\n- Invite token parsed from URL\r\n- Track type set in store\r\n- Middleware redirects invite links\r\n- Admin routes protected\r\n\r\n---\n\n---\n**Branches:**\n- `vk/5b66-fe-e01-s02-t01-i`\n- `vk/5a5b-fe-e01-s02-t01-i`\n",
    "branches": [
      "vk/5b66-fe-e01-s02-t01-i",
      "vk/5a5b-fe-e01-s02-t01-i"
    ]
  },
  {
    "title": "FE-E01-S01-T04: Configure Environment",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E01-S01-T04\n- **Module:** Frontend\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nSet up environment variables for different environments\n\n**File:** `.env.local`\n\n## Acceptance Criteria\n- Environment variables load correctly\r\n- Different configs for dev/prod\r\n- Validation at build time\r\n- Type-safe env access\r\n\r\n---\r\n\r\n## Story FE-E01-S02: Routing and Layout\n\n---\n**Branches:**\n- `vk/3701-fe-e01-s01-t04-c`\n- `vk/f213-fe-e01-s01-t04-c`\n",
    "branches": [
      "vk/3701-fe-e01-s01-t04-c",
      "vk/f213-fe-e01-s01-t04-c"
    ]
  },
  {
    "title": "FE-E01-S01-T03: Set Up Zustand Store",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E01-S01-T03\n- **Module:** Frontend\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nCreate Zustand store structure with slices for state management\n\n**File:** `src/store/index.ts`\n\n## Acceptance Criteria\n- Store structure with 5 slices\r\n- Persistence for session and cart\r\n- DevTools integration\r\n- All actions typed\r\n\r\n---\n\n---\n**Branches:**\n- `vk/eee7-fe-e01-s01-t03-s`\n- `vk/7155-fe-e01-s01-t03-s`\n",
    "branches": [
      "vk/eee7-fe-e01-s01-t03-s",
      "vk/7155-fe-e01-s01-t03-s"
    ]
  },
  {
    "title": "FE-E01-S01-T02: Configure Tailwind",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E01-S01-T02\n- **Module:** Frontend\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nSet up Tailwind CSS with custom theme for SUIT AI branding\n\n**File:** `tailwind.config.ts`\n\n## Acceptance Criteria\n- Brand colors available as Tailwind classes\r\n- Custom components (btn-primary, etc.) work\r\n- Fonts configured\r\n\r\n---\n\n---\n**Branches:**\n- `vk/7dcb-fe-e01-s01-t02-c`\n- `vk/c490-fe-e01-s01-t02-c`\n",
    "branches": [
      "vk/7dcb-fe-e01-s01-t02-c",
      "vk/c490-fe-e01-s01-t02-c"
    ]
  },
  {
    "title": "FE-E01-S01-T01: Initialize Next.js 14",
    "status": "inreview",
    "labels": [
      "in-review",
      "fe"
    ],
    "body": "## Metadata\n- **Task ID:** FE-E01-S01-T01\n- **Module:** Frontend\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nCreate Next.js 14 app with TypeScript and App Router\r\n\r\n**Commands:**\n\n**File:** `package.json`\n\n## Acceptance Criteria\n- Project runs with `npm run dev`\r\n- TypeScript compiles without errors\r\n- App Router structure in place\r\n\r\n---\n\n---\n**Branches:**\n- `vk/b13c-fe-e01-s01-t01-i`\n- `vk/b63c-fe-e01-s01-t01-i`\n",
    "branches": [
      "vk/b13c-fe-e01-s01-t01-i",
      "vk/b63c-fe-e01-s01-t01-i"
    ]
  },
  {
    "title": "VIS-E03-S02-T04: Update Frontend Mesh",
    "status": "inreview",
    "labels": [
      "in-review",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E03-S02-T04\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 03\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nStream new mesh back to client after re-optimization\n\n**File:** `vision_service/api/mesh_stream.py`\n\n## Acceptance Criteria\n- REST endpoint for one-time mesh generation\r\n- WebSocket for real-time streaming\r\n- Returns Three.js-compatible format\r\n- Computes vertex normals\r\n\r\n---\r\n\r\n# Summary\r\n\r\n| Epic | Story | Tasks | Status |\r\n|------|-------|-------|--------|\r\n| VIS-E01 | S01: Height Calibration | 4 | Detailed |\r\n| VIS-E01 | S02: ArUco Fallback | 4 | Detailed |\r\n| VIS-E02 | S01: Pose and Shape | 6 | Detailed |\r\n| VIS-E02 | S02: Temporal Filtering | 4 | Detailed |\r\n| VIS-E03 | S01: Virtual Anthropometry | 6 | Detailed |\r\n| VIS-E03 | S02: Inverse Anthropometry | 4 | Detailed |\r\n| **Total** | | **28** | |\r\n\r\n---\r\n\r\n*End of VIS Module Detailed Tasks*\n\n---\n**Branches:**\n- `vk/d89e-vis-e03-s02-t04`\n- `vk/c2d2-vis-e03-s02-t04`\n",
    "branches": [
      "vk/d89e-vis-e03-s02-t04",
      "vk/c2d2-vis-e03-s02-t04"
    ]
  },
  {
    "title": "VIS-E03-S02-T03: Create Re-optimization Endpoint",
    "status": "inreview",
    "labels": [
      "in-review",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E03-S02-T03\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 03\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nPOST /api/measurements/:id/optimize for user corrections\n\n**File:** `src/app/api/measurements/[id]/optimize/route.ts`\n\n## Acceptance Criteria\n- Accepts user corrections\r\n- Calls vision service for re-optimization\r\n- Updates database with new betas\r\n- Tracks user overrides\r\n\r\n---\n\n---\n**Branches:**\n- `vk/2911-vis-e03-s02-t03`\n- `vk/8ebf-vis-e03-s02-t03`\n",
    "branches": [
      "vk/2911-vis-e03-s02-t03",
      "vk/8ebf-vis-e03-s02-t03"
    ]
  },
  {
    "title": "VIS-E03-S02-T02: Implement Optimization Loop",
    "status": "inreview",
    "labels": [
      "in-review",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E03-S02-T02\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 03\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nL2 loss + shape prior regularization for inverse fitting\n\n**File:** `vision_service/measurements/optimize.py`\n\n## Acceptance Criteria\n- Converges in <3 seconds\r\n- Uses L2 loss with weighted measurements\r\n- Shape prior regularization\r\n- Early stopping for efficiency\r\n\r\n---\n\n---\n**Branches:**\n- `vk/d19e-vis-e03-s02-t02`\n- `vk/b6fe-vis-e03-s02-t02`\n",
    "branches": [
      "vk/d19e-vis-e03-s02-t02",
      "vk/b6fe-vis-e03-s02-t02"
    ]
  },
  {
    "title": "VIS-E03-S02-T01: Define Differentiable Measurement Function",
    "status": "inreview",
    "labels": [
      "in-review",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E03-S02-T01\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 03\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nPyTorch forward pass for measurement extraction\n\n**File:** `vision_service/measurements/differentiable.py`\n\n## Acceptance Criteria\n- Gradients flow through measurement computation\r\n- All operations are differentiable\r\n- Circumferences approximated with sampled points\r\n- Supports batched inputs\r\n\r\n---\n\n---\n**Branches:**\n- `vk/bc8c-vis-e03-s02-t01`\n- `vk/7aad-vis-e03-s02-t01`\n",
    "branches": [
      "vk/bc8c-vis-e03-s02-t01",
      "vk/7aad-vis-e03-s02-t01"
    ]
  },
  {
    "title": "VIS-E03-S01-T06: Store in Database",
    "status": "inreview",
    "labels": [
      "in-review",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E03-S01-T06\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 03\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nSave measurements to Supabase with session link\n\n**File:** `src/app/api/measurements/route.ts`\n\n## Acceptance Criteria\n- Stores all 28 measurements\r\n- Links to session\r\n- Stores SMPL-X beta for re-optimization\r\n- Returns measurement ID\r\n\r\n---\r\n\r\n## Story VIS-E03-S02: Inverse Anthropometry\n\n---\n**Branches:**\n- `vk/cdbb-vis-e03-s01-t06`\n- `vk/cfe6-vis-e03-s01-t06`\n",
    "branches": [
      "vk/cdbb-vis-e03-s01-t06",
      "vk/cfe6-vis-e03-s01-t06"
    ]
  },
  {
    "title": "VIS-E03-S01-T05: Extract 28 Measurements",
    "status": "inreview",
    "labels": [
      "in-review",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E03-S01-T05\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 03\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nExtract full tailoring measurement set\n\n**File:** `vision_service/measurements/extract_all.py`\n\n## Acceptance Criteria\n- Extracts all 28 measurements\r\n- Uses geodesic for curved surfaces\r\n- Uses slicing for circumferences\r\n- Returns structured dataclass\r\n\r\n---\n\n---\n**Branches:**\n- `vk/8ed8-vis-e03-s01-t05`\n- `vk/875e-vis-e03-s01-t05`\n",
    "branches": [
      "vk/8ed8-vis-e03-s01-t05",
      "vk/875e-vis-e03-s01-t05"
    ]
  },
  {
    "title": "VIS-E03-S01-T04: Implement Planar Slicing",
    "status": "inreview",
    "labels": [
      "in-review",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E03-S01-T04\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 03\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nPlane-mesh intersection for circumference measurements\n\n**File:** `vision_service/measurements/circumference.py`\n\n## Acceptance Criteria\n- Slices mesh with arbitrary plane\r\n- Returns closed contour points\r\n- Calculates perimeter correctly\r\n- Handles edge cases\r\n\r\n---\n\n---\n**Branches:**\n- `vk/cde0-vis-e03-s01-t04`\n- `vk/f642-vis-e03-s01-t04`\n",
    "branches": [
      "vk/cde0-vis-e03-s01-t04",
      "vk/f642-vis-e03-s01-t04"
    ]
  },
  {
    "title": "VIS-E03-S01-T03: Implement Geodesic Measurements",
    "status": "inreview",
    "labels": [
      "in-review",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E03-S01-T03\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 03\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nDijkstra pathfinding for surface-following lengths\n\n**File:** `vision_service/measurements/geodesic.py`\n\n## Acceptance Criteria\n- Uses Dijkstra for shortest paths\r\n- Returns surface-following distances\r\n- Can measure multi-point paths\r\n- Returns path for visualization\r\n\r\n---\n\n---\n**Branches:**\n- `vk/cf1f-vis-e03-s01-t03`\n",
    "branches": [
      "vk/cf1f-vis-e03-s01-t03"
    ]
  },
  {
    "title": "VIS-E03-S01-T02: Load SMPL-Anthropometry Landmarks",
    "status": "done",
    "labels": [
      "done",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E03-S01-T02\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 03\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nLoad 70+ vertex index definitions for body landmarks\n\n**File:** `vision_service/measurements/landmarks.py`\n\n## Acceptance Criteria\n- 70+ vertex indices defined\r\n- Covers all measurement points\r\n- Circumference paths defined\r\n- Easy landmark lookup\r\n\r\n---\n\n---\n**Branches:**\n- `vk/83a5-vis-e03-s01-t02`\n",
    "branches": [
      "vk/83a5-vis-e03-s01-t02"
    ]
  },
  {
    "title": "VIS-E03-S01-T01: Implement A-Pose Normalization",
    "status": "done",
    "labels": [
      "done",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E03-S01-T01\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 03\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nSet pose to neutral A-pose while preserving shape\n\n**File:** `vision_service/measurements/apose.py`\n\n## Acceptance Criteria\n- Outputs consistent A-pose\r\n- Preserves beta (shape) parameters\r\n- Arms at ~45 degrees for clear measurements\r\n- Joint positions available\r\n\r\n---\n\n---\n**Branches:**\n- `vk/33d4-vis-e03-s01-t01`\n",
    "branches": [
      "vk/33d4-vis-e03-s01-t01"
    ]
  },
  {
    "title": "VIS-E02-S02-T04: Average Over 300 Frames",
    "status": "done",
    "labels": [
      "done",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E02-S02-T04\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 02\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nCalculate geometric median for final \"Universal Measurement ID\"\n\n**File:** `vision_service/filtering/measurement_lock.py`\n\n## Acceptance Criteria\n- Locks after 300 stable frames\r\n- Uses geometric median (robust to outliers)\r\n- Generates unique \"Universal Measurement ID\"\r\n- Provides progress/confidence for UI\r\n\r\n---\r\n\r\n# EPIC VIS-E03: Measurement Extraction\r\n\r\n## Story VIS-E03-S01: Virtual Anthropometry\n\n---\n**Branches:**\n- `vk/7b30-vis-e02-s02-t04`\n",
    "branches": [
      "vk/7b30-vis-e02-s02-t04"
    ]
  },
  {
    "title": "VIS-E02-S02-T03: Implement Warm-up Period",
    "status": "inreview",
    "labels": [
      "in-review",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E02-S02-T03\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 02\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nWait 60 frames before considering beta stable\n\n**File:** `vision_service/filtering/warmup.py`\n\n## Acceptance Criteria\n- Waits 60 frames minimum\r\n- Returns `beta_is_stable` flag\r\n- Provides stability score for UI\r\n- Handles reset for new scans\r\n\r\n---\n\n---\n**Branches:**\n- `vk/9cdd-vis-e02-s02-t03`\n- `vk/c5c9-vis-e02-s02-t03`\n",
    "branches": [
      "vk/9cdd-vis-e02-s02-t03",
      "vk/c5c9-vis-e02-s02-t03"
    ]
  },
  {
    "title": "VIS-E02-S02-T02: Implement OneEuro Filter",
    "status": "done",
    "labels": [
      "done",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E02-S02-T02\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 02\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nLow-lag filter for pose parameters\n\n**File:** `vision_service/filtering/one_euro_filter.py`\n\n## Acceptance Criteria\n- Smooth animation with low latency\r\n- Adaptive to movement speed\r\n- Per-joint filtering\r\n- Easy reset\r\n\r\n---\n\n---\n**Branches:**\n- `vk/4c72-vis-e02-s02-t02`\n",
    "branches": [
      "vk/4c72-vis-e02-s02-t02"
    ]
  },
  {
    "title": "VIS-E02-S02-T01: Implement Kalman Filter",
    "status": "done",
    "labels": [
      "done",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E02-S02-T01\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 02\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nFilter for 10-dim beta vector stability\n\n**File:** `vision_service/filtering/kalman_filter.py`\n\n## Acceptance Criteria\n- Smooths 10-dim beta vector\r\n- Provides uncertainty estimate\r\n- Can be reset for new sessions\r\n- Low latency update\r\n\r\n---\n\n---\n**Branches:**\n- `vk/02ee-vis-e02-s02-t01`\n",
    "branches": [
      "vk/02ee-vis-e02-s02-t01"
    ]
  },
  {
    "title": "VIS-E02-S01-T06: Fuse Pose and Shape",
    "status": "done",
    "labels": [
      "done",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E02-S01-T06\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 02\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nCombine HMR theta (pose) + SHAPY beta (shape) into final SMPL-X\n\n**File:** `vision_service/reconstruction/fuse_params.py`\n\n## Acceptance Criteria\n- Combines HMR pose + SHAPY shape\r\n- Outputs complete SMPL-X mesh\r\n- Provides A-pose option for measurements\r\n- Handles coordinate conversion\r\n\r\n---\r\n\r\n## Story VIS-E02-S02: Temporal Filtering\n\n---\n**Branches:**\n- `vk/f8bf-vis-e02-s01-t06`\n",
    "branches": [
      "vk/f8bf-vis-e02-s01-t06"
    ]
  },
  {
    "title": "VIS-E02-S01-T05: Implement MHR-to-SMPL-X Bridge",
    "status": "done",
    "labels": [
      "done",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E02-S01-T05\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 02\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nGradient descent optimization to convert MHR output to SMPL-X\n\n**File:** `vision_service/reconstruction/mhr_bridge.py`\n\n## Acceptance Criteria\n- Converts MHR mesh to SMPL-X parameters\r\n- Uses gradient descent optimization\r\n- Includes shape regularization\r\n- Handles vertex count mismatch\r\n\r\n---\n\n---\n**Branches:**\n- `vk/9dd9-vis-e02-s01-t05`\n",
    "branches": [
      "vk/9dd9-vis-e02-s01-t05"
    ]
  },
  {
    "title": "VIS-E02-S01-T04: Implement SHAPY Shape",
    "status": "inreview",
    "labels": [
      "in-review",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E02-S01-T04\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 02\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nExtract accurate shape (beta) parameters using SHAPY\n\n**File:** `vision_service/reconstruction/shapy_shape.py`\n\n## Acceptance Criteria\n- Returns 10-dim beta vector\r\n- Includes predicted measurements\r\n- Uses height prior when available\r\n- Provides confidence score\r\n\r\n---\n\n---\n**Branches:**\n- `vk/daaa-vis-e02-s01-t04`\n- `vk/b3bd-vis-e02-s01-t04`\n",
    "branches": [
      "vk/daaa-vis-e02-s01-t04",
      "vk/b3bd-vis-e02-s01-t04"
    ]
  },
  {
    "title": "VIS-E02-S01-T03: Implement HMR 2.0 Pose",
    "status": "done",
    "labels": [
      "done",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E02-S01-T03\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 02\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nExtract robust pose (theta) parameters using HMR 2.0\n\n**File:** `vision_service/reconstruction/hmr_pose.py`\n\n## Acceptance Criteria\n- Returns 72-dim pose vector (axis-angle)\r\n- Also provides rotation matrices\r\n- Includes confidence score\r\n- Preprocesses images correctly\r\n\r\n---\n\n---\n**Branches:**\n- `vk/82bb-vis-e02-s01-t03`\n",
    "branches": [
      "vk/82bb-vis-e02-s01-t03"
    ]
  },
  {
    "title": "VIS-E02-S01-T02: Implement SAM-Body4D",
    "status": "done",
    "labels": [
      "done",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E02-S01-T02\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 02\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\n4D reconstruction with temporal consistency (placeholder for research model)\n\n**File:** `vision_service/reconstruction/body4d.py`\n\n## Acceptance Criteria\n- Returns MHR mesh sequence\r\n- Maintains temporal buffer\r\n- Provides averaged shape parameters\r\n- Ready for real model integration\r\n\r\n---\n\n---\n**Branches:**\n- `vk/83cc-vis-e02-s01-t02`\n",
    "branches": [
      "vk/83cc-vis-e02-s01-t02"
    ]
  },
  {
    "title": "VIS-E02-S01-T01: Implement SAM 3 Segmentation",
    "status": "done",
    "labels": [
      "done",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E02-S01-T01\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 02\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nUse Segment Anything Model for person segmentation\n\n**File:** `vision_service/segmentation/sam_segment.py`\n\n## Acceptance Criteria\n- Returns binary person mask\r\n- Supports point and box prompts\r\n- Runs on CUDA GPU\r\n- Selects best mask from multi-mask output\r\n\r\n---\n\n---\n**Branches:**\n- `vk/9a12-vis-e02-s01-t01`\n",
    "branches": [
      "vk/9a12-vis-e02-s01-t01"
    ]
  },
  {
    "title": "VIS-E01-S02-T04: Implement Calibration Lock",
    "status": "done",
    "labels": [
      "done",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E01-S02-T04\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 01\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nFreeze scale after 30 stable frames\n\n**File:** `vision_service/calibration/calibration_lock.py`\n\n## Acceptance Criteria\n- Locks after 30 stable frames\r\n- Stability measured by coefficient of variation\r\n- Provides stability score for UI feedback\r\n- Can be reset if needed\r\n\r\n---\r\n\r\n# EPIC VIS-E02: Hybrid Human Mesh Recovery\r\n\r\n## Story VIS-E02-S01: Pose and Shape Estimation\n\n---\n**Branches:**\n- `vk/ae4f-vis-e01-s02-t04`\n",
    "branches": [
      "vk/ae4f-vis-e01-s02-t04"
    ]
  },
  {
    "title": "VIS-E01-S02-T03: Calculate Scale from Marker",
    "status": "done",
    "labels": [
      "done",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E01-S02-T03\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 01\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nDerive scale = known_marker_size / pixel_size\n\n**File:** `vision_service/calibration/aruco_scale.py`\n\n## Acceptance Criteria\n- Returns mm per pixel scale factor\r\n- Works with or without PnP\r\n- Confidence score reflects method quality\r\n\r\n---\n\n---\n**Branches:**\n- `vk/2bee-vis-e01-s02-t03`\n",
    "branches": [
      "vk/2bee-vis-e01-s02-t03"
    ]
  },
  {
    "title": "VIS-E01-S02-T02: Implement PnP Solver",
    "status": "inreview",
    "labels": [
      "in-review",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E01-S02-T02\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 01\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nUse cv2.solvePnP to get marker depth from camera\n\n**File:** `vision_service/calibration/pnp_solver.py`\n\n## Acceptance Criteria\n- Returns tvec with Z-depth in mm\r\n- Uses IPPE_SQUARE for planar marker\r\n- Handles failure gracefully\r\n- Default camera matrix for uncalibrated cameras\r\n\r\n---\n\n---\n**Branches:**\n- `vk/50f9-vis-e01-s02-t02`\n- `vk/d338-vis-e01-s02-t02`\n",
    "branches": [
      "vk/50f9-vis-e01-s02-t02",
      "vk/d338-vis-e01-s02-t02"
    ]
  },
  {
    "title": "VIS-E01-S02-T01: Implement ArUco Detection",
    "status": "inreview",
    "labels": [
      "in-review",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E01-S02-T01\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 01\n- **Story:** Story 02\n- **Phase:** 1\n- **Prerequisites:** None\n\nDetect ArUco markers using OpenCV DICT_4X4_50\n\n**File:** `vision_service/calibration/aruco_detect.py`\n\n## Acceptance Criteria\n- Detects DICT_4X4_50 markers\r\n- Returns 4 corner coordinates per marker\r\n- Handles multiple markers\r\n- Visualization helper included\r\n\r\n---\n\n---\n**Branches:**\n- `vk/bd3c-vis-e01-s02-t01`\n- `vk/61e8-vis-e01-s02-t01`\n",
    "branches": [
      "vk/bd3c-vis-e01-s02-t01",
      "vk/61e8-vis-e01-s02-t01"
    ]
  },
  {
    "title": "VIS-E01-S01-T04: Apply Scale to Mesh",
    "status": "inreview",
    "labels": [
      "in-review",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E01-S01-T04\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nMultiply all vertices by scale factor to convert to millimeters\n\n**File:** `vision_service/calibration/apply_scale.py`\n\n## Acceptance Criteria\n- All vertices multiplied by scale factor\r\n- Mesh now in millimeters\r\n- Joint positions also scaled\r\n- Unit tracking for downstream processing\r\n\r\n---\r\n\r\n## Story VIS-E01-S02: ArUco Fallback Calibration\n\n---\n**Branches:**\n- `vk/7101-vis-e01-s01-t04`\n- `vk/56c6-vis-e01-s01-t04`\n",
    "branches": [
      "vk/7101-vis-e01-s01-t04",
      "vk/56c6-vis-e01-s01-t04"
    ]
  },
  {
    "title": "VIS-E01-S01-T03: Derive Scale Factor",
    "status": "done",
    "labels": [
      "done",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E01-S01-T03\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nCalculate scale = real_height / mesh_height\n\n**File:** `vision_service/calibration/scale.py`\n\n## Acceptance Criteria\n- Scale factor calculated correctly\r\n- Outputs in millimeters for tailoring precision\r\n- Confidence score provided\r\n- Validation catches unreasonable values\r\n\r\n---\n\n---\n**Branches:**\n- `vk/4c2a-vis-e01-s01-t03`\n",
    "branches": [
      "vk/4c2a-vis-e01-s01-t03"
    ]
  },
  {
    "title": "VIS-E01-S01-T02: Calculate Mesh Height",
    "status": "inreview",
    "labels": [
      "in-review",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E01-S01-T02\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nMeasure vertex distance from heel to crown in SMPL-X mesh\n\n**File:** `vision_service/calibration/mesh_height.py`\n\n## Acceptance Criteria\n- Returns unitless height value from mesh\r\n- Uses SMPL-X vertex indices for heel and crown\r\n- Robust method handles edge cases\r\n\r\n---\n\n---\n**Branches:**\n- `vk/46af-vis-e01-s01-t02`\n- `vk/80c2-vis-e01-s01-t02`\n",
    "branches": [
      "vk/46af-vis-e01-s01-t02",
      "vk/80c2-vis-e01-s01-t02"
    ]
  },
  {
    "title": "VIS-E01-S01-T01: Create Height Input Endpoint",
    "status": "done",
    "labels": [
      "done",
      "vis"
    ],
    "body": "## Metadata\n- **Task ID:** VIS-E01-S01-T01\n- **Module:** Vision & Measurement Service\n- **Epic:** Epic 01\n- **Story:** Story 01\n- **Phase:** 1\n- **Prerequisites:** None\n\nPOST /api/sessions/:id/height - Store user-reported height for mesh scaling\n\n**File:** `src/app/api/sessions/[id]/height/route.ts`\n\n## Acceptance Criteria\n- Height stored in session record\r\n- Validation rejects values outside 100-250cm range\r\n- Returns session ID and stored height\r\n\r\n---\n\n---\n**Branches:**\n- `vk/9d00-vis-e01-s01-t01`\n- `vk/c2d2-vis-e01-s01-t01`\n",
    "branches": [
      "vk/9d00-vis-e01-s01-t01",
      "vk/c2d2-vis-e01-s01-t01"
    ]
  },
  {
    "title": "API-E03-S01-T05: Implement State Validation",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E03-S01-T05\n- **Module:** API - Core API & User Management  \n- **Epic:** Order State Machine  \n- **Story:** Order Management Endpoints  \n- **Phase:** 2\n- **Prerequisites:** API-E03-S01-T04\n\n### Description\r\nImplement a validation layer that checks state transitions are legal before allowing them. Provides clear error messages for invalid transitions.\r\n\r\n### Acceptance Criteria\r\n- [ ] Validates all state transitions\r\n- [ ] Returns valid next states for current state\r\n- [ ] Provides clear error messages\r\n- [ ] Works with both API and admin UI\r\n- [ ] Handles edge cases (already at terminal state)\r\n\r\n### Implementation Details\r\n```typescript\r\n// lib/orders/state-machine.ts\r\nexport const STATE_TRANSITIONS: Record<string, string[]> = {\r\n  'S01_PAID': ['S02_MEASUREMENT_PENDING'],\r\n  'S02_MEASUREMENT_PENDING': ['S03_MEASUREMENT_RECEIVED'],\r\n  'S03_MEASUREMENT_RECEIVED': ['S04_PATTERN_PENDING'],\r\n  'S04_PATTERN_PENDING': ['S05_PATTERN_GENERATED'],\r\n  'S05_PATTERN_GENERATED': ['S06_SENT_TO_PRINTER'],\r\n  'S06_SENT_TO_PRINTER': ['S07_PRINT_COLLECTED', 'S08_PRINT_REJECTED'],\r\n  'S07_PRINT_COLLECTED': ['S09_DELIVERED_TO_RAJA'],\r\n  'S08_PRINT_REJECTED': ['S06_SENT_TO_PRINTER'],\r\n  'S09_DELIVERED_TO_RAJA': ['S10_CUTTING_IN_PROGRESS'],\r\n  'S10_CUTTING_IN_PROGRESS': ['S11_CUTTING_COMPLETE'],\r\n  'S11_CUTTING_COMPLETE': ['S12_STITCHING_IN_PROGRESS'],\r\n  'S12_STITCHING_IN_PROGRESS': ['S13_STITCHING_COMPLETE'],\r\n  'S13_STITCHING_COMPLETE': ['S14_QC_IN_PROGRESS'],\r\n  'S14_QC_IN_PROGRESS': ['S15_QC_PASSED', 'S16_QC_FAILED'],\r\n  'S15_QC_PASSED': ['S17_SHIPPED'],\r\n  'S16_QC_FAILED': ['S12_STITCHING_IN_PROGRESS'],\r\n  'S17_SHIPPED': ['S18_DELIVERED'],\r\n  'S18_DELIVERED': ['S19_COMPLETE'],\r\n  'S19_COMPLETE': [],\r\n};\r\n\r\nexport const STATE_LABELS: Record<string, string> = {\r\n  'S01_PAID': 'Paid',\r\n  'S02_MEASUREMENT_PENDING': 'Awaiting Measurements',\r\n  'S03_MEASUREMENT_RECEIVED': 'Measurements Received',\r\n  'S04_PATTERN_PENDING': 'Pattern Generation Pending',\r\n  'S\n\n---\n**Branches:**\n- `vk/0bcf-api-e03-s01-t05`\n",
    "branches": [
      "vk/0bcf-api-e03-s01-t05"
    ]
  },
  {
    "title": "API-E03-S01-T04: PATCH /api/orders/:id/state",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E03-S01-T04\n- **Module:** API - Core API & User Management  \n- **Epic:** Order State Machine  \n- **Story:** Order Management Endpoints  \n- **Phase:** 2\n- **Prerequisites:** API-E03-S01-T01\n\n### Description\r\nTransition an order to a new state. Admin only. Validates the transition is legal according to the state machine.\r\n\r\n### Acceptance Criteria\r\n- [ ] Updates order state\r\n- [ ] Validates transition is legal\r\n- [ ] Records in state history with notes\r\n- [ ] Admin role required\r\n- [ ] Returns error for invalid transitions\r\n\r\n### Implementation Details\r\n```typescript\r\n// app/api/orders/[id]/state/route.ts\r\nexport async function PATCH(\r\n  request: NextRequest,\r\n  { params }: { params: { id: string } }\r\n) {\r\n  const supabase = createRouteHandlerClient({ cookies });\r\n  const orderId = params.id;\r\n\r\n  const { data: { user } } = await supabase.auth.getUser();\r\n  if (!user) {\r\n    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n  }\r\n\r\n  // Check admin role (you'd have a proper role check)\r\n  const { data: userProfile } = await supabase\r\n    .from('users')\r\n    .select('role')\r\n    .eq('id', user.id)\r\n    .single();\r\n\r\n  if (userProfile?.role !== 'admin') {\r\n    return NextResponse.json({ error: 'Admin access required' }, { status: 403 });\r\n  }\r\n\r\n  try {\r\n    const body = await request.json();\r\n    const { new_state, notes } = body;\r\n\r\n    if (!new_state) {\r\n      return NextResponse.json(\r\n        { error: 'new_state is required' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Update state (trigger will validate and record history)\r\n    const { data: order, error } = await supabase\r\n      .from('orders')\r\n      .update({ \r\n        current_state: new_state,\r\n        updated_at: new Date().toISOString()\r\n      })\r\n      .eq('id', orderId)\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      // Check if it's a state transition error\r\n      if (error.message.includes('Invalid state transition')) {\r\n        r\n\n---\n**Branches:**\n- `vk/7339-api-e03-s01-t04`\n",
    "branches": [
      "vk/7339-api-e03-s01-t04"
    ]
  },
  {
    "title": "API-E03-S01-T03: GET /api/orders/:id",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E03-S01-T03\n- **Module:** API - Core API & User Management  \n- **Epic:** Order State Machine  \n- **Story:** Order Management Endpoints  \n- **Phase:** 2\n- **Prerequisites:** API-E03-S01-T01\n\n### Description\r\nGet detailed order information including all items, measurements, and state history.\r\n\r\n### Acceptance Criteria\r\n- [ ] Returns full order with items\r\n- [ ] Includes state history timeline\r\n- [ ] Includes measurement summaries\r\n- [ ] Only accessible by owner\r\n- [ ] Returns 404 if not found\r\n\r\n### Implementation Details\r\n```typescript\r\n// app/api/orders/[id]/route.ts\r\nexport async function GET(\r\n  request: NextRequest,\r\n  { params }: { params: { id: string } }\r\n) {\r\n  const supabase = createRouteHandlerClient({ cookies });\r\n  const orderId = params.id;\r\n\r\n  const { data: { user } } = await supabase.auth.getUser();\r\n  if (!user) {\r\n    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n  }\r\n\r\n  const { data: order, error } = await supabase\r\n    .from('orders')\r\n    .select(`\r\n      *,\r\n      items:order_items (\r\n        *,\r\n        suit_config:suit_configs (\r\n          *,\r\n          fabric:fabrics (name, code, color_hex)\r\n        ),\r\n        measurement:measurements (\r\n          id,\r\n          chest_circumference,\r\n          waist_circumference,\r\n          hip_circumference,\r\n          shoulder_width,\r\n          created_at\r\n        ),\r\n        pattern_files (\r\n          id,\r\n          file_type,\r\n          file_url,\r\n          calibration_verified,\r\n          created_at\r\n        )\r\n      ),\r\n      state_history:order_state_history (\r\n        from_state,\r\n        to_state,\r\n        notes,\r\n        created_at\r\n      )\r\n    `)\r\n    .eq('id', orderId)\r\n    .single();\r\n\r\n  if (error || !order) {\r\n    return NextResponse.json({ error: 'Order not found' }, { status: 404 });\r\n  }\r\n\r\n  // Verify ownership\r\n  if (order.user_id !== user.id) {\r\n    return NextResponse.json({ error: 'Access denied' }, { status: 403 });\r\n  }\r\n\r\n \n\n---\n**Branches:**\n- `vk/83fb-api-e03-s01-t03`\n",
    "branches": [
      "vk/83fb-api-e03-s01-t03"
    ]
  },
  {
    "title": "API-E03-S01-T02: GET /api/orders",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E03-S01-T02\n- **Module:** API - Core API & User Management  \n- **Epic:** Order State Machine  \n- **Story:** Order Management Endpoints  \n- **Phase:** 2\n- **Prerequisites:** API-E03-S01-T01\n\n### Description\r\nList all orders for the authenticated user with pagination and optional status filtering.\r\n\r\n### Acceptance Criteria\r\n- [ ] Returns paginated order list\r\n- [ ] Filters by status if specified\r\n- [ ] Includes item count per order\r\n- [ ] Sorted by created_at descending\r\n- [ ] Requires authentication\r\n\r\n### Implementation Details\r\n```typescript\r\n// app/api/orders/route.ts\r\nexport async function GET(request: NextRequest) {\r\n  const supabase = createRouteHandlerClient({ cookies });\r\n  \r\n  const { data: { user } } = await supabase.auth.getUser();\r\n  if (!user) {\r\n    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n  }\r\n\r\n  const { searchParams } = new URL(request.url);\r\n  const status = searchParams.get('status');\r\n  const page = parseInt(searchParams.get('page') || '1');\r\n  const limit = parseInt(searchParams.get('limit') || '10');\r\n  const offset = (page - 1) * limit;\r\n\r\n  let query = supabase\r\n    .from('orders')\r\n    .select(`\r\n      *,\r\n      items:order_items (count)\r\n    `, { count: 'exact' })\r\n    .eq('user_id', user.id)\r\n    .order('created_at', { ascending: false })\r\n    .range(offset, offset + limit - 1);\r\n\r\n  if (status) {\r\n    query = query.eq('current_state', status);\r\n  }\r\n\r\n  const { data: orders, error, count } = await query;\r\n\r\n  if (error) {\r\n    return NextResponse.json({ error: 'Failed to fetch orders' }, { status: 500 });\r\n  }\r\n\r\n  return NextResponse.json({\r\n    orders,\r\n    pagination: {\r\n      page,\r\n      limit,\r\n      total: count,\r\n      pages: Math.ceil((count || 0) / limit)\r\n    }\r\n  });\r\n}\r\n```\r\n\r\n### Definition of Done\r\nReturns paginated order list for authenticated user\n\n---\n**Branches:**\n- `vk/6284-api-e03-s01-t02`\n",
    "branches": [
      "vk/6284-api-e03-s01-t02"
    ]
  },
  {
    "title": "API-E03-S01-T01: POST /api/orders",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E03-S01-T01\n- **Module:** API - Core API & User Management  \n- **Epic:** Order State Machine  \n- **Story:** Order Management Endpoints  \n- **Phase:** 2\n- **Prerequisites:** DB-E03-S01 complete\n\n### Description\r\nCreate a new order after successful payment. Typically called by the Stripe webhook handler. Sets initial state to S01_PAID.\r\n\r\n### Acceptance Criteria\r\n- [ ] Creates order with S01_PAID state\r\n- [ ] Links to user and payment intent\r\n- [ ] Creates order items from cart\r\n- [ ] Calculates totals correctly\r\n- [ ] Records in state history\r\n\r\n### Implementation Details\r\n```typescript\r\n// lib/orders/create-order.ts\r\ninterface CreateOrderParams {\r\n  user_id: string;\r\n  stripe_payment_intent: string;\r\n  track_type: 'A' | 'B';\r\n  wedding_event_id?: string;\r\n  items: {\r\n    suit_config_id: string;\r\n    measurement_id?: string;\r\n    wedding_attendee_id?: string;\r\n    unit_price_gbp: number;\r\n    fabric_modifier: number;\r\n  }[];\r\n  shipping: {\r\n    name: string;\r\n    address_line1: string;\r\n    address_line2?: string;\r\n    city: string;\r\n    postal_code: string;\r\n    country: string;\r\n    phone?: string;\r\n  };\r\n}\r\n\r\nexport async function createOrder(\r\n  supabase: SupabaseClient,\r\n  params: CreateOrderParams\r\n) {\r\n  const VAT_RATE = 0.20; // 20% UK VAT\r\n\r\n  // Calculate totals\r\n  const subtotal = params.items.reduce(\r\n    (sum, item) => sum + (item.unit_price_gbp * item.fabric_modifier),\r\n    0\r\n  );\r\n  const vatAmount = subtotal * VAT_RATE;\r\n  const totalAmount = subtotal + vatAmount;\r\n\r\n  // Create order\r\n  const { data: order, error: orderError } = await supabase\r\n    .from('orders')\r\n    .insert({\r\n      user_id: params.user_id,\r\n      track_type: params.track_type,\r\n      wedding_event_id: params.wedding_event_id,\r\n      stripe_payment_intent: params.stripe_payment_intent,\r\n      current_state: 'S01_PAID',\r\n      subtotal_amount: subtotal,\r\n      vat_amount: vatAmount,\r\n      total_amount: totalAmount,\r\n      shipping_name: params.shipp\n\n---\n**Branches:**\n- `vk/53f6-api-e03-s01-t01`\n",
    "branches": [
      "vk/53f6-api-e03-s01-t01"
    ]
  },
  {
    "title": "API-E02-S02-T06: POST /api/invites/:token/confirm",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E02-S02-T06\n- **Module:** API - Core API & User Management  \n- **Epic:** Dual-Track Business Logic  \n- **Story:** Wedding Event Management API  \n- **Phase:** 2\n- **Prerequisites:** API-E02-S02-T05\n\n### Description\r\nConfirm that an attendee has completed their measurements. Links the measurement record to the attendee and notifies the organizer.\r\n\r\n### Acceptance Criteria\r\n- [ ] Updates attendee status to 'submitted'\r\n- [ ] Links measurement_id to attendee\r\n- [ ] Records submission timestamp\r\n- [ ] Triggers notification to organizer\r\n- [ ] Returns updated attendee\r\n\r\n### Implementation Details\r\n```typescript\r\n// app/api/invites/[token]/confirm/route.ts\r\nexport async function POST(\r\n  request: NextRequest,\r\n  { params }: { params: { token: string } }\r\n) {\r\n  const supabase = createClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n  );\r\n\r\n  const token = params.token;\r\n\r\n  try {\r\n    const body = await request.json();\r\n    const { measurement_id } = body;\r\n\r\n    if (!measurement_id) {\r\n      return NextResponse.json(\r\n        { error: 'measurement_id is required' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Find attendee\r\n    const { data: attendee } = await supabase\r\n      .from('wedding_attendees')\r\n      .select(`\r\n        id,\r\n        event_id,\r\n        event:wedding_events (\r\n          organizer_id,\r\n          event_name\r\n        )\r\n      `)\r\n      .eq('invite_token', token)\r\n      .single();\r\n\r\n    if (!attendee) {\r\n      return NextResponse.json(\r\n        { error: 'Invalid invite' },\r\n        { status: 404 }\r\n      );\r\n    }\r\n\r\n    // Verify measurement exists\r\n    const { data: measurement } = await supabase\r\n      .from('measurements')\r\n      .select('id')\r\n      .eq('id', measurement_id)\r\n      .single();\r\n\r\n    if (!measurement) {\r\n      return NextResponse.json(\r\n        { error: 'Invalid measurement_id' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Update atten\n\n---\n**Branches:**\n- `vk/d0bd-api-e02-s02-t06`\n",
    "branches": [
      "vk/d0bd-api-e02-s02-t06"
    ]
  },
  {
    "title": "API-E02-S02-T05: GET /api/invites/:token",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E02-S02-T05\n- **Module:** API - Core API & User Management  \n- **Epic:** Dual-Track Business Logic  \n- **Story:** Wedding Event Management API  \n- **Phase:** 2\n- **Prerequisites:** API-E02-S02-T04\n\n### Description\r\nValidate an invite token and return the locked template for the attendee. This is the entry point for Track B attendees.\r\n\r\n### Acceptance Criteria\r\n- [ ] Returns template if token valid\r\n- [ ] Returns event details\r\n- [ ] Updates attendee status to 'viewed'\r\n- [ ] Returns 404 for invalid tokens\r\n- [ ] Works without authentication\r\n\r\n### Implementation Details\r\n```typescript\r\n// app/api/invites/[token]/route.ts\r\nexport async function GET(\r\n  request: NextRequest,\r\n  { params }: { params: { token: string } }\r\n) {\r\n  const supabase = createClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n  );\r\n  \r\n  const token = params.token;\r\n\r\n  // Find attendee by token\r\n  const { data: attendee, error } = await supabase\r\n    .from('wedding_attendees')\r\n    .select(`\r\n      id,\r\n      email,\r\n      full_name,\r\n      status,\r\n      template:wedding_templates (\r\n        id,\r\n        role,\r\n        role_custom_name,\r\n        suit_config:suit_configs (\r\n          *,\r\n          fabric:fabrics (*)\r\n        )\r\n      ),\r\n      event:wedding_events (\r\n        id,\r\n        event_name,\r\n        event_date,\r\n        venue_name,\r\n        measurement_deadline\r\n      )\r\n    `)\r\n    .eq('invite_token', token)\r\n    .single();\r\n\r\n  if (error || !attendee) {\r\n    return NextResponse.json(\r\n      { error: 'Invalid or expired invite' },\r\n      { status: 404 }\r\n    );\r\n  }\r\n\r\n  // Update status to viewed if first time\r\n  if (attendee.status === 'invited') {\r\n    await supabase\r\n      .from('wedding_attendees')\r\n      .update({ \r\n        status: 'viewed',\r\n        first_viewed_at: new Date().toISOString()\r\n      })\r\n      .eq('id', attendee.id);\r\n  }\r\n\r\n  // Don't expose the token in response\r\n  return NextResponse\n\n---\n**Branches:**\n- `vk/887f-api-e02-s02-t05`\n",
    "branches": [
      "vk/887f-api-e02-s02-t05"
    ]
  },
  {
    "title": "API-E02-S02-T04: POST /api/wedding-events/:id/attendees",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E02-S02-T04\n- **Module:** API - Core API & User Management  \n- **Epic:** Dual-Track Business Logic  \n- **Story:** Wedding Event Management API  \n- **Phase:** 2\n- **Prerequisites:** API-E02-S02-T01\n\n### Description\r\nAdd an attendee to a wedding event, assign them to a template, and generate a unique invite token URL.\r\n\r\n### Acceptance Criteria\r\n- [ ] Creates attendee record\r\n- [ ] Generates unique invite_token\r\n- [ ] Links to specified template\r\n- [ ] Only organizer can add\r\n- [ ] Returns attendee with invite URL\r\n\r\n### Implementation Details\r\n```typescript\r\n// app/api/wedding-events/[id]/attendees/route.ts\r\nexport async function POST(\r\n  request: NextRequest,\r\n  { params }: { params: { id: string } }\r\n) {\r\n  const supabase = createRouteHandlerClient({ cookies });\r\n  const eventId = params.id;\r\n\r\n  const { data: { user } } = await supabase.auth.getUser();\r\n  if (!user) {\r\n    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n  }\r\n\r\n  // Verify organizer\r\n  const { data: event } = await supabase\r\n    .from('wedding_events')\r\n    .select('organizer_id')\r\n    .eq('id', eventId)\r\n    .single();\r\n\r\n  if (!event || event.organizer_id !== user.id) {\r\n    return NextResponse.json({ error: 'Access denied' }, { status: 403 });\r\n  }\r\n\r\n  try {\r\n    const body = await request.json();\r\n    const { email, full_name, phone, template_id } = body;\r\n\r\n    if (!email || !template_id) {\r\n      return NextResponse.json(\r\n        { error: 'email and template_id are required' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Verify template belongs to this event\r\n    const { data: template } = await supabase\r\n      .from('wedding_templates')\r\n      .select('id')\r\n      .eq('id', template_id)\r\n      .eq('event_id', eventId)\r\n      .single();\r\n\r\n    if (!template) {\r\n      return NextResponse.json(\r\n        { error: 'Invalid template_id for this event' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Create attendee (invite_token\n\n---\n**Branches:**\n- `vk/9c6c-api-e02-s02-t04`\n",
    "branches": [
      "vk/9c6c-api-e02-s02-t04"
    ]
  },
  {
    "title": "API-E02-S02-T03: POST /api/wedding-events/:id/templates",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E02-S02-T03\n- **Module:** API - Core API & User Management  \n- **Epic:** Dual-Track Business Logic  \n- **Story:** Wedding Event Management API  \n- **Phase:** 2\n- **Prerequisites:** API-E02-S02-T01\n\n### Description\r\nCreate a suit template for a wedding party role (e.g., Groom, Best Man, Groomsman). Links to a suit configuration and marks it as a template.\r\n\r\n### Acceptance Criteria\r\n- [ ] Creates template linked to event\r\n- [ ] Creates or links suit configuration\r\n- [ ] Marks config as is_template=true\r\n- [ ] Only organizer can create\r\n- [ ] Validates role value\r\n\r\n### Implementation Details\r\n```typescript\r\n// app/api/wedding-events/[id]/templates/route.ts\r\nexport async function POST(\r\n  request: NextRequest,\r\n  { params }: { params: { id: string } }\r\n) {\r\n  const supabase = createRouteHandlerClient({ cookies });\r\n  const eventId = params.id;\r\n\r\n  const { data: { user } } = await supabase.auth.getUser();\r\n  if (!user) {\r\n    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n  }\r\n\r\n  // Verify organizer\r\n  const { data: event } = await supabase\r\n    .from('wedding_events')\r\n    .select('organizer_id, status')\r\n    .eq('id', eventId)\r\n    .single();\r\n\r\n  if (!event || event.organizer_id !== user.id) {\r\n    return NextResponse.json({ error: 'Access denied' }, { status: 403 });\r\n  }\r\n\r\n  if (event.status !== 'draft') {\r\n    return NextResponse.json(\r\n      { error: 'Cannot add templates after event is locked' },\r\n      { status: 400 }\r\n    );\r\n  }\r\n\r\n  try {\r\n    const body = await request.json();\r\n    const { role, role_custom_name, suit_config } = body;\r\n\r\n    // Validate role\r\n    const validRoles = ['groom', 'best_man', 'groomsman', 'father_of_bride', \r\n                        'father_of_groom', 'usher', 'ring_bearer', 'other'];\r\n    if (!validRoles.includes(role)) {\r\n      return NextResponse.json({ error: 'Invalid role' }, { status: 400 });\r\n    }\r\n\r\n    // Get or create session for organizer\r\n    let { data: sess\n\n---\n**Branches:**\n- `vk/c2a1-api-e02-s02-t03`\n",
    "branches": [
      "vk/c2a1-api-e02-s02-t03"
    ]
  },
  {
    "title": "API-E02-S02-T02: GET /api/wedding-events/:id",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E02-S02-T02\n- **Module:** API - Core API & User Management  \n- **Epic:** Dual-Track Business Logic  \n- **Story:** Wedding Event Management API  \n- **Phase:** 2\n- **Prerequisites:** API-E02-S02-T01\n\n### Description\r\nRetrieve a wedding event with all templates and attendees. Only accessible by the organizer.\r\n\r\n### Acceptance Criteria\r\n- [ ] Returns event with nested templates\r\n- [ ] Returns event with nested attendees\r\n- [ ] Only organizer can access\r\n- [ ] Returns 404 if not found\r\n- [ ] Returns 403 if not organizer\r\n\r\n### Implementation Details\r\n```typescript\r\n// app/api/wedding-events/[id]/route.ts\r\nexport async function GET(\r\n  request: NextRequest,\r\n  { params }: { params: { id: string } }\r\n) {\r\n  const supabase = createRouteHandlerClient({ cookies });\r\n  const eventId = params.id;\r\n\r\n  // Check authentication\r\n  const { data: { user } } = await supabase.auth.getUser();\r\n  if (!user) {\r\n    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n  }\r\n\r\n  // Fetch event with relations\r\n  const { data: event, error } = await supabase\r\n    .from('wedding_events')\r\n    .select(`\r\n      *,\r\n      templates:wedding_templates (\r\n        *,\r\n        suit_config:suit_configs (\r\n          *,\r\n          fabric:fabrics (*)\r\n        )\r\n      ),\r\n      attendees:wedding_attendees (\r\n        *,\r\n        template:wedding_templates (role, role_custom_name),\r\n        measurement:measurements (id, created_at)\r\n      )\r\n    `)\r\n    .eq('id', eventId)\r\n    .single();\r\n\r\n  if (error || !event) {\r\n    return NextResponse.json({ error: 'Event not found' }, { status: 404 });\r\n  }\r\n\r\n  // Check organizer permission\r\n  if (event.organizer_id !== user.id) {\r\n    return NextResponse.json({ error: 'Access denied' }, { status: 403 });\r\n  }\r\n\r\n  // Add summary stats\r\n  const summary = {\r\n    total_attendees: event.attendees?.length || 0,\r\n    measurements_received: event.attendees?.filter(\r\n      (a: any) => a.status === 'submitted' || a.status ===\n\n---\n**Branches:**\n- `vk/2629-api-e02-s02-t02`\n",
    "branches": [
      "vk/2629-api-e02-s02-t02"
    ]
  },
  {
    "title": "API-E02-S02-T01: POST /api/wedding-events",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E02-S02-T01\n- **Module:** API - Core API & User Management  \n- **Epic:** Dual-Track Business Logic  \n- **Story:** Wedding Event Management API  \n- **Phase:** 2\n- **Prerequisites:** DB-E02-S01 complete\n\n### Description\r\nCreate a new wedding event for Track B. Requires authenticated user. Validates event date is at least 4 weeks in future.\r\n\r\n### Acceptance Criteria\r\n- [ ] Creates wedding event in database\r\n- [ ] Requires authentication\r\n- [ ] Validates date >= NOW() + 4 weeks\r\n- [ ] Sets organizer_id to current user\r\n- [ ] Returns created event\r\n\r\n### Implementation Details\r\n```typescript\r\n// app/api/wedding-events/route.ts\r\nimport { createRouteHandlerClient } from '@supabase/auth-helpers-nextjs';\r\nimport { cookies } from 'next/headers';\r\nimport { NextRequest, NextResponse } from 'next/server';\r\n\r\ninterface CreateEventRequest {\r\n  event_name: string;\r\n  event_date: string; // ISO date\r\n  venue_name?: string;\r\n  venue_location?: string;\r\n  measurement_deadline?: string;\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n  const supabase = createRouteHandlerClient({ cookies });\r\n\r\n  // Check authentication\r\n  const { data: { user }, error: authError } = await supabase.auth.getUser();\r\n  if (authError || !user) {\r\n    return NextResponse.json(\r\n      { error: 'Authentication required' },\r\n      { status: 401 }\r\n    );\r\n  }\r\n\r\n  try {\r\n    const body: CreateEventRequest = await request.json();\r\n\r\n    // Validate required fields\r\n    if (!body.event_name || !body.event_date) {\r\n      return NextResponse.json(\r\n        { error: 'event_name and event_date are required' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Validate date is at least 4 weeks in future\r\n    const eventDate = new Date(body.event_date);\r\n    const minDate = new Date();\r\n    minDate.setDate(minDate.getDate() + 28);\r\n\r\n    if (eventDate < minDate) {\r\n      return NextResponse.json(\r\n        { error: 'Event date must be at least 4 weeks in the future' },\r\n     \n\n---\n**Branches:**\n- `vk/c6a7-api-e02-s02-t01`\n",
    "branches": [
      "vk/c6a7-api-e02-s02-t01"
    ]
  },
  {
    "title": "API-E02-S01-T05: GET /api/configs/:id/preview",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E02-S01-T05\n- **Module:** API - Core API & User Management  \n- **Epic:** Dual-Track Business Logic  \n- **Story:** Suit Configuration API  \n- **Phase:** 2\n- **Prerequisites:** API-E02-S01-T01\n\n### Description\r\nReturn all data needed for 3D preview rendering including texture URLs, mesh references, and style parameters for the configurator.\r\n\r\n### Acceptance Criteria\r\n- [ ] Returns complete preview data object\r\n- [ ] Includes all texture map URLs (diffuse, normal, roughness)\r\n- [ ] Includes mesh variant identifiers\r\n- [ ] Includes lighting preset reference\r\n- [ ] Optimized for fast 3D loading\r\n\r\n### Implementation Details\r\n```typescript\r\n// app/api/configs/[id]/preview/route.ts\r\nexport async function GET(\r\n  request: NextRequest,\r\n  { params }: { params: { id: string } }\r\n) {\r\n  const supabase = createRouteHandlerClient({ cookies });\r\n  const configId = params.id;\r\n\r\n  const { data: config, error } = await supabase\r\n    .from('suit_configs')\r\n    .select(`\r\n      id,\r\n      style_json,\r\n      fabric:fabrics (\r\n        code,\r\n        texture_url,\r\n        color_hex,\r\n        properties\r\n      )\r\n    `)\r\n    .eq('id', configId)\r\n    .single();\r\n\r\n  if (error || !config) {\r\n    return NextResponse.json(\r\n      { error: 'Configuration not found' },\r\n      { status: 404 }\r\n    );\r\n  }\r\n\r\n  // Build preview data\r\n  const previewData = {\r\n    configId: config.id,\r\n    \r\n    // Texture maps (constructed from base URL)\r\n    textures: {\r\n      baseUrl: config.fabric?.texture_url,\r\n      diffuse: `${config.fabric?.texture_url}/diffuse.jpg`,\r\n      normal: `${config.fabric?.texture_url}/normal.jpg`,\r\n      roughness: `${config.fabric?.texture_url}/roughness.jpg`,\r\n      ao: `${config.fabric?.texture_url}/ao.jpg`,\r\n    },\r\n    \r\n    // Mesh variants based on style\r\n    meshes: {\r\n      jacket: getMeshVariant('jacket', config.style_json?.jacket),\r\n      trousers: getMeshVariant('trousers', config.style_json?.trousers),\r\n      vest: config.style_json?.\n\n---\n**Branches:**\n- `vk/10f9-api-e02-s01-t05`\n",
    "branches": [
      "vk/10f9-api-e02-s01-t05"
    ]
  },
  {
    "title": "API-E02-S01-T04: DELETE /api/configs/:id",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E02-S01-T04\n- **Module:** API - Core API & User Management  \n- **Epic:** Dual-Track Business Logic  \n- **Story:** Suit Configuration API  \n- **Phase:** 2\n- **Prerequisites:** API-E02-S01-T01\n\n### Description\r\nDelete a suit configuration. Prevents deletion of locked templates and configs that are part of orders.\r\n\r\n### Acceptance Criteria\r\n- [ ] Deletes config from database\r\n- [ ] Returns 204 No Content on success\r\n- [ ] Rejects deletion of locked templates\r\n- [ ] Rejects deletion if linked to orders\r\n- [ ] Returns 404 if not found\r\n\r\n### Implementation Details\r\n```typescript\r\n// app/api/configs/[id]/route.ts (add to existing)\r\nexport async function DELETE(\r\n  request: NextRequest,\r\n  { params }: { params: { id: string } }\r\n) {\r\n  const supabase = createRouteHandlerClient({ cookies });\r\n  const configId = params.id;\r\n\r\n  // Check if config exists\r\n  const { data: config } = await supabase\r\n    .from('suit_configs')\r\n    .select('is_template, template_locked_at')\r\n    .eq('id', configId)\r\n    .single();\r\n\r\n  if (!config) {\r\n    return NextResponse.json(\r\n      { error: 'Configuration not found' },\r\n      { status: 404 }\r\n    );\r\n  }\r\n\r\n  // Check if locked template\r\n  if (config.is_template && config.template_locked_at) {\r\n    return NextResponse.json(\r\n      { error: 'Cannot delete locked template' },\r\n      { status: 403 }\r\n    );\r\n  }\r\n\r\n  // Check if linked to any orders\r\n  const { data: orderItems } = await supabase\r\n    .from('order_items')\r\n    .select('id')\r\n    .eq('suit_config_id', configId)\r\n    .limit(1);\r\n\r\n  if (orderItems && orderItems.length > 0) {\r\n    return NextResponse.json(\r\n      { error: 'Cannot delete configuration linked to orders' },\r\n      { status: 403 }\r\n    );\r\n  }\r\n\r\n  // Delete\r\n  const { error } = await supabase\r\n    .from('suit_configs')\r\n    .delete()\r\n    .eq('id', configId);\r\n\r\n  if (error) {\r\n    return NextResponse.json(\r\n      { error: 'Failed to delete configuration' },\r\n      { status: 500 }\r\n   \n\n---\n**Branches:**\n- `vk/db6d-api-e02-s01-t04`\n",
    "branches": [
      "vk/db6d-api-e02-s01-t04"
    ]
  },
  {
    "title": "API-E02-S01-T03: PUT /api/configs/:id",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E02-S01-T03\n- **Module:** API - Core API & User Management  \n- **Epic:** Dual-Track Business Logic  \n- **Story:** Suit Configuration API  \n- **Phase:** 2\n- **Prerequisites:** API-E02-S01-T01\n\n### Description\r\nUpdate an existing suit configuration. Prevents updates to locked templates (is_template=true and template_locked_at is set).\r\n\r\n### Acceptance Criteria\r\n- [ ] Updates config fields\r\n- [ ] Recalculates price if fabric changes\r\n- [ ] Rejects updates to locked templates\r\n- [ ] Returns updated config\r\n- [ ] Validates fabric exists and in stock\r\n\r\n### Implementation Details\r\n```typescript\r\n// app/api/configs/[id]/route.ts (add to existing)\r\nexport async function PUT(\r\n  request: NextRequest,\r\n  { params }: { params: { id: string } }\r\n) {\r\n  const supabase = createRouteHandlerClient({ cookies });\r\n  const configId = params.id;\r\n\r\n  try {\r\n    const body = await request.json();\r\n\r\n    // Check if config exists and is not locked\r\n    const { data: existingConfig } = await supabase\r\n      .from('suit_configs')\r\n      .select('is_template, template_locked_at')\r\n      .eq('id', configId)\r\n      .single();\r\n\r\n    if (!existingConfig) {\r\n      return NextResponse.json(\r\n        { error: 'Configuration not found' },\r\n        { status: 404 }\r\n      );\r\n    }\r\n\r\n    // Check if template is locked\r\n    if (existingConfig.is_template && existingConfig.template_locked_at) {\r\n      return NextResponse.json(\r\n        { error: 'Cannot modify locked template' },\r\n        { status: 403 }\r\n      );\r\n    }\r\n\r\n    // Build update object\r\n    const updateData: Record<string, any> = {\r\n      updated_at: new Date().toISOString()\r\n    };\r\n\r\n    if (body.fabric_id) {\r\n      // Validate new fabric\r\n      const { data: fabric } = await supabase\r\n        .from('fabrics')\r\n        .select('id, price_modifier, in_stock')\r\n        .eq('id', body.fabric_id)\r\n        .single();\r\n\r\n      if (!fabric || !fabric.in_stock) {\r\n        return NextResponse.json(\r\n          { \n\n---\n**Branches:**\n- `vk/1c33-api-e02-s01-t03`\n",
    "branches": [
      "vk/1c33-api-e02-s01-t03"
    ]
  },
  {
    "title": "API-E02-S01-T02: GET /api/configs/:id",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E02-S01-T02\n- **Module:** API - Core API & User Management  \n- **Epic:** Dual-Track Business Logic  \n- **Story:** Suit Configuration API  \n- **Phase:** 2\n- **Prerequisites:** API-E02-S01-T01\n\n### Description\r\nRetrieve a suit configuration by ID including full fabric details and texture URLs for 3D rendering.\r\n\r\n### Acceptance Criteria\r\n- [ ] Returns config with nested fabric data\r\n- [ ] Includes texture URLs for 3D preview\r\n- [ ] Returns 404 for non-existent configs\r\n- [ ] Validates access permissions\r\n\r\n### Implementation Details\r\n```typescript\r\n// app/api/configs/[id]/route.ts\r\nexport async function GET(\r\n  request: NextRequest,\r\n  { params }: { params: { id: string } }\r\n) {\r\n  const supabase = createRouteHandlerClient({ cookies });\r\n  const configId = params.id;\r\n\r\n  const { data: config, error } = await supabase\r\n    .from('suit_configs')\r\n    .select(`\r\n      *,\r\n      fabric:fabrics (*),\r\n      session:sessions (\r\n        id,\r\n        user_id\r\n      )\r\n    `)\r\n    .eq('id', configId)\r\n    .single();\r\n\r\n  if (error || !config) {\r\n    return NextResponse.json(\r\n      { error: 'Configuration not found' },\r\n      { status: 404 }\r\n    );\r\n  }\r\n\r\n  return NextResponse.json(config);\r\n}\r\n```\r\n\r\n### Definition of Done\r\nReturns full config with fabric details and texture URLs\n\n---\n**Branches:**\n- `vk/986b-api-e02-s01-t02`\n",
    "branches": [
      "vk/986b-api-e02-s01-t02"
    ]
  },
  {
    "title": "API-E02-S01-T01: POST /api/configs",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E02-S01-T01\n- **Module:** API - Core API & User Management  \n- **Epic:** Dual-Track Business Logic  \n- **Story:** Suit Configuration API  \n- **Phase:** 2\n- **Prerequisites:** DB-E01-S02 complete\n\n### Description\r\nCreate a new suit configuration with fabric selection and style options. Validates fabric availability and calculates price.\r\n\r\n### Acceptance Criteria\r\n- [ ] POST /api/configs creates new configuration\r\n- [ ] Requires valid session_id\r\n- [ ] Requires valid fabric_id\r\n- [ ] Validates fabric is in stock\r\n- [ ] Calculates total price\r\n- [ ] Returns created config with fabric details\r\n\r\n### Implementation Details\r\n```typescript\r\n// app/api/configs/route.ts\r\nimport { createRouteHandlerClient } from '@supabase/auth-helpers-nextjs';\r\nimport { cookies } from 'next/headers';\r\nimport { NextRequest, NextResponse } from 'next/server';\r\n\r\nconst BASE_SUIT_PRICE_GBP = 599;\r\n\r\ninterface CreateConfigRequest {\r\n  session_id: string;\r\n  fabric_id: string;\r\n  style_json?: {\r\n    jacket?: {\r\n      lapel?: 'notch' | 'peak' | 'shawl';\r\n      buttons?: 1 | 2 | 3;\r\n      vents?: 'none' | 'single' | 'double';\r\n      pocket_style?: 'flap' | 'jetted' | 'patch';\r\n      lining_color?: string;\r\n    };\r\n    trousers?: {\r\n      fit?: 'slim' | 'regular' | 'relaxed';\r\n      pleats?: 'flat' | 'single' | 'double';\r\n      cuff?: boolean;\r\n    };\r\n    vest?: {\r\n      included?: boolean;\r\n      buttons?: number;\r\n    };\r\n  };\r\n  name?: string;\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n  const supabase = createRouteHandlerClient({ cookies });\r\n  \r\n  try {\r\n    const body: CreateConfigRequest = await request.json();\r\n    \r\n    // Validate required fields\r\n    if (!body.session_id || !body.fabric_id) {\r\n      return NextResponse.json(\r\n        { error: 'session_id and fabric_id are required' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Verify session exists\r\n    const { data: session } = await supabase\r\n      .from('sessions')\r\n      .select(\n\n---\n**Branches:**\n- `vk/5065-api-e02-s01-t01`\n",
    "branches": [
      "vk/5065-api-e02-s01-t01"
    ]
  },
  {
    "title": "API-E01-S02-T03: Implement Session Merge",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E01-S02-T03\n- **Module:** API - Core API & User Management  \n- **Epic:** Authentication & Session Management  \n- **Story:** Authentication Endpoints  \n- **Phase:** 2\n- **Prerequisites:** API-E01-S02-T02, API-E01-S01-T04\n\n### Description\r\nWhen a user logs in, merge their anonymous session data (measurements, configs) into their account. Handle conflicts if user already has existing data.\r\n\r\n### Acceptance Criteria\r\n- [ ] Anonymous session data transfers to user\r\n- [ ] Measurements are linked to user's new session\r\n- [ ] Suit configs are preserved\r\n- [ ] Handles duplicate/conflict scenarios\r\n- [ ] Original anonymous session marked as claimed\r\n- [ ] Audit trail maintained\r\n\r\n### Implementation Details\r\n```typescript\r\n// lib/session-merge.ts\r\nimport { SupabaseClient } from '@supabase/supabase-js';\r\n\r\ninterface MergeResult {\r\n  success: boolean;\r\n  merged: {\r\n    measurements: number;\r\n    configs: number;\r\n  };\r\n  errors: string[];\r\n}\r\n\r\nexport async function mergeAnonymousSession(\r\n  supabase: SupabaseClient,\r\n  anonymousSessionId: string,\r\n  userId: string\r\n): Promise<MergeResult> {\r\n  const result: MergeResult = {\r\n    success: true,\r\n    merged: { measurements: 0, configs: 0 },\r\n    errors: []\r\n  };\r\n\r\n  try {\r\n    // Start transaction-like operations\r\n    \r\n    // 1. Get or create user's primary session\r\n    let { data: userSession } = await supabase\r\n      .from('sessions')\r\n      .select('id')\r\n      .eq('user_id', userId)\r\n      .order('created_at', { ascending: false })\r\n      .limit(1)\r\n      .single();\r\n\r\n    if (!userSession) {\r\n      // Create new session for user\r\n      const { data: newSession, error } = await supabase\r\n        .from('sessions')\r\n        .insert({ user_id: userId })\r\n        .select()\r\n        .single();\r\n      \r\n      if (error) throw error;\r\n      userSession = newSession;\r\n    }\r\n\r\n    // 2. Transfer measurements\r\n    const { data: measurements, error: measError } = await supabase\r\n      .from('measuremen\n\n---\n**Branches:**\n- `vk/cad2-api-e01-s02-t03`\n",
    "branches": [
      "vk/cad2-api-e01-s02-t03"
    ]
  },
  {
    "title": "API-E01-S02-T02: POST /api/auth/callback",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E01-S02-T02\n- **Module:** API - Core API & User Management  \n- **Epic:** Authentication & Session Management  \n- **Story:** Authentication Endpoints  \n- **Phase:** 2\n- **Prerequisites:** API-E01-S02-T01\n\n### Description\r\nHandle the authentication callback from Supabase after magic link click or OAuth redirect. Exchange the code for a session and set cookies.\r\n\r\n### Acceptance Criteria\r\n- [ ] Handles magic link code exchange\r\n- [ ] Handles OAuth code exchange\r\n- [ ] Sets secure session cookies\r\n- [ ] Creates user record if new user\r\n- [ ] Redirects to appropriate page\r\n- [ ] Handles errors gracefully\r\n\r\n### Implementation Details\r\n```typescript\r\n// app/auth/callback/route.ts\r\nimport { createRouteHandlerClient } from '@supabase/auth-helpers-nextjs';\r\nimport { cookies } from 'next/headers';\r\nimport { NextRequest, NextResponse } from 'next/server';\r\n\r\nexport async function GET(request: NextRequest) {\r\n  const requestUrl = new URL(request.url);\r\n  const code = requestUrl.searchParams.get('code');\r\n  const error = requestUrl.searchParams.get('error');\r\n  const error_description = requestUrl.searchParams.get('error_description');\r\n\r\n  // Handle OAuth/magic link errors\r\n  if (error) {\r\n    console.error('Auth error:', error, error_description);\r\n    return NextResponse.redirect(\r\n      new URL(`/login?error=${encodeURIComponent(error_description || error)}`, requestUrl.origin)\r\n    );\r\n  }\r\n\r\n  if (code) {\r\n    const supabase = createRouteHandlerClient({ cookies });\r\n    \r\n    try {\r\n      // Exchange code for session\r\n      const { data, error: exchangeError } = await supabase.auth.exchangeCodeForSession(code);\r\n      \r\n      if (exchangeError) {\r\n        console.error('Code exchange error:', exchangeError);\r\n        return NextResponse.redirect(\r\n          new URL('/login?error=auth_failed', requestUrl.origin)\r\n        );\r\n      }\r\n\r\n      // Check if user record exists, create if not\r\n      if (data.user) {\r\n        const { data: existingUs\n\n---\n**Branches:**\n- `vk/5cf1-api-e01-s02-t02`\n",
    "branches": [
      "vk/5cf1-api-e01-s02-t02"
    ]
  },
  {
    "title": "API-E01-S02-T01: Configure Supabase Auth",
    "status": "done",
    "labels": [
      "done",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E01-S02-T01\n- **Module:** API - Core API & User Management  \n- **Epic:** Authentication & Session Management  \n- **Story:** Authentication Endpoints  \n- **Phase:** 2\n- **Prerequisites:** DB-E01-S01 complete\n\n### Description\r\nConfigure Supabase Authentication with magic link (passwordless) and OAuth providers (Google, Apple) for user signup and login.\r\n\r\n### Acceptance Criteria\r\n- [ ] Magic link authentication enabled\r\n- [ ] Google OAuth configured\r\n- [ ] Apple OAuth configured\r\n- [ ] Email templates customized\r\n- [ ] Redirect URLs configured\r\n- [ ] JWT expiry set appropriately\r\n\r\n### Implementation Details\r\n```sql\r\n-- Supabase Dashboard Configuration (Settings > Authentication)\r\n\r\n-- 1. Enable Email provider with magic links\r\n-- Site URL: https://suitai.com\r\n-- Redirect URLs: \r\n--   https://suitai.com/auth/callback\r\n--   http://localhost:3000/auth/callback\r\n\r\n-- 2. Email Templates (Authentication > Email Templates)\r\n-- Magic Link template:\r\n```\r\n\r\n```html\r\n<!-- Magic Link Email Template -->\r\n<h2>Welcome to SUIT AI</h2>\r\n<p>Click the link below to sign in to your account:</p>\r\n<p><a href=\"{{ .ConfirmationURL }}\">Sign In to SUIT AI</a></p>\r\n<p>This link will expire in 24 hours.</p>\r\n<p>If you didn't request this, you can safely ignore this email.</p>\r\n```\r\n\r\n```typescript\r\n// lib/supabase/auth-config.ts\r\nexport const authConfig = {\r\n  providers: {\r\n    email: {\r\n      enabled: true,\r\n      passwordless: true, // Magic link only\r\n    },\r\n    google: {\r\n      enabled: true,\r\n      clientId: process.env.GOOGLE_CLIENT_ID,\r\n      clientSecret: process.env.GOOGLE_CLIENT_SECRET,\r\n    },\r\n    apple: {\r\n      enabled: true,\r\n      clientId: process.env.APPLE_CLIENT_ID,\r\n      secret: process.env.APPLE_SECRET,\r\n    }\r\n  },\r\n  redirectTo: `${process.env.NEXT_PUBLIC_SITE_URL}/auth/callback`,\r\n  jwt: {\r\n    expiresIn: 3600, // 1 hour\r\n    refreshExpiresIn: 604800, // 7 days\r\n  }\r\n};\r\n\r\n// Frontend auth helper\r\n// lib/supabase/client.ts\r\nimport { crea\n\n---\n**Branches:**\n- `vk/3003-api-e01-s02-t01`\n",
    "branches": [
      "vk/3003-api-e01-s02-t01"
    ]
  },
  {
    "title": "API-E01-S01-T04: POST /api/sessions/:id/claim",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E01-S01-T04\n- **Module:** API - Core API & User Management  \n- **Epic:** Authentication & Session Management  \n- **Story:** Anonymous Session Endpoints  \n- **Phase:** 2\n- **Prerequisites:** API-E01-S01-T01\n\n### Description\r\nLink an anonymous session to an authenticated user. This is called after login/signup to transfer all session data (measurements, configs) to the user's account.\r\n\r\n### Acceptance Criteria\r\n- [ ] POST /api/sessions/:id/claim links session to user\r\n- [ ] Requires authenticated user (JWT)\r\n- [ ] Updates session.user_id\r\n- [ ] Returns 400 if session already claimed\r\n- [ ] Returns 401 if not authenticated\r\n- [ ] Returns 404 if session not found\r\n\r\n### Implementation Details\r\n```typescript\r\n// app/api/sessions/[id]/claim/route.ts\r\nimport { createRouteHandlerClient } from '@supabase/auth-helpers-nextjs';\r\nimport { cookies } from 'next/headers';\r\nimport { NextRequest, NextResponse } from 'next/server';\r\n\r\nexport async function POST(\r\n  request: NextRequest,\r\n  { params }: { params: { id: string } }\r\n) {\r\n  const sessionId = params.id;\r\n  const supabase = createRouteHandlerClient({ cookies });\r\n\r\n  // Get authenticated user\r\n  const { data: { user }, error: authError } = await supabase.auth.getUser();\r\n  \r\n  if (authError || !user) {\r\n    return NextResponse.json(\r\n      { error: 'Authentication required' },\r\n      { status: 401 }\r\n    );\r\n  }\r\n\r\n  // Check if session exists and is unclaimed\r\n  const { data: existingSession } = await supabase\r\n    .from('sessions')\r\n    .select('user_id')\r\n    .eq('id', sessionId)\r\n    .single();\r\n\r\n  if (!existingSession) {\r\n    return NextResponse.json(\r\n      { error: 'Session not found' },\r\n      { status: 404 }\r\n    );\r\n  }\r\n\r\n  if (existingSession.user_id) {\r\n    return NextResponse.json(\r\n      { error: 'Session already claimed' },\r\n      { status: 400 }\r\n    );\r\n  }\r\n\r\n  // Claim the session\r\n  const { data: session, error } = await supabase\r\n    .from('sessions')\r\n    .update({ \r\n \n\n---\n**Branches:**\n- `vk/84a5-api-e01-s01-t04`\n",
    "branches": [
      "vk/84a5-api-e01-s01-t04"
    ]
  },
  {
    "title": "API-E01-S01-T03: PUT /api/sessions/:id",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E01-S01-T03\n- **Module:** API - Core API & User Management  \n- **Epic:** Authentication & Session Management  \n- **Story:** Anonymous Session Endpoints  \n- **Phase:** 2\n- **Prerequisites:** API-E01-S01-T01\n\n### Description\r\nUpdate session data including device fingerprint and extend expiration. Used to keep sessions alive and track device changes.\r\n\r\n### Acceptance Criteria\r\n- [ ] PUT /api/sessions/:id updates session\r\n- [ ] Can update device_fingerprint\r\n- [ ] Can extend expires_at\r\n- [ ] Returns updated session object\r\n- [ ] Returns 404 for non-existent sessions\r\n- [ ] Validates input data\r\n\r\n### Implementation Details\r\n```typescript\r\n// app/api/sessions/[id]/route.ts (add to existing file)\r\nexport async function PUT(\r\n  request: NextRequest,\r\n  { params }: { params: { id: string } }\r\n) {\r\n  const sessionId = params.id;\r\n  \r\n  try {\r\n    const body = await request.json();\r\n    \r\n    // Allowed update fields\r\n    const allowedFields = ['device_fingerprint', 'extends_expiry'];\r\n    const updateData: Record<string, any> = {\r\n      updated_at: new Date().toISOString(),\r\n      last_active_at: new Date().toISOString()\r\n    };\r\n\r\n    if (body.device_fingerprint) {\r\n      updateData.device_fingerprint = body.device_fingerprint;\r\n    }\r\n\r\n    if (body.extend_expiry) {\r\n      // Extend by 30 days from now\r\n      updateData.expires_at = new Date(\r\n        Date.now() + 30 * 24 * 60 * 60 * 1000\r\n      ).toISOString();\r\n    }\r\n\r\n    const { data: session, error } = await supabase\r\n      .from('sessions')\r\n      .update(updateData)\r\n      .eq('id', sessionId)\r\n      .select()\r\n      .single();\r\n\r\n    if (error || !session) {\r\n      return NextResponse.json(\r\n        { error: 'Session not found' },\r\n        { status: 404 }\r\n      );\r\n    }\r\n\r\n    return NextResponse.json(session);\r\n  } catch (error) {\r\n    return NextResponse.json(\r\n      { error: 'Invalid request body' },\r\n      { status: 400 }\r\n    );\r\n  }\r\n}\r\n```\r\n\r\n### Request Schema\r\n```json\r\n{\n\n---\n**Branches:**\n- `vk/100f-api-e01-s01-t03`\n",
    "branches": [
      "vk/100f-api-e01-s01-t03"
    ]
  },
  {
    "title": "API-E01-S01-T02: GET /api/sessions/:id",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E01-S01-T02\n- **Module:** API - Core API & User Management  \n- **Epic:** Authentication & Session Management  \n- **Story:** Anonymous Session Endpoints  \n- **Phase:** 2\n- **Prerequisites:** API-E01-S01-T01\n\n### Description\r\nRetrieve session data including any associated measurements and suit configurations. This endpoint is used to restore user progress when they return to the site.\r\n\r\n### Acceptance Criteria\r\n- [ ] GET /api/sessions/:id returns session object\r\n- [ ] Includes nested measurements if present\r\n- [ ] Includes nested suit_configs if present\r\n- [ ] Returns 404 for non-existent sessions\r\n- [ ] Returns 410 Gone for expired sessions\r\n- [ ] Updates last_active_at timestamp\r\n\r\n### Implementation Details\r\n```typescript\r\n// app/api/sessions/[id]/route.ts\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { NextRequest, NextResponse } from 'next/server';\r\n\r\nconst supabase = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n);\r\n\r\nexport async function GET(\r\n  request: NextRequest,\r\n  { params }: { params: { id: string } }\r\n) {\r\n  const sessionId = params.id;\r\n\r\n  // Validate UUID format\r\n  const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;\r\n  if (!uuidRegex.test(sessionId)) {\r\n    return NextResponse.json(\r\n      { error: 'Invalid session ID format' },\r\n      { status: 400 }\r\n    );\r\n  }\r\n\r\n  // Fetch session with related data\r\n  const { data: session, error } = await supabase\r\n    .from('sessions')\r\n    .select(`\r\n      *,\r\n      measurements (*),\r\n      suit_configs (\r\n        *,\r\n        fabric:fabrics (*)\r\n      )\r\n    `)\r\n    .eq('id', sessionId)\r\n    .single();\r\n\r\n  if (error || !session) {\r\n    return NextResponse.json(\r\n      { error: 'Session not found' },\r\n      { status: 404 }\r\n    );\r\n  }\r\n\r\n  // Check if expired\r\n  if (new Date(session.expires_at) < new Date()) {\r\n    return NextResponse.json(\r\n      { error: 'Session expired' \n\n---\n**Branches:**\n- `vk/f7c2-api-e01-s01-t02`\n",
    "branches": [
      "vk/f7c2-api-e01-s01-t02"
    ]
  },
  {
    "title": "API-E01-S01-T01: POST /api/sessions",
    "status": "inreview",
    "labels": [
      "in-review",
      "api"
    ],
    "body": "## Metadata\n- **Task ID:** API-E01-S01-T01\n- **Module:** API - Core API & User Management  \n- **Epic:** Authentication & Session Management  \n- **Story:** Anonymous Session Endpoints  \n- **Phase:** 2\n- **Prerequisites:** DB-E01-S01 complete\n\n### Description\r\nCreate an API endpoint that generates a new anonymous session. This allows users to start configuring suits and taking measurements without requiring signup. The session can later be claimed when they create an account.\r\n\r\n### Acceptance Criteria\r\n- [ ] POST /api/sessions returns 201 with session object\r\n- [ ] Response includes session UUID\r\n- [ ] Session is stored in database\r\n- [ ] Session has 30-day expiration by default\r\n- [ ] Rate limiting prevents abuse (max 10/minute per IP)\r\n- [ ] Returns proper error codes for failures\r\n\r\n### Implementation Details\r\n```typescript\r\n// app/api/sessions/route.ts\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { NextRequest, NextResponse } from 'next/server';\r\nimport { headers } from 'next/headers';\r\n\r\nconst supabase = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n);\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    // Get client info for tracking\r\n    const headersList = headers();\r\n    const userAgent = headersList.get('user-agent') || '';\r\n    const forwardedFor = headersList.get('x-forwarded-for');\r\n    const ip = forwardedFor?.split(',')[0] || 'unknown';\r\n\r\n    // Create session\r\n    const { data: session, error } = await supabase\r\n      .from('sessions')\r\n      .insert({\r\n        user_agent: userAgent,\r\n        ip_address: ip,\r\n        expires_at: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString()\r\n      })\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      console.error('Session creation error:', error);\r\n      return NextResponse.json(\r\n        { error: 'Failed to create session' },\r\n        { status: 500 }\r\n      );\r\n    }\r\n\r\n    return NextResponse.json(\r\n  \n\n---\n**Branches:**\n- `vk/b4da-api-e01-s01-t01`\n",
    "branches": [
      "vk/b4da-api-e01-s01-t01"
    ]
  },
  {
    "title": "DB-E03-S01-T05: Create State Transition Function",
    "status": "inreview",
    "labels": [
      "in-review",
      "db"
    ],
    "body": "## Metadata\n- **Task ID:** DB-E03-S01-T05\n- **Module:** DB - Database & Backend Services  \n- **Epic:** Order & Fulfillment Schema  \n- **Story:** Order Tables  \n- **Phase:** 1\n- **Prerequisites:** DB-E03-S01-T01\n\n### Description\r\nCreate a PostgreSQL function that validates legal state transitions according to the order state machine rules.\r\n\r\n### Acceptance Criteria\r\n- [ ] Function validates transition is legal\r\n- [ ] Returns error for invalid transitions\r\n- [ ] Allows all valid forward transitions\r\n- [ ] Handles error state transitions\r\n- [ ] Documents the state machine\r\n\r\n### Implementation Details\r\n```sql\r\n-- Create function to validate state transitions\r\nCREATE OR REPLACE FUNCTION validate_order_state_transition(\r\n    current_state order_state,\r\n    new_state order_state\r\n) RETURNS BOOLEAN AS $$\r\nDECLARE\r\n    valid_transitions JSONB := '{\r\n        \"S01_PAID\": [\"S02_MEASUREMENT_PENDING\"],\r\n        \"S02_MEASUREMENT_PENDING\": [\"S03_MEASUREMENT_RECEIVED\"],\r\n        \"S03_MEASUREMENT_RECEIVED\": [\"S04_PATTERN_PENDING\"],\r\n        \"S04_PATTERN_PENDING\": [\"S05_PATTERN_GENERATED\"],\r\n        \"S05_PATTERN_GENERATED\": [\"S06_SENT_TO_PRINTER\"],\r\n        \"S06_SENT_TO_PRINTER\": [\"S07_PRINT_COLLECTED\", \"S08_PRINT_REJECTED\"],\r\n        \"S07_PRINT_COLLECTED\": [\"S09_DELIVERED_TO_RAJA\"],\r\n        \"S08_PRINT_REJECTED\": [\"S06_SENT_TO_PRINTER\"],\r\n        \"S09_DELIVERED_TO_RAJA\": [\"S10_CUTTING_IN_PROGRESS\"],\r\n        \"S10_CUTTING_IN_PROGRESS\": [\"S11_CUTTING_COMPLETE\"],\r\n        \"S11_CUTTING_COMPLETE\": [\"S12_STITCHING_IN_PROGRESS\"],\r\n        \"S12_STITCHING_IN_PROGRESS\": [\"S13_STITCHING_COMPLETE\"],\r\n        \"S13_STITCHING_COMPLETE\": [\"S14_QC_IN_PROGRESS\"],\r\n        \"S14_QC_IN_PROGRESS\": [\"S15_QC_PASSED\", \"S16_QC_FAILED\"],\r\n        \"S15_QC_PASSED\": [\"S17_SHIPPED\"],\r\n        \"S16_QC_FAILED\": [\"S12_STITCHING_IN_PROGRESS\"],\r\n        \"S17_SHIPPED\": [\"S18_DELIVERED\"],\r\n        \"S18_DELIVERED\": [\"S19_COMPLETE\"],\r\n        \"S19_COMPLETE\": []\r\n    }'::jsonb;\r\nBEGIN\r\n    -- Check if new_state is in the \n\n---\n**Branches:**\n- `vk/8aed-db-e03-s01-t05-c`\n",
    "branches": [
      "vk/8aed-db-e03-s01-t05-c"
    ]
  },
  {
    "title": "DB-E03-S01-T04: Create pattern_files Table",
    "status": "inreview",
    "labels": [
      "in-review",
      "db"
    ],
    "body": "## Metadata\n- **Task ID:** DB-E03-S01-T04\n- **Module:** DB - Database & Backend Services  \n- **Epic:** Order & Fulfillment Schema  \n- **Story:** Order Tables  \n- **Phase:** 1\n- **Prerequisites:** DB-E03-S01-T02\n\n### Description\r\nCreate the pattern_files table to store references to generated DXF/PDF pattern files and their calibration status.\r\n\r\n### Acceptance Criteria\r\n- [ ] Table has required fields\r\n- [ ] Foreign key to order_items\r\n- [ ] File type enum (DXF, PDF, etc.)\r\n- [ ] URL to file in storage\r\n- [ ] Calibration verification flag\r\n- [ ] Supports multiple files per item\r\n\r\n### Implementation Details\r\n```sql\r\n-- Create file type enum\r\nCREATE TYPE pattern_file_type AS ENUM (\r\n    'dxf',           -- Vector pattern for cutting\r\n    'pdf',           -- Print-ready pattern\r\n    'tech_pack_pdf', -- Technical specifications\r\n    'marker_pdf',    -- Marker layout\r\n    'preview_png'    -- Preview image\r\n);\r\n\r\n-- Create pattern_files table\r\nCREATE TABLE public.pattern_files (\r\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\r\n    order_item_id UUID NOT NULL REFERENCES public.order_items(id) ON DELETE CASCADE,\r\n    \r\n    -- File details\r\n    file_type pattern_file_type NOT NULL,\r\n    file_name VARCHAR(255) NOT NULL,\r\n    file_url TEXT NOT NULL,  -- Supabase Storage URL\r\n    file_size_bytes BIGINT,\r\n    \r\n    -- Version tracking\r\n    version INTEGER DEFAULT 1 NOT NULL,\r\n    is_current BOOLEAN DEFAULT TRUE,\r\n    \r\n    -- Calibration (for printed patterns)\r\n    calibration_verified BOOLEAN DEFAULT FALSE,\r\n    calibration_verified_at TIMESTAMPTZ,\r\n    calibration_verified_by UUID REFERENCES public.users(id),\r\n    calibration_value_cm DECIMAL(4,2),  -- Ruler test result\r\n    \r\n    -- Generation metadata\r\n    generated_by VARCHAR(100),  -- 'optitex', 'manual', etc.\r\n    generation_params JSONB,    -- Parameters used\r\n    \r\n    -- Notes\r\n    notes TEXT,\r\n    \r\n    created_at TIMESTAMPTZ DEFAULT NOW() NOT NULL,\r\n    updated_at TIMESTAMPTZ DEFAULT NOW() NOT NULL\r\n);\r\n\r\n-- Ind\n\n---\n**Branches:**\n- `vk/2ba7-db-e03-s01-t04-c`\n",
    "branches": [
      "vk/2ba7-db-e03-s01-t04-c"
    ]
  },
  {
    "title": "DB-E03-S01-T03: Create order_state_history Table",
    "status": "inreview",
    "labels": [
      "in-review",
      "db"
    ],
    "body": "## Metadata\n- **Task ID:** DB-E03-S01-T03\n- **Module:** DB - Database & Backend Services  \n- **Epic:** Order & Fulfillment Schema  \n- **Story:** Order Tables  \n- **Phase:** 1\n- **Prerequisites:** DB-E03-S01-T01\n\n### Description\r\nCreate the order_state_history table to maintain an audit log of all order state transitions.\r\n\r\n### Acceptance Criteria\r\n- [ ] Table records every state change\r\n- [ ] Stores from_state and to_state\r\n- [ ] Records who made the change\r\n- [ ] Timestamps all transitions\r\n- [ ] Optional notes field for context\r\n\r\n### Implementation Details\r\n```sql\r\n-- Create order_state_history table\r\nCREATE TABLE public.order_state_history (\r\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\r\n    order_id UUID NOT NULL REFERENCES public.orders(id) ON DELETE CASCADE,\r\n    \r\n    -- State transition\r\n    from_state order_state,\r\n    to_state order_state NOT NULL,\r\n    \r\n    -- Who made the change\r\n    changed_by UUID REFERENCES public.users(id) ON DELETE SET NULL,\r\n    changed_by_role VARCHAR(50),  -- 'customer', 'admin', 'system', 'runner'\r\n    \r\n    -- Context\r\n    notes TEXT,\r\n    metadata JSONB DEFAULT '{}'::jsonb,  -- Additional context data\r\n    \r\n    -- Automatic tracking\r\n    ip_address INET,\r\n    user_agent TEXT,\r\n    \r\n    created_at TIMESTAMPTZ DEFAULT NOW() NOT NULL\r\n);\r\n\r\n-- Indexes\r\nCREATE INDEX idx_order_state_history_order_id ON public.order_state_history(order_id);\r\nCREATE INDEX idx_order_state_history_created_at ON public.order_state_history(created_at DESC);\r\nCREATE INDEX idx_order_state_history_to_state ON public.order_state_history(to_state);\r\n\r\n-- Enable RLS\r\nALTER TABLE public.order_state_history ENABLE ROW LEVEL SECURITY;\r\n\r\n-- RLS: Users can view history for their own orders\r\nCREATE POLICY \"Users can view own order history\"\r\n    ON public.order_state_history\r\n    FOR SELECT\r\n    USING (\r\n        order_id IN (\r\n            SELECT id FROM public.orders WHERE user_id = auth.uid()\r\n        )\r\n    );\r\n\r\nCREATE POLICY \"Service role full access \n\n---\n**Branches:**\n- `vk/878e-db-e03-s01-t03-c`\n",
    "branches": [
      "vk/878e-db-e03-s01-t03-c"
    ]
  },
  {
    "title": "DB-E03-S01-T02: Create order_items Table",
    "status": "inreview",
    "labels": [
      "in-review",
      "db"
    ],
    "body": "## Metadata\n- **Task ID:** DB-E03-S01-T02\n- **Module:** DB - Database & Backend Services  \n- **Epic:** Order & Fulfillment Schema  \n- **Story:** Order Tables  \n- **Phase:** 1\n- **Prerequisites:** DB-E03-S01-T01, DB-E01-S02 complete\n\n### Description\r\nCreate the order_items table to store individual suit items within an order, linking to configurations and measurements.\r\n\r\n### Acceptance Criteria\r\n- [ ] Table has required fields\r\n- [ ] Foreign key to orders\r\n- [ ] Foreign key to suit_configs\r\n- [ ] Foreign key to measurements\r\n- [ ] Individual item pricing\r\n- [ ] Item-level status tracking\r\n\r\n### Implementation Details\r\n```sql\r\n-- Create order item status enum\r\nCREATE TYPE order_item_status AS ENUM (\r\n    'pending_measurement',\r\n    'ready_for_production',\r\n    'in_production',\r\n    'completed',\r\n    'cancelled'\r\n);\r\n\r\n-- Create order_items table\r\nCREATE TABLE public.order_items (\r\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\r\n    order_id UUID NOT NULL REFERENCES public.orders(id) ON DELETE CASCADE,\r\n    suit_config_id UUID NOT NULL REFERENCES public.suit_configs(id) ON DELETE RESTRICT,\r\n    measurement_id UUID REFERENCES public.measurements(id) ON DELETE SET NULL,\r\n    \r\n    -- For wedding orders, link to attendee\r\n    wedding_attendee_id UUID REFERENCES public.wedding_attendees(id) ON DELETE SET NULL,\r\n    \r\n    -- Item details\r\n    quantity INTEGER DEFAULT 1 NOT NULL,\r\n    \r\n    -- Pricing (snapshot at time of order)\r\n    unit_price_gbp DECIMAL(8,2) NOT NULL,\r\n    fabric_modifier DECIMAL(3,2) NOT NULL,\r\n    total_price_gbp DECIMAL(8,2) NOT NULL,\r\n    \r\n    -- Status\r\n    status order_item_status DEFAULT 'pending_measurement' NOT NULL,\r\n    \r\n    -- Production tracking\r\n    pattern_generated_at TIMESTAMPTZ,\r\n    production_started_at TIMESTAMPTZ,\r\n    production_completed_at TIMESTAMPTZ,\r\n    \r\n    -- Notes\r\n    special_instructions TEXT,\r\n    internal_notes TEXT,\r\n    \r\n    created_at TIMESTAMPTZ DEFAULT NOW() NOT NULL,\r\n    updated_at TIMESTAMPTZ DEFAULT NO\n\n---\n**Branches:**\n- `vk/84fc-db-e03-s01-t02-c`\n",
    "branches": [
      "vk/84fc-db-e03-s01-t02-c"
    ]
  },
  {
    "title": "DB-E03-S01-T01: Create orders Table",
    "status": "inreview",
    "labels": [
      "in-review",
      "db"
    ],
    "body": "## Metadata\n- **Task ID:** DB-E03-S01-T01\n- **Module:** DB - Database & Backend Services  \n- **Epic:** Order & Fulfillment Schema  \n- **Story:** Order Tables  \n- **Phase:** 1\n- **Prerequisites:** DB-E01-S01 complete\n\n### Description\r\nCreate the orders table to track purchases through the 22-state manufacturing pipeline (S01-S19 + error states).\r\n\r\n### Acceptance Criteria\r\n- [ ] Table has required fields\r\n- [ ] Foreign key to users\r\n- [ ] Track type enum (A = retail, B = wedding)\r\n- [ ] Order state enum (S01-S19)\r\n- [ ] Stripe payment intent ID stored\r\n- [ ] Total amount in GBP\r\n\r\n### Implementation Details\r\n```sql\r\n-- Create track type enum\r\nCREATE TYPE order_track_type AS ENUM ('A', 'B');\r\n\r\n-- Create order state enum (S01-S19)\r\nCREATE TYPE order_state AS ENUM (\r\n    'S01_PAID',\r\n    'S02_MEASUREMENT_PENDING',\r\n    'S03_MEASUREMENT_RECEIVED',\r\n    'S04_PATTERN_PENDING',\r\n    'S05_PATTERN_GENERATED',\r\n    'S06_SENT_TO_PRINTER',\r\n    'S07_PRINT_COLLECTED',\r\n    'S08_PRINT_REJECTED',\r\n    'S09_DELIVERED_TO_RAJA',\r\n    'S10_CUTTING_IN_PROGRESS',\r\n    'S11_CUTTING_COMPLETE',\r\n    'S12_STITCHING_IN_PROGRESS',\r\n    'S13_STITCHING_COMPLETE',\r\n    'S14_QC_IN_PROGRESS',\r\n    'S15_QC_PASSED',\r\n    'S16_QC_FAILED',\r\n    'S17_SHIPPED',\r\n    'S18_DELIVERED',\r\n    'S19_COMPLETE'\r\n);\r\n\r\n-- Create orders table\r\nCREATE TABLE public.orders (\r\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\r\n    user_id UUID NOT NULL REFERENCES public.users(id) ON DELETE RESTRICT,\r\n    \r\n    -- Order classification\r\n    track_type order_track_type NOT NULL,\r\n    wedding_event_id UUID REFERENCES public.wedding_events(id) ON DELETE SET NULL,\r\n    \r\n    -- Payment\r\n    stripe_payment_intent VARCHAR(255) UNIQUE,\r\n    stripe_charge_id VARCHAR(255),\r\n    \r\n    -- State machine\r\n    current_state order_state DEFAULT 'S01_PAID' NOT NULL,\r\n    \r\n    -- Financials (all in GBP)\r\n    subtotal_amount DECIMAL(10,2) NOT NULL,\r\n    vat_amount DECIMAL(10,2) NOT NULL,\r\n    total_amount DECIMAL(10,2) NOT NULL,\r\n    c\n\n---\n**Branches:**\n- `vk/82df-db-e03-s01-t01-c`\n",
    "branches": [
      "vk/82df-db-e03-s01-t01-c"
    ]
  },
  {
    "title": "DB-E02-S01-T05: Add RLS - Organizer Access",
    "status": "inreview",
    "labels": [
      "in-review",
      "db"
    ],
    "body": "## Metadata\n- **Task ID:** DB-E02-S01-T05\n- **Module:** DB - Database & Backend Services  \n- **Epic:** Wedding Party Schema  \n- **Story:** Wedding Event Tables  \n- **Phase:** 1\n- **Prerequisites:** DB-E02-S01-T01\n\n### Description\r\nImplement Row Level Security so organizers can only manage their own wedding events and related data.\r\n\r\n### Acceptance Criteria\r\n- [ ] RLS enabled on wedding_events\r\n- [ ] RLS enabled on wedding_templates\r\n- [ ] RLS enabled on wedding_attendees\r\n- [ ] Organizers can CRUD their own events\r\n- [ ] Organizers cannot see others' events\r\n- [ ] Attendees can view their own invite via token\r\n\r\n### Implementation Details\r\n```sql\r\n-- RLS for wedding_events\r\nCREATE POLICY \"Organizers can manage own events\"\r\n    ON public.wedding_events\r\n    FOR ALL\r\n    USING (organizer_id = auth.uid());\r\n\r\nCREATE POLICY \"Service role full access to events\"\r\n    ON public.wedding_events\r\n    FOR ALL\r\n    USING (auth.role() = 'service_role');\r\n\r\n-- RLS for wedding_templates\r\nCREATE POLICY \"Organizers can manage templates for own events\"\r\n    ON public.wedding_templates\r\n    FOR ALL\r\n    USING (\r\n        event_id IN (\r\n            SELECT id FROM public.wedding_events \r\n            WHERE organizer_id = auth.uid()\r\n        )\r\n    );\r\n\r\nCREATE POLICY \"Service role full access to templates\"\r\n    ON public.wedding_templates\r\n    FOR ALL\r\n    USING (auth.role() = 'service_role');\r\n\r\n-- RLS for wedding_attendees\r\nCREATE POLICY \"Organizers can manage attendees for own events\"\r\n    ON public.wedding_attendees\r\n    FOR ALL\r\n    USING (\r\n        event_id IN (\r\n            SELECT id FROM public.wedding_events \r\n            WHERE organizer_id = auth.uid()\r\n        )\r\n    );\r\n\r\n-- Attendees can view their own record via invite token\r\nCREATE POLICY \"Attendees can view own record via token\"\r\n    ON public.wedding_attendees\r\n    FOR SELECT\r\n    USING (\r\n        invite_token = coalesce(\r\n            current_setting('request.jwt.claim.invite_token', true), \r\n            ''\r\n        )\r\n \n\n---\n**Branches:**\n- `vk/f2f8-db-e02-s01-t05-a`\n",
    "branches": [
      "vk/f2f8-db-e02-s01-t05-a"
    ]
  },
  {
    "title": "DB-E02-S01-T04: Create wedding_attendees Table",
    "status": "inreview",
    "labels": [
      "in-review",
      "db"
    ],
    "body": "## Metadata\n- **Task ID:** DB-E02-S01-T04\n- **Module:** DB - Database & Backend Services  \n- **Epic:** Wedding Party Schema  \n- **Story:** Wedding Event Tables  \n- **Phase:** 1\n- **Prerequisites:** DB-E02-S01-T03\n\n### Description\r\nCreate the wedding_attendees table to track invited party members, their invite tokens, measurement status, and linked measurements.\r\n\r\n### Acceptance Criteria\r\n- [ ] Table has required fields\r\n- [ ] Unique invite_token for each attendee\r\n- [ ] Foreign key to wedding_events\r\n- [ ] Foreign key to wedding_templates\r\n- [ ] Optional foreign key to measurements\r\n- [ ] Status enum for tracking progress\r\n\r\n### Implementation Details\r\n```sql\r\n-- Create attendee status enum\r\nCREATE TYPE attendee_status AS ENUM (\r\n    'invited',          -- Invite sent, not yet accessed\r\n    'viewed',           -- Viewed the invite link\r\n    'measuring',        -- Started measurement process\r\n    'submitted',        -- Measurements submitted\r\n    'confirmed',        -- Organizer confirmed measurements\r\n    'needs_revision'    -- Organizer requested re-measurement\r\n);\r\n\r\n-- Create wedding_attendees table\r\nCREATE TABLE public.wedding_attendees (\r\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\r\n    event_id UUID NOT NULL REFERENCES public.wedding_events(id) ON DELETE CASCADE,\r\n    template_id UUID NOT NULL REFERENCES public.wedding_templates(id) ON DELETE RESTRICT,\r\n    \r\n    -- Attendee info\r\n    email VARCHAR(255) NOT NULL,\r\n    full_name VARCHAR(255),\r\n    phone VARCHAR(20),\r\n    \r\n    -- Invite token (URL-safe, unique)\r\n    invite_token VARCHAR(64) UNIQUE NOT NULL DEFAULT encode(gen_random_bytes(32), 'hex'),\r\n    \r\n    -- Status tracking\r\n    status attendee_status DEFAULT 'invited' NOT NULL,\r\n    invite_sent_at TIMESTAMPTZ,\r\n    first_viewed_at TIMESTAMPTZ,\r\n    submitted_at TIMESTAMPTZ,\r\n    confirmed_at TIMESTAMPTZ,\r\n    \r\n    -- Linked measurement (once submitted)\r\n    measurement_id UUID REFERENCES public.measurements(id) ON DELETE SET NULL,\r\n    \r\n    -- \n\n---\n**Branches:**\n- `vk/69e6-db-e02-s01-t04-c`\n",
    "branches": [
      "vk/69e6-db-e02-s01-t04-c"
    ]
  },
  {
    "title": "DB-E02-S01-T03: Create wedding_templates Table",
    "status": "inreview",
    "labels": [
      "in-review",
      "db"
    ],
    "body": "## Metadata\n- **Task ID:** DB-E02-S01-T03\n- **Module:** DB - Database & Backend Services  \n- **Epic:** Wedding Party Schema  \n- **Story:** Wedding Event Tables  \n- **Phase:** 1\n- **Prerequisites:** DB-E02-S01-T01, DB-E01-S02 complete\n\n### Description\r\nCreate the wedding_templates table to store role-based suit templates (e.g., Groom, Best Man, Groomsman) that attendees will be assigned to.\r\n\r\n### Acceptance Criteria\r\n- [ ] Table has required fields\r\n- [ ] Foreign key to wedding_events\r\n- [ ] Foreign key to suit_configs\r\n- [ ] Role enum for party roles\r\n- [ ] Multiple templates per event supported\r\n\r\n### Implementation Details\r\n```sql\r\n-- Create role enum\r\nCREATE TYPE wedding_party_role AS ENUM (\r\n    'groom',\r\n    'best_man',\r\n    'groomsman',\r\n    'father_of_bride',\r\n    'father_of_groom',\r\n    'usher',\r\n    'ring_bearer',\r\n    'other'\r\n);\r\n\r\n-- Create wedding_templates table\r\nCREATE TABLE public.wedding_templates (\r\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\r\n    event_id UUID NOT NULL REFERENCES public.wedding_events(id) ON DELETE CASCADE,\r\n    suit_config_id UUID NOT NULL REFERENCES public.suit_configs(id) ON DELETE RESTRICT,\r\n    \r\n    -- Role assignment\r\n    role wedding_party_role NOT NULL,\r\n    role_custom_name VARCHAR(100),  -- For 'other' role or custom naming\r\n    \r\n    -- Template settings\r\n    is_locked BOOLEAN DEFAULT FALSE,\r\n    locked_at TIMESTAMPTZ,\r\n    \r\n    -- Pricing (may differ by role)\r\n    price_override_gbp DECIMAL(8,2),\r\n    \r\n    created_at TIMESTAMPTZ DEFAULT NOW() NOT NULL,\r\n    updated_at TIMESTAMPTZ DEFAULT NOW() NOT NULL,\r\n    \r\n    -- Ensure unique role per event (except 'groomsman' which can have multiple)\r\n    CONSTRAINT unique_singular_roles UNIQUE (event_id, role) \r\n        WHERE role NOT IN ('groomsman', 'usher', 'other')\r\n);\r\n\r\n-- Indexes\r\nCREATE INDEX idx_wedding_templates_event_id ON public.wedding_templates(event_id);\r\nCREATE INDEX idx_wedding_templates_suit_config_id ON public.wedding_templates(suit_config_id);\r\n\r\n-\n\n---\n**Branches:**\n- `vk/3008-db-e02-s01-t03-c`\n",
    "branches": [
      "vk/3008-db-e02-s01-t03-c"
    ]
  },
  {
    "title": "DB-E02-S01-T02: Add Wedding Date Constraint",
    "status": "inreview",
    "labels": [
      "in-review",
      "db"
    ],
    "body": "## Metadata\n- **Task ID:** DB-E02-S01-T02\n- **Module:** DB - Database & Backend Services  \n- **Epic:** Wedding Party Schema  \n- **Story:** Wedding Event Tables  \n- **Phase:** 1\n- **Prerequisites:** DB-E02-S01-T01\n\n### Description\r\nAdd a check constraint ensuring wedding event dates are at least 4 weeks in the future to allow sufficient time for measurement collection and suit production.\r\n\r\n### Acceptance Criteria\r\n- [ ] Constraint exists on wedding_events table\r\n- [ ] INSERT with date < NOW() + 4 weeks fails\r\n- [ ] INSERT with date >= NOW() + 4 weeks succeeds\r\n- [ ] Constraint name is descriptive\r\n\r\n### Implementation Details\r\n```sql\r\n-- Add check constraint for minimum lead time\r\nALTER TABLE public.wedding_events\r\nADD CONSTRAINT wedding_events_min_lead_time\r\nCHECK (event_date >= CURRENT_DATE + INTERVAL '28 days');\r\n\r\n-- Test constraint (should fail)\r\nINSERT INTO public.wedding_events (organizer_id, event_name, event_date)\r\nVALUES ('00000000-0000-0000-0000-000000000000', 'Test Wedding', CURRENT_DATE + INTERVAL '7 days');\r\n-- Expected: ERROR: new row violates check constraint \"wedding_events_min_lead_time\"\r\n\r\n-- Test constraint (should succeed)\r\nINSERT INTO public.wedding_events (organizer_id, event_name, event_date)\r\nVALUES ('valid-user-uuid', 'Test Wedding', CURRENT_DATE + INTERVAL '30 days');\r\n-- Expected: SUCCESS\r\n```\r\n\r\n### Definition of Done\r\nConstraint enforced - dates < 4 weeks out are rejected\n\n---\n**Branches:**\n- `vk/5473-db-e02-s01-t02-a`\n",
    "branches": [
      "vk/5473-db-e02-s01-t02-a"
    ]
  },
  {
    "title": "DB-E02-S01-T01: Create wedding_events Table",
    "status": "inreview",
    "labels": [
      "in-review",
      "db"
    ],
    "body": "## Metadata\n- **Task ID:** DB-E02-S01-T01\n- **Module:** DB - Database & Backend Services  \n- **Epic:** Wedding Party Schema  \n- **Story:** Wedding Event Tables  \n- **Phase:** 1\n- **Prerequisites:** DB-E01-S01 complete\n\n### Description\r\nCreate the wedding_events table to store wedding party events created by organizers (Track B).\r\n\r\n### Acceptance Criteria\r\n- [ ] Table has required fields\r\n- [ ] Foreign key to users (organizer)\r\n- [ ] Event date field\r\n- [ ] Status enum for event lifecycle\r\n- [ ] Constraint: event_date >= NOW() + 4 weeks\r\n\r\n### Implementation Details\r\n```sql\r\n-- Create event status enum\r\nCREATE TYPE wedding_event_status AS ENUM (\r\n    'draft',           -- Organizer still configuring\r\n    'templates_locked', -- Templates finalized, invites can be sent\r\n    'invites_sent',    -- Invites have been sent to attendees\r\n    'measuring',       -- Attendees are submitting measurements\r\n    'confirmed',       -- All measurements received\r\n    'paid',            -- Payment completed\r\n    'in_production',   -- Suits being made\r\n    'completed'        -- Event completed\r\n);\r\n\r\n-- Create wedding_events table\r\nCREATE TABLE public.wedding_events (\r\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\r\n    organizer_id UUID NOT NULL REFERENCES public.users(id) ON DELETE CASCADE,\r\n    \r\n    -- Event details\r\n    event_name VARCHAR(255) NOT NULL,\r\n    event_date DATE NOT NULL,\r\n    venue_name VARCHAR(255),\r\n    venue_location TEXT,\r\n    \r\n    -- Status tracking\r\n    status wedding_event_status DEFAULT 'draft' NOT NULL,\r\n    \r\n    -- Settings\r\n    measurement_deadline DATE,\r\n    allow_late_submissions BOOLEAN DEFAULT FALSE,\r\n    \r\n    -- Metadata\r\n    notes TEXT,\r\n    \r\n    created_at TIMESTAMPTZ DEFAULT NOW() NOT NULL,\r\n    updated_at TIMESTAMPTZ DEFAULT NOW() NOT NULL\r\n);\r\n\r\n-- Indexes\r\nCREATE INDEX idx_wedding_events_organizer_id ON public.wedding_events(organizer_id);\r\nCREATE INDEX idx_wedding_events_event_date ON public.wedding_events(event_date);\r\nCREATE INDEX idx_\n\n---\n**Branches:**\n- `vk/672c-db-e02-s01-t01-c`\n",
    "branches": [
      "vk/672c-db-e02-s01-t01-c"
    ]
  },
  {
    "title": "DB-E01-S02-T04: Seed Initial Fabrics",
    "status": "inreview",
    "labels": [
      "in-review",
      "db"
    ],
    "body": "## Metadata\n- **Task ID:** DB-E01-S02-T04\n- **Module:** DB - Database & Backend Services  \n- **Epic:** Core Schema Implementation  \n- **Story:** Measurement and Product Tables  \n- **Phase:** 1\n- **Prerequisites:** DB-E01-S02-T02\n\n### Description\r\nInsert 5 initial Raymond-stocked fabrics for MVP launch. These should cover basic color options (navy, charcoal, black, grey, tan).\r\n\r\n### Acceptance Criteria\r\n- [ ] 5 fabric rows inserted\r\n- [ ] Each has unique code\r\n- [ ] Texture URLs point to valid assets\r\n- [ ] Price modifiers are set appropriately\r\n- [ ] All marked as in_stock\r\n\r\n### Implementation Details\r\n```sql\r\n-- Seed 5 Raymond fabrics for MVP\r\nINSERT INTO public.fabrics (code, name, description, price_modifier, color_hex, in_stock, properties, supplier) VALUES\r\n\r\n('RAY-NVY-001', \r\n 'Navy Classic Wool', \r\n 'Timeless navy blue pure wool suiting. Perfect for business and formal occasions.',\r\n 1.00,\r\n '#1a1a2e',\r\n TRUE,\r\n '{\"weight_gsm\": 280, \"composition\": \"100% Pure Wool\", \"weave\": \"Twill\", \"stretch\": false, \"season\": [\"all-season\"]}',\r\n 'Raymond'),\r\n\r\n('RAY-CHR-001',\r\n 'Charcoal Grey Wool',\r\n 'Sophisticated charcoal grey wool suiting. Versatile for all occasions.',\r\n 1.00,\r\n '#36454f',\r\n TRUE,\r\n '{\"weight_gsm\": 280, \"composition\": \"100% Pure Wool\", \"weave\": \"Plain\", \"stretch\": false, \"season\": [\"all-season\"]}',\r\n 'Raymond'),\r\n\r\n('RAY-BLK-001',\r\n 'Midnight Black Wool',\r\n 'Deep black pure wool suiting. Essential for formal and evening wear.',\r\n 1.10,\r\n '#0d0d0d',\r\n TRUE,\r\n '{\"weight_gsm\": 300, \"composition\": \"100% Pure Wool\", \"weave\": \"Plain\", \"stretch\": false, \"season\": [\"all-season\"]}',\r\n 'Raymond'),\r\n\r\n('RAY-GRY-001',\r\n 'Light Grey Wool',\r\n 'Contemporary light grey wool suiting. Perfect for daytime events.',\r\n 1.00,\r\n '#808080',\r\n TRUE,\r\n '{\"weight_gsm\": 260, \"composition\": \"100% Pure Wool\", \"weave\": \"Plain\", \"stretch\": false, \"season\": [\"spring\", \"summer\"]}',\r\n 'Raymond'),\r\n\r\n('RAY-TAN-001',\r\n 'Tan Cotton-Linen',\r\n 'Relaxed tan cotton-linen blend. Ideal for summ\n\n---\n**Branches:**\n- `vk/ab6f-db-e01-s02-t04-s`\n",
    "branches": [
      "vk/ab6f-db-e01-s02-t04-s"
    ]
  },
  {
    "title": "DB-E01-S02-T03: Create suit_configs Table",
    "status": "inreview",
    "labels": [
      "in-review",
      "db"
    ],
    "body": "## Metadata\n- **Task ID:** DB-E01-S02-T03\n- **Module:** DB - Database & Backend Services  \n- **Epic:** Core Schema Implementation  \n- **Story:** Measurement and Product Tables  \n- **Phase:** 1\n- **Prerequisites:** DB-E01-S02-T01, DB-E01-S02-T02\n\n### Description\r\nCreate the suit_configs table to store user suit configurations including fabric selection, style options, and whether it's a locked template for wedding parties.\r\n\r\n### Acceptance Criteria\r\n- [ ] Foreign key to sessions\r\n- [ ] Foreign key to fabrics\r\n- [ ] Style options stored as JSONB\r\n- [ ] is_template flag for wedding templates\r\n- [ ] Can store complete suit configuration\r\n\r\n### Implementation Details\r\n```sql\r\n-- Create suit_configs table\r\nCREATE TABLE public.suit_configs (\r\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\r\n    session_id UUID NOT NULL REFERENCES public.sessions(id) ON DELETE CASCADE,\r\n    fabric_id UUID NOT NULL REFERENCES public.fabrics(id),\r\n    \r\n    -- Style configuration\r\n    style_json JSONB NOT NULL DEFAULT '{}'::jsonb,\r\n    /*\r\n    {\r\n        \"jacket\": {\r\n            \"lapel\": \"notch\",        -- notch, peak, shawl\r\n            \"buttons\": 2,            -- 1, 2, 3\r\n            \"vents\": \"double\",       -- none, single, double\r\n            \"pocket_style\": \"flap\",  -- flap, jetted, patch\r\n            \"lining_color\": \"#1a1a2e\"\r\n        },\r\n        \"trousers\": {\r\n            \"fit\": \"slim\",           -- slim, regular, relaxed\r\n            \"pleats\": \"flat\",        -- flat, single, double\r\n            \"cuff\": false,\r\n            \"waistband\": \"standard\"  -- standard, extended\r\n        },\r\n        \"vest\": {\r\n            \"included\": false,\r\n            \"buttons\": 5,\r\n            \"back_material\": \"lining\" -- lining, self\r\n        }\r\n    }\r\n    */\r\n    \r\n    -- Template settings (for wedding Track B)\r\n    is_template BOOLEAN DEFAULT FALSE,\r\n    template_name VARCHAR(255),  -- e.g., \"Groomsman - Navy Classic\"\r\n    template_locked_at TIMESTAMPTZ,\r\n    \r\n    -- Pricing snapshot\r\n    calculated_p\n\n---\n**Branches:**\n- `vk/2b69-db-e01-s02-t03-c`\n",
    "branches": [
      "vk/2b69-db-e01-s02-t03-c"
    ]
  },
  {
    "title": "DB-E01-S02-T02: Create fabrics Table",
    "status": "done",
    "labels": [
      "done",
      "db"
    ],
    "body": "## Metadata\n- **Task ID:** DB-E01-S02-T02\n- **Module:** DB - Database & Backend Services  \n- **Epic:** Core Schema Implementation  \n- **Story:** Measurement and Product Tables  \n- **Phase:** 1\n- **Prerequisites:** None\n\n### Description\r\nCreate the fabrics table to store available fabric options with pricing, textures, and physical properties.\r\n\r\n### Acceptance Criteria\r\n- [ ] Table has all required fields\r\n- [ ] Price modifier is a multiplier (e.g., 1.0, 1.2, 1.5)\r\n- [ ] Texture URL points to 3D texture asset\r\n- [ ] In-stock boolean for availability\r\n- [ ] Properties JSONB for physical characteristics\r\n\r\n### Implementation Details\r\n```sql\r\n-- Create fabrics table\r\nCREATE TABLE public.fabrics (\r\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\r\n    code VARCHAR(50) UNIQUE NOT NULL,  -- e.g., 'RAY-NVY-001'\r\n    name VARCHAR(255) NOT NULL,\r\n    description TEXT,\r\n    \r\n    -- Pricing\r\n    price_modifier DECIMAL(3,2) DEFAULT 1.00 NOT NULL,  -- Multiplier\r\n    base_price_gbp DECIMAL(8,2),\r\n    \r\n    -- Visuals\r\n    texture_url TEXT,  -- URL to PBR texture set\r\n    thumbnail_url TEXT,\r\n    color_hex VARCHAR(7),  -- Primary color for UI\r\n    \r\n    -- Availability\r\n    in_stock BOOLEAN DEFAULT TRUE,\r\n    stock_quantity INTEGER,\r\n    lead_time_days INTEGER DEFAULT 14,\r\n    \r\n    -- Physical properties\r\n    properties JSONB DEFAULT '{}'::jsonb,\r\n    /*\r\n    {\r\n        \"weight_gsm\": 280,\r\n        \"composition\": \"100% Wool\",\r\n        \"weave\": \"Plain\",\r\n        \"stretch\": false,\r\n        \"season\": [\"autumn\", \"winter\"],\r\n        \"care\": [\"dry clean only\"]\r\n    }\r\n    */\r\n    \r\n    -- Supplier info\r\n    supplier VARCHAR(255),  -- e.g., 'Raymond'\r\n    supplier_code VARCHAR(100),\r\n    \r\n    -- Metadata\r\n    is_active BOOLEAN DEFAULT TRUE,\r\n    sort_order INTEGER DEFAULT 0,\r\n    \r\n    created_at TIMESTAMPTZ DEFAULT NOW() NOT NULL,\r\n    updated_at TIMESTAMPTZ DEFAULT NOW() NOT NULL\r\n);\r\n\r\n-- Indexes\r\nCREATE INDEX idx_fabrics_code ON public.fabrics(code);\r\nCREATE INDEX idx_fabrics_in\n\n---\n**Branches:**\n- `vk/1df4-db-e01-s02-t02-c`\n- `vk/32a3-db-e01-s02-t02-c`\n",
    "branches": [
      "vk/1df4-db-e01-s02-t02-c",
      "vk/32a3-db-e01-s02-t02-c"
    ]
  },
  {
    "title": "DB-E01-S02-T01: Create measurements Table",
    "status": "inreview",
    "labels": [
      "in-review",
      "db"
    ],
    "body": "## Metadata\n- **Task ID:** DB-E01-S02-T01\n- **Module:** DB - Database & Backend Services  \n- **Epic:** Core Schema Implementation  \n- **Story:** Measurement and Product Tables  \n- **Phase:** 1\n- **Prerequisites:** DB-E01-S01 complete\n\n### Description\r\nCreate the measurements table to store all 28 body measurements extracted from the vision pipeline, along with the raw SMPL-X beta parameters and any user overrides.\r\n\r\n### Acceptance Criteria\r\n- [ ] Table has all 28 measurement fields in millimeters\r\n- [ ] JSONB field for user_overrides\r\n- [ ] JSONB field for smplx_beta (10-dim shape vector)\r\n- [ ] Foreign key to sessions table\r\n- [ ] Confidence scores for each measurement\r\n- [ ] Timestamps for tracking\r\n\r\n### Implementation Details\r\n```sql\r\n-- Create measurements table\r\nCREATE TABLE public.measurements (\r\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\r\n    session_id UUID NOT NULL REFERENCES public.sessions(id) ON DELETE CASCADE,\r\n    \r\n    -- Core measurements (all in millimeters)\r\n    height DECIMAL(6,1),\r\n    weight_kg DECIMAL(5,1),\r\n    \r\n    -- Torso measurements\r\n    chest_circumference DECIMAL(5,1),\r\n    waist_circumference DECIMAL(5,1),\r\n    hip_circumference DECIMAL(5,1),\r\n    shoulder_width DECIMAL(5,1),\r\n    back_width DECIMAL(5,1),\r\n    chest_width DECIMAL(5,1),\r\n    torso_length DECIMAL(5,1),\r\n    \r\n    -- Arm measurements\r\n    shoulder_to_wrist DECIMAL(5,1),\r\n    shoulder_to_elbow DECIMAL(5,1),\r\n    elbow_to_wrist DECIMAL(5,1),\r\n    bicep_circumference DECIMAL(5,1),\r\n    forearm_circumference DECIMAL(5,1),\r\n    wrist_circumference DECIMAL(5,1),\r\n    \r\n    -- Neck measurements\r\n    neck_circumference DECIMAL(5,1),\r\n    neck_to_shoulder DECIMAL(5,1),\r\n    \r\n    -- Leg measurements\r\n    inseam DECIMAL(5,1),\r\n    outseam DECIMAL(5,1),\r\n    thigh_circumference DECIMAL(5,1),\r\n    knee_circumference DECIMAL(5,1),\r\n    calf_circumference DECIMAL(5,1),\r\n    ankle_circumference DECIMAL(5,1),\r\n    \r\n    -- Additional measurements\r\n    rise DECIMAL(5,1),\r\n    a\n\n---\n**Branches:**\n- `vk/d0e3-db-e01-s02-t01-c`\n",
    "branches": [
      "vk/d0e3-db-e01-s02-t01-c"
    ]
  },
  {
    "title": "DB-E01-S01-T04: Add RLS Policy - Sessions",
    "status": "inreview",
    "labels": [
      "in-review",
      "db"
    ],
    "body": "## Metadata\n- **Task ID:** DB-E01-S01-T04\n- **Module:** DB - Database & Backend Services  \n- **Epic:** Core Schema Implementation  \n- **Story:** User Identity Tables  \n- **Phase:** 1\n- **Prerequisites:** DB-E01-S01-T02\n\n### Description\r\nImplement Row Level Security on sessions table. Sessions can be accessed by their owner (via session ID) or by the linked user.\r\n\r\n### Acceptance Criteria\r\n- [ ] RLS is enabled on sessions table\r\n- [ ] Anonymous sessions accessible by session ID\r\n- [ ] Authenticated users can access their linked sessions\r\n- [ ] Users cannot access other users' sessions\r\n- [ ] Service role can bypass RLS\r\n\r\n### Implementation Details\r\n```sql\r\n-- Enable RLS\r\nALTER TABLE public.sessions ENABLE ROW LEVEL SECURITY;\r\n\r\n-- Policy: Anyone can create a session (anonymous)\r\nCREATE POLICY \"Anyone can create session\"\r\n    ON public.sessions\r\n    FOR INSERT\r\n    WITH CHECK (true);\r\n\r\n-- Policy: Session owner can view (by session ID in JWT or user_id match)\r\nCREATE POLICY \"Session owner can view\"\r\n    ON public.sessions\r\n    FOR SELECT\r\n    USING (\r\n        id::text = coalesce(current_setting('request.jwt.claim.session_id', true), '') \r\n        OR user_id = auth.uid()\r\n    );\r\n\r\n-- Policy: Session owner can update\r\nCREATE POLICY \"Session owner can update\"\r\n    ON public.sessions\r\n    FOR UPDATE\r\n    USING (\r\n        id::text = coalesce(current_setting('request.jwt.claim.session_id', true), '')\r\n        OR user_id = auth.uid()\r\n    );\r\n\r\n-- Policy: Users can claim anonymous sessions\r\nCREATE POLICY \"Users can claim sessions\"\r\n    ON public.sessions\r\n    FOR UPDATE\r\n    USING (user_id IS NULL)  -- Only anonymous sessions\r\n    WITH CHECK (user_id = auth.uid());  -- Can only claim for self\r\n\r\n-- Service role bypass\r\nCREATE POLICY \"Service role full access sessions\"\r\n    ON public.sessions\r\n    FOR ALL\r\n    USING (auth.role() = 'service_role');\r\n```\r\n\r\n### Definition of Done\r\nRLS test passes - sessions accessible by owner or linked user only\n\n---\n**Branches:**\n- `vk/bf11-db-e01-s01-t04-a`\n",
    "branches": [
      "vk/bf11-db-e01-s01-t04-a"
    ]
  },
  {
    "title": "DB-E01-S01-T03: Add RLS Policy - Users",
    "status": "inreview",
    "labels": [
      "in-review",
      "db"
    ],
    "body": "## Metadata\n- **Task ID:** DB-E01-S01-T03\n- **Module:** DB - Database & Backend Services  \n- **Epic:** Core Schema Implementation  \n- **Story:** User Identity Tables  \n- **Phase:** 1\n- **Prerequisites:** DB-E01-S01-T01\n\n### Description\r\nImplement Row Level Security policies on the users table so users can only read and modify their own data.\r\n\r\n### Acceptance Criteria\r\n- [ ] RLS is enabled on users table\r\n- [ ] Users can SELECT their own row\r\n- [ ] Users can UPDATE their own row\r\n- [ ] Users cannot see other users' data\r\n- [ ] Service role can bypass RLS\r\n\r\n### Implementation Details\r\n```sql\r\n-- Enable RLS (if not already)\r\nALTER TABLE public.users ENABLE ROW LEVEL SECURITY;\r\n\r\n-- Policy: Users can view their own data\r\nCREATE POLICY \"Users can view own data\"\r\n    ON public.users\r\n    FOR SELECT\r\n    USING (auth.uid() = id);\r\n\r\n-- Policy: Users can update their own data\r\nCREATE POLICY \"Users can update own data\"\r\n    ON public.users\r\n    FOR UPDATE\r\n    USING (auth.uid() = id)\r\n    WITH CHECK (auth.uid() = id);\r\n\r\n-- Policy: Users can insert their own data (signup)\r\nCREATE POLICY \"Users can insert own data\"\r\n    ON public.users\r\n    FOR INSERT\r\n    WITH CHECK (auth.uid() = id);\r\n\r\n-- Service role bypass (for admin operations)\r\nCREATE POLICY \"Service role has full access\"\r\n    ON public.users\r\n    FOR ALL\r\n    USING (auth.role() = 'service_role');\r\n```\r\n\r\n### Verification\r\n```sql\r\n-- Test as authenticated user (should only see own data)\r\nSET ROLE authenticated;\r\nSET request.jwt.claim.sub = 'user-uuid-here';\r\nSELECT * FROM public.users; -- Should only return own row\r\n\r\n-- Test as service role (should see all)\r\nSET ROLE service_role;\r\nSELECT * FROM public.users; -- Should return all rows\r\n```\r\n\r\n### Definition of Done\r\nRLS test passes - users can only access own data\n\n---\n**Branches:**\n- `vk/a4eb-db-e01-s01-t03-a`\n",
    "branches": [
      "vk/a4eb-db-e01-s01-t03-a"
    ]
  },
  {
    "title": "DB-E01-S01-T02: Create sessions Table",
    "status": "inreview",
    "labels": [
      "in-review",
      "db"
    ],
    "body": "## Metadata\n- **Task ID:** DB-E01-S01-T02\n- **Module:** DB - Database & Backend Services  \n- **Epic:** Core Schema Implementation  \n- **Story:** User Identity Tables  \n- **Phase:** 1\n- **Prerequisites:** DB-E01-S01-T01\n\n### Description\r\nCreate the sessions table to track both anonymous and authenticated user sessions. Anonymous sessions have null user_id until claimed.\r\n\r\n### Acceptance Criteria\r\n- [ ] Table exists with correct schema\r\n- [ ] UUID primary key\r\n- [ ] Nullable foreign key to users table\r\n- [ ] Expiration timestamp for session cleanup\r\n- [ ] Foreign key constraint works correctly\r\n- [ ] Can create session without user_id (anonymous)\r\n\r\n### Implementation Details\r\n```sql\r\n-- Create sessions table\r\nCREATE TABLE public.sessions (\r\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\r\n    user_id UUID REFERENCES public.users(id) ON DELETE SET NULL,\r\n    device_fingerprint VARCHAR(255),\r\n    user_agent TEXT,\r\n    ip_address INET,\r\n    created_at TIMESTAMPTZ DEFAULT NOW() NOT NULL,\r\n    updated_at TIMESTAMPTZ DEFAULT NOW() NOT NULL,\r\n    expires_at TIMESTAMPTZ DEFAULT (NOW() + INTERVAL '30 days') NOT NULL,\r\n    last_active_at TIMESTAMPTZ DEFAULT NOW()\r\n);\r\n\r\n-- Create indexes\r\nCREATE INDEX idx_sessions_user_id ON public.sessions(user_id);\r\nCREATE INDEX idx_sessions_expires_at ON public.sessions(expires_at);\r\n\r\n-- Add updated_at trigger\r\nCREATE TRIGGER update_sessions_updated_at\r\n    BEFORE UPDATE ON public.sessions\r\n    FOR EACH ROW\r\n    EXECUTE FUNCTION update_updated_at_column();\r\n\r\n-- Enable RLS\r\nALTER TABLE public.sessions ENABLE ROW LEVEL SECURITY;\r\n```\r\n\r\n### Verification\r\n```sql\r\n-- Test creating anonymous session\r\nINSERT INTO public.sessions (id) VALUES (gen_random_uuid()) RETURNING *;\r\n\r\n-- Test creating session for user\r\nINSERT INTO public.sessions (user_id) \r\nSELECT id FROM public.users LIMIT 1\r\nRETURNING *;\r\n```\r\n\r\n### Definition of Done\r\nFK constraint works - can create sessions with and without user_id\n\n---\n**Branches:**\n- `vk/83d9-db-e01-s01-t02-c`\n",
    "branches": [
      "vk/83d9-db-e01-s01-t02-c"
    ]
  },
  {
    "title": "DB-E01-S01-T01: Create users Table",
    "status": "done",
    "labels": [
      "done",
      "db"
    ],
    "body": "## Metadata\n- **Task ID:** DB-E01-S01-T01\n- **Module:** DB - Database & Backend Services  \n- **Epic:** Core Schema Implementation  \n- **Story:** User Identity Tables  \n- **Phase:** 1\n- **Prerequisites:** None\n\n### Description\r\nCreate the users table in Supabase to store authenticated user information including Stripe customer IDs for payment processing.\r\n\r\n### Acceptance Criteria\r\n- [ ] Table exists in Supabase with correct schema\r\n- [ ] UUID primary key with auto-generation\r\n- [ ] Email field with unique constraint\r\n- [ ] Phone field (nullable)\r\n- [ ] Stripe customer ID field (nullable)\r\n- [ ] Timestamps are auto-populated\r\n- [ ] Indexes on email and stripe_customer_id\r\n\r\n### Implementation Details\r\n```sql\r\n-- Create users table\r\nCREATE TABLE public.users (\r\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\r\n    email VARCHAR(255) UNIQUE NOT NULL,\r\n    phone VARCHAR(20),\r\n    stripe_customer_id VARCHAR(255) UNIQUE,\r\n    full_name VARCHAR(255),\r\n    avatar_url TEXT,\r\n    created_at TIMESTAMPTZ DEFAULT NOW() NOT NULL,\r\n    updated_at TIMESTAMPTZ DEFAULT NOW() NOT NULL\r\n);\r\n\r\n-- Create indexes\r\nCREATE INDEX idx_users_email ON public.users(email);\r\nCREATE INDEX idx_users_stripe_customer_id ON public.users(stripe_customer_id);\r\n\r\n-- Create updated_at trigger\r\nCREATE OR REPLACE FUNCTION update_updated_at_column()\r\nRETURNS TRIGGER AS $$\r\nBEGIN\r\n    NEW.updated_at = NOW();\r\n    RETURN NEW;\r\nEND;\r\n$$ language 'plpgsql';\r\n\r\nCREATE TRIGGER update_users_updated_at\r\n    BEFORE UPDATE ON public.users\r\n    FOR EACH ROW\r\n    EXECUTE FUNCTION update_updated_at_column();\r\n\r\n-- Enable RLS\r\nALTER TABLE public.users ENABLE ROW LEVEL SECURITY;\r\n```\r\n\r\n### Definition of Done\r\nTable exists with correct schema, verified via `\\d users` in psql\n\n---\n**Branches:**\n- `vk/648f-db-e01-s01-t01-c`\n- `vk/4bf5-db-e01-s01-t01-c`\n",
    "branches": [
      "vk/648f-db-e01-s01-t01-c",
      "vk/4bf5-db-e01-s01-t01-c"
    ]
  },
  {
    "title": "INFRA-E02-S01-T05: Create docker-compose.yml",
    "status": "done",
    "labels": [
      "done",
      "infra"
    ],
    "body": "## Metadata\n- **Task ID:** INFRA-E02-S01-T05\n- **Module:** INFRA - Infrastructure & Environment  \n- **Epic:** Containerize Vision Services  \n- **Story:** Create Vision Service Container  \n- **Phase:** 1\n- **Prerequisites:** INFRA-E02-S01-T04\n\n### Description\r\nCreate a docker-compose.yml file that defines the vision service with GPU access, health checks, and proper networking.\r\n\r\n### Acceptance Criteria\r\n- [ ] docker-compose.yml exists at project root\r\n- [ ] Vision service is defined with GPU access\r\n- [ ] Health check is configured\r\n- [ ] Volumes are mounted for model weights\r\n- [ ] Environment variables are properly set\r\n- [ ] `docker-compose up` starts the service\r\n\r\n### Implementation Details\r\n```yaml\r\n# docker-compose.yml\r\nversion: '3.8'\r\n\r\nservices:\r\n  vision:\r\n    build:\r\n      context: ./services/vision\r\n      dockerfile: Dockerfile\r\n    container_name: suit-ai-vision\r\n    runtime: nvidia\r\n    environment:\r\n      - NVIDIA_VISIBLE_DEVICES=all\r\n      - NVIDIA_DRIVER_CAPABILITIES=compute,utility\r\n      - CUDA_VISIBLE_DEVICES=0\r\n      - MODEL_PATH=/models\r\n      - LOG_LEVEL=INFO\r\n    volumes:\r\n      - ./models:/models:ro\r\n      - ./data:/data\r\n    ports:\r\n      - \"8000:8000\"\r\n    healthcheck:\r\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8000/health\"]\r\n      interval: 30s\r\n      timeout: 10s\r\n      retries: 3\r\n      start_period: 60s\r\n    deploy:\r\n      resources:\r\n        reservations:\r\n          devices:\r\n            - driver: nvidia\r\n              count: 1\r\n              capabilities: [gpu]\r\n    restart: unless-stopped\r\n\r\n  # Redis for caching (optional)\r\n  redis:\r\n    image: redis:7-alpine\r\n    container_name: suit-ai-redis\r\n    ports:\r\n      - \"6379:6379\"\r\n    volumes:\r\n      - redis-data:/data\r\n\r\nvolumes:\r\n  redis-data:\r\n```\r\n\r\n### Verification\r\n```bash\r\n# Start services\r\ndocker-compose up -d\r\n\r\n# Check status\r\ndocker-compose ps\r\n\r\n# Check logs\r\ndocker-compose logs vision\r\n\r\n# Test health endpoint\r\ncurl http://localhost:8000/health\r\n```\r\n\r\n### Defin\n\n---\n**Branches:**\n- `vk/7bb4-infra-e02-s01-t0`\n",
    "branches": [
      "vk/7bb4-infra-e02-s01-t0"
    ]
  },
  {
    "title": "INFRA-E02-S01-T04: Configure GPU Passthrough",
    "status": "inprogress",
    "labels": [
      "in-progress",
      "infra"
    ],
    "body": "## Metadata\n- **Task ID:** INFRA-E02-S01-T04\n- **Module:** INFRA - Infrastructure & Environment  \n- **Epic:** Containerize Vision Services  \n- **Story:** Create Vision Service Container  \n- **Phase:** 1\n- **Prerequisites:** INFRA-E02-S01-T03\n\n### Description\r\nConfigure Docker to pass through the NVIDIA GPU to containers using the nvidia-container-runtime.\r\n\r\n### Acceptance Criteria\r\n- [ ] nvidia-container-toolkit is installed\r\n- [ ] Docker daemon is configured for NVIDIA runtime\r\n- [ ] Container can access GPU via `--gpus all` flag\r\n- [ ] `nvidia-smi` works inside container\r\n\r\n### Implementation Details\r\n```bash\r\n# Install NVIDIA Container Toolkit\r\ndistribution=$(. /etc/os-release;echo $ID$VERSION_ID)\r\ncurl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | sudo apt-key add -\r\ncurl -s -L https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list | \\\r\n    sudo tee /etc/apt/sources.list.d/nvidia-docker.list\r\n\r\nsudo apt-get update\r\nsudo apt-get install -y nvidia-container-toolkit\r\n\r\n# Configure Docker daemon\r\nsudo nvidia-ctk runtime configure --runtime=docker\r\nsudo systemctl restart docker\r\n\r\n# Test GPU access\r\ndocker run --rm --gpus all nvidia/cuda:12.8.0-base-ubuntu22.04 nvidia-smi\r\n```\r\n\r\n### Definition of Done\r\nContainer can access GPU with `docker run --gpus all`",
    "branches": []
  },
  {
    "title": "INFRA-E02-S01-T03: Install Vision Dependencies",
    "status": "inreview",
    "labels": [
      "in-review",
      "infra"
    ],
    "body": "## Metadata\n- **Task ID:** INFRA-E02-S01-T03\n- **Module:** INFRA - Infrastructure & Environment  \n- **Epic:** Containerize Vision Services  \n- **Story:** Create Vision Service Container  \n- **Phase:** 1\n- **Prerequisites:** INFRA-E02-S01-T02\n\n### Description\r\nInstall all computer vision and 3D mesh processing libraries required for the body scanning pipeline.\r\n\r\n### Acceptance Criteria\r\n- [ ] OpenCV is installed and importable\r\n- [ ] SMPL-X is installed and importable\r\n- [ ] SHAPY is installed and importable\r\n- [ ] trimesh is installed and importable\r\n- [ ] pytorch3d is installed and importable\r\n- [ ] detectron2 is installed and importable\r\n\r\n### Implementation Details\r\n```txt\r\n# Add to services/vision/requirements.txt\r\nopencv-python>=4.8.0\r\nopencv-contrib-python>=4.8.0\r\nsmplx>=0.1.28\r\ntrimesh>=4.0.0\r\nscipy>=1.11.0\r\nnumpy>=1.24.0\r\npillow>=10.0.0\r\nchumpy  # Required for SMPL\r\n\r\n# pytorch3d - install from source for CUDA 12.8\r\n# detectron2 - install from source\r\n```\r\n\r\n```dockerfile\r\n# Add to Dockerfile for pytorch3d and detectron2\r\nRUN pip3 install --user 'git+https://github.com/facebookresearch/pytorch3d.git'\r\nRUN pip3 install --user 'git+https://github.com/facebookresearch/detectron2.git'\r\n```\r\n\r\n### Verification Script\r\n```python\r\n# test_imports.py\r\nimports = [\r\n    'cv2',\r\n    'smplx', \r\n    'trimesh',\r\n    'torch',\r\n    'pytorch3d',\r\n    'detectron2'\r\n]\r\n\r\nfor module in imports:\r\n    try:\r\n        __import__(module)\r\n        print(f\"\u2713 {module}\")\r\n    except ImportError as e:\r\n        print(f\"\u2717 {module}: {e}\")\r\n```\r\n\r\n### Definition of Done\r\nAll imports succeed without errors\n\n---\n**Branches:**\n- `vk/cbe6-infra-e02-s01-t0`\n",
    "branches": [
      "vk/cbe6-infra-e02-s01-t0"
    ]
  },
  {
    "title": "INFRA-E02-S01-T02: Install PyTorch Nightly",
    "status": "inreview",
    "labels": [
      "in-review",
      "infra"
    ],
    "body": "## Metadata\n- **Task ID:** INFRA-E02-S01-T02\n- **Module:** INFRA - Infrastructure & Environment  \n- **Epic:** Containerize Vision Services  \n- **Story:** Create Vision Service Container  \n- **Phase:** 1\n- **Prerequisites:** INFRA-E02-S01-T01\n\n### Description\r\nInstall PyTorch nightly build with CUDA 12.8 support inside the Docker container.\r\n\r\n### Acceptance Criteria\r\n- [ ] PyTorch nightly with cu128 is in requirements.txt\r\n- [ ] `torch.cuda.is_available()` returns True inside container\r\n- [ ] PyTorch version supports CUDA 12.8\r\n\r\n### Implementation Details\r\n```txt\r\n# services/vision/requirements.txt\r\n--extra-index-url https://download.pytorch.org/whl/nightly/cu128\r\ntorch\r\ntorchvision\r\ntorchaudio\r\n```\r\n\r\n### Verification Script\r\n```python\r\n# test_pytorch.py\r\nimport torch\r\nprint(f\"PyTorch: {torch.__version__}\")\r\nprint(f\"CUDA available: {torch.cuda.is_available()}\")\r\nif torch.cuda.is_available():\r\n    print(f\"CUDA version: {torch.version.cuda}\")\r\n    print(f\"Device: {torch.cuda.get_device_name(0)}\")\r\n```\r\n\r\n### Definition of Done\r\n`torch.cuda.is_available()` returns True inside container\n\n---\n**Branches:**\n- `vk/6f3f-infra-e02-s01-t0`\n",
    "branches": [
      "vk/6f3f-infra-e02-s01-t0"
    ]
  },
  {
    "title": "INFRA-E02-S01-T01: Create Vision Dockerfile",
    "status": "inreview",
    "labels": [
      "in-review",
      "infra"
    ],
    "body": "## Metadata\n- **Task ID:** INFRA-E02-S01-T01\n- **Module:** INFRA - Infrastructure & Environment  \n- **Epic:** Containerize Vision Services  \n- **Story:** Create Vision Service Container  \n- **Phase:** 1\n- **Prerequisites:** INFRA-E01 complete\n\n### Description\r\nCreate a Dockerfile for the vision service using nvidia/cuda:12.8-devel-ubuntu22.04 as base image.\r\n\r\n### Acceptance Criteria\r\n- [ ] Dockerfile exists at `services/vision/Dockerfile`\r\n- [ ] Base image is nvidia/cuda:12.8-devel-ubuntu22.04\r\n- [ ] Python 3.10 is installed\r\n- [ ] Non-root user is created for security\r\n- [ ] Dockerfile builds without errors\r\n\r\n### Implementation Details\r\n```dockerfile\r\n# services/vision/Dockerfile\r\nFROM nvidia/cuda:12.8.0-devel-ubuntu22.04\r\n\r\n# Prevent interactive prompts\r\nENV DEBIAN_FRONTEND=noninteractive\r\n\r\n# Install system dependencies\r\nRUN apt-get update && apt-get install -y \\\r\n    python3.10 \\\r\n    python3-pip \\\r\n    python3.10-venv \\\r\n    git \\\r\n    wget \\\r\n    libgl1-mesa-glx \\\r\n    libglib2.0-0 \\\r\n    libsm6 \\\r\n    libxext6 \\\r\n    libxrender-dev \\\r\n    && rm -rf /var/lib/apt/lists/*\r\n\r\n# Create non-root user\r\nRUN useradd -m -u 1000 visionuser\r\nUSER visionuser\r\nWORKDIR /home/visionuser/app\r\n\r\n# Set Python path\r\nENV PATH=\"/home/visionuser/.local/bin:$PATH\"\r\n\r\n# Copy requirements first for caching\r\nCOPY --chown=visionuser:visionuser requirements.txt .\r\nRUN pip3 install --user -r requirements.txt\r\n\r\n# Copy application code\r\nCOPY --chown=visionuser:visionuser . .\r\n\r\n# Expose port for API\r\nEXPOSE 8000\r\n\r\n# Health check\r\nHEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\r\n    CMD curl -f http://localhost:8000/health || exit 1\r\n\r\nCMD [\"python3\", \"-m\", \"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\", \"--port\", \"8000\"]\r\n```\r\n\r\n### Definition of Done\r\n`docker build -t suit-ai-vision .` completes successfully\n\n---\n**Branches:**\n- `vk/5032-infra-e02-s01-t0`\n",
    "branches": [
      "vk/5032-infra-e02-s01-t0"
    ]
  },
  {
    "title": "INFRA-E01-S02-T03: Install NVIDIA WSL Driver",
    "status": "inprogress",
    "labels": [
      "in-progress",
      "infra"
    ],
    "body": "## Metadata\n- **Task ID:** INFRA-E01-S02-T03\n- **Module:** INFRA - Infrastructure & Environment  \n- **Epic:** GPU Compute Environment  \n- **Story:** Configure Development Environment  \n- **Phase:** 1\n- **Prerequisites:** INFRA-E01-S02-T02\n\n### Description\r\nInstall the NVIDIA WSL driver to enable GPU passthrough from Windows to WSL2 Ubuntu.\r\n\r\n### Acceptance Criteria\r\n- [ ] NVIDIA WSL driver is installed on Windows\r\n- [ ] `nvidia-smi` works inside WSL\r\n- [ ] GPU is visible and accessible from WSL\r\n- [ ] CUDA toolkit works inside WSL\r\n\r\n### Implementation Details\r\n```powershell\r\n# On Windows: Download and install NVIDIA WSL driver\r\n# https://developer.nvidia.com/cuda/wsl\r\n\r\n# Inside WSL: Verify GPU access\r\nnvidia-smi\r\n\r\n# Install CUDA toolkit inside WSL (runtime only, not driver)\r\nwget https://developer.download.nvidia.com/compute/cuda/repos/wsl-ubuntu/x86_64/cuda-keyring_1.1-1_all.deb\r\nsudo dpkg -i cuda-keyring_1.1-1_all.deb\r\nsudo apt-get update\r\nsudo apt-get install cuda-toolkit-12-8 -y\r\n```\r\n\r\n### Definition of Done\r\n`nvidia-smi` inside WSL shows the GPU\n\n---\n**Branches:**\n- `vk/a0a9-infra-e01-s02-t0`\n- `vk/55fe-infra-e01-s02-t0`\n",
    "branches": [
      "vk/a0a9-infra-e01-s02-t0",
      "vk/55fe-infra-e01-s02-t0"
    ]
  },
  {
    "title": "INFRA-E01-S02-T02: Configure WSL Resources",
    "status": "inreview",
    "labels": [
      "in-review",
      "infra"
    ],
    "body": "## Metadata\n- **Task ID:** INFRA-E01-S02-T02\n- **Module:** INFRA - Infrastructure & Environment  \n- **Epic:** GPU Compute Environment  \n- **Story:** Configure Development Environment  \n- **Phase:** 1\n- **Prerequisites:** INFRA-E01-S02-T01\n\n### Description\r\nConfigure WSL2 memory and processor limits via .wslconfig to prevent resource exhaustion on the host machine.\r\n\r\n### Acceptance Criteria\r\n- [ ] `.wslconfig` file exists in Windows user home\r\n- [ ] Memory limit is set (recommended: 8-16GB)\r\n- [ ] Processor limit is set (recommended: 4-8 cores)\r\n- [ ] Swap is configured\r\n- [ ] Settings apply after WSL restart\r\n\r\n### Implementation Details\r\n```powershell\r\n# Create .wslconfig in Windows user home\r\n# Location: C:\\Users\\<username>\\.wslconfig\r\n\r\n@\"\r\n[wsl2]\r\nmemory=16GB\r\nprocessors=8\r\nswap=4GB\r\nlocalhostForwarding=true\r\n\r\n[experimental]\r\nsparseVhd=true\r\n\"@ | Out-File -FilePath \"$env:USERPROFILE\\.wslconfig\" -Encoding UTF8\r\n\r\n# Restart WSL to apply\r\nwsl --shutdown\r\nwsl\r\n```\r\n\r\n### Verification\r\n```bash\r\n# Inside WSL, check available memory\r\nfree -h\r\n\r\n# Check CPU cores\r\nnproc\r\n```\r\n\r\n### Definition of Done\r\nWSL runs within configured resource limits\n\n---\n**Branches:**\n- `vk/ed1d-infra-e01-s02-t0`\n",
    "branches": [
      "vk/ed1d-infra-e01-s02-t0"
    ]
  },
  {
    "title": "INFRA-E01-S02-T01: Install WSL2",
    "status": "inreview",
    "labels": [
      "in-review",
      "infra"
    ],
    "body": "## Metadata\n- **Task ID:** INFRA-E01-S02-T01\n- **Module:** INFRA - Infrastructure & Environment  \n- **Epic:** GPU Compute Environment  \n- **Story:** Configure Development Environment  \n- **Phase:** 1\n- **Prerequisites:** None\n\n### Description\r\nInstall Windows Subsystem for Linux 2 with Ubuntu 22.04 for local development on Windows 11 machines.\r\n\r\n### Acceptance Criteria\r\n- [ ] WSL2 is enabled on Windows 11\r\n- [ ] Ubuntu 22.04 is installed as default distribution\r\n- [ ] `wsl --list --verbose` shows Ubuntu with VERSION 2\r\n- [ ] Can access Windows files from `/mnt/c/`\r\n\r\n### Implementation Details\r\n```powershell\r\n# Run in PowerShell as Administrator\r\n\r\n# Enable WSL\r\nwsl --install\r\n\r\n# Set WSL2 as default\r\nwsl --set-default-version 2\r\n\r\n# Install Ubuntu 22.04\r\nwsl --install -d Ubuntu-22.04\r\n\r\n# Verify installation\r\nwsl --list --verbose\r\n```\r\n\r\n### Expected Output\r\n```\r\n  NAME            STATE           VERSION\r\n* Ubuntu-22.04    Running         2\r\n```\r\n\r\n### Definition of Done\r\n`wsl --list` shows Ubuntu-22.04 with VERSION 2\n\n---\n**Branches:**\n- `vk/8d6d-infra-e01-s02-t0`\n- `vk/93d7-infra-e01-s02-t0`\n",
    "branches": [
      "vk/8d6d-infra-e01-s02-t0",
      "vk/93d7-infra-e01-s02-t0"
    ]
  },
  {
    "title": "INFRA-E01-S01-T04: Verify GPU Access",
    "status": "inreview",
    "labels": [
      "in-review",
      "infra"
    ],
    "body": "## Metadata\n- **Task ID:** INFRA-E01-S01-T04\n- **Module:** INFRA - Infrastructure & Environment  \n- **Epic:** GPU Compute Environment  \n- **Story:** Provision and Configure GPU Server  \n- **Phase:** 1\n- **Prerequisites:** INFRA-E01-S01-T03\n\n### Description\r\nVerify that PyTorch can access the GPU by running a CUDA test. This confirms the entire GPU stack is working.\r\n\r\n### Acceptance Criteria\r\n- [ ] Python 3.10+ is installed\r\n- [ ] PyTorch with CUDA support is installed\r\n- [ ] `torch.cuda.is_available()` returns True\r\n- [ ] `torch.cuda.get_device_name(0)` returns \"NVIDIA RTX 5090\"\r\n- [ ] Simple tensor operation runs on GPU\r\n\r\n### Implementation Details\r\n```bash\r\n# Install Python and pip\r\nsudo apt-get install python3.10 python3-pip -y\r\n\r\n# Install PyTorch with CUDA 12.8 support\r\npip3 install --pre torch torchvision torchaudio --index-url https://download.pytorch.org/whl/nightly/cu128\r\n\r\n# Create test script\r\ncat << 'EOF' > test_gpu.py\r\nimport torch\r\n\r\nprint(f\"PyTorch version: {torch.__version__}\")\r\nprint(f\"CUDA available: {torch.cuda.is_available()}\")\r\nprint(f\"CUDA version: {torch.version.cuda}\")\r\nprint(f\"Device count: {torch.cuda.device_count()}\")\r\nprint(f\"Device name: {torch.cuda.get_device_name(0)}\")\r\n\r\n# Test tensor operation\r\nx = torch.randn(1000, 1000).cuda()\r\ny = torch.randn(1000, 1000).cuda()\r\nz = torch.matmul(x, y)\r\nprint(f\"Matrix multiplication on GPU successful: {z.shape}\")\r\nEOF\r\n\r\npython3 test_gpu.py\r\n```\r\n\r\n### Expected Output\r\n```\r\nPyTorch version: 2.x.x+cu128\r\nCUDA available: True\r\nCUDA version: 12.8\r\nDevice count: 1\r\nDevice name: NVIDIA RTX 5090\r\nMatrix multiplication on GPU successful: torch.Size([1000, 1000])\r\n```\r\n\r\n### Definition of Done\r\n`torch.cuda.is_available()` returns True\n\n---\n**Branches:**\n- `vk/3fdc-infra-e01-s01-t0`\n",
    "branches": [
      "vk/3fdc-infra-e01-s01-t0"
    ]
  },
  {
    "title": "INFRA-E01-S01-T03: Install CUDA Toolkit",
    "status": "inreview",
    "labels": [
      "in-review",
      "infra"
    ],
    "body": "## Metadata\n- **Task ID:** INFRA-E01-S01-T03\n- **Module:** INFRA - Infrastructure & Environment  \n- **Epic:** GPU Compute Environment  \n- **Story:** Provision and Configure GPU Server  \n- **Phase:** 1\n- **Prerequisites:** INFRA-E01-S01-T02\n\n### Description\r\nInstall CUDA 12.8 toolkit system-wide to enable GPU-accelerated computing for PyTorch and vision libraries.\r\n\r\n### Acceptance Criteria\r\n- [ ] CUDA 12.8 is installed at `/usr/local/cuda-12.8`\r\n- [ ] `nvcc --version` returns 12.8\r\n- [ ] CUDA paths are in system PATH\r\n- [ ] CUDA samples compile and run\r\n\r\n### Implementation Details\r\n```bash\r\n# Download CUDA 12.8 installer\r\nwget https://developer.download.nvidia.com/compute/cuda/12.8.0/local_installers/cuda_12.8.0_570.86.16_linux.run\r\n\r\n# Install (driver already installed, skip driver)\r\nsudo sh cuda_12.8.0_570.86.16_linux.run --toolkit --silent\r\n\r\n# Add to PATH in ~/.bashrc\r\necho 'export PATH=/usr/local/cuda-12.8/bin:$PATH' >> ~/.bashrc\r\necho 'export LD_LIBRARY_PATH=/usr/local/cuda-12.8/lib64:$LD_LIBRARY_PATH' >> ~/.bashrc\r\nsource ~/.bashrc\r\n\r\n# Verify\r\nnvcc --version\r\n```\r\n\r\n### Expected Output\r\n```\r\nnvcc: NVIDIA (R) Cuda compiler driver\r\nCopyright (c) 2005-2024 NVIDIA Corporation\r\nBuilt on xxx\r\nCuda compilation tools, release 12.8, V12.8.xxx\r\n```\r\n\r\n### Definition of Done\r\n`nvcc --version` returns 12.8\n\n---\n**Branches:**\n- `vk/9f34-infra-e01-s01-t0`\n",
    "branches": [
      "vk/9f34-infra-e01-s01-t0"
    ]
  },
  {
    "title": "INFRA-E01-S01-T02: Install NVIDIA Driver",
    "status": "inreview",
    "labels": [
      "in-review",
      "infra"
    ],
    "body": "## Metadata\n- **Task ID:** INFRA-E01-S01-T02\n- **Module:** INFRA - Infrastructure & Environment  \n- **Epic:** GPU Compute Environment  \n- **Story:** Provision and Configure GPU Server  \n- **Phase:** 1\n- **Prerequisites:** INFRA-E01-S01-T01\n\n### Description\r\nInstall NVIDIA driver version 570.86.16 or higher to support RTX 5090 (Blackwell architecture) and CUDA 12.8.\r\n\r\n### Acceptance Criteria\r\n- [ ] NVIDIA driver 570.86.16+ is installed\r\n- [ ] `nvidia-smi` command works and shows RTX 5090\r\n- [ ] Driver persists after reboot\r\n- [ ] No nouveau driver conflicts\r\n\r\n### Implementation Details\r\n```bash\r\n# Remove existing drivers\r\nsudo apt-get purge nvidia* -y\r\nsudo apt-get autoremove -y\r\n\r\n# Add NVIDIA repository\r\nsudo add-apt-repository ppa:graphics-drivers/ppa -y\r\nsudo apt-get update\r\n\r\n# Install driver\r\nsudo apt-get install nvidia-driver-570 -y\r\n\r\n# Reboot and verify\r\nsudo reboot\r\nnvidia-smi\r\n```\r\n\r\n### Expected Output\r\n```\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 570.86.16    Driver Version: 570.86.16    CUDA Version: 12.8     |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  NVIDIA RTX 5090     Off  | 00000000:00:1E.0 Off |                    0 |\r\n| N/A   35C    P0    25W / 450W |      0MiB / 32768MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n```\r\n\r\n### Definition of Done\r\n`nvidia-smi` shows RTX 5090 with driver 570.86.16+\n\n---\n**Branches:**\n- `vk/2646-infra-e01-s01-t0`\n",
    "branches": [
      "vk/2646-infra-e01-s01-t0"
    ]
  },
  {
    "title": "INFRA-E01-S01-T01: Provision GPU Instance",
    "status": "inreview",
    "labels": [
      "in-review",
      "infra"
    ],
    "body": "Allocate an AWS EC2 g4dn.xlarge instance with NVIDIA RTX 5090 GPU running Ubuntu 22.04 LTS. This will serve as the primary compute server for the vision pipeline.\n\n## Acceptance Criteria\n- [ ] EC2 instance is running and accessible via SSH\n- [ ] Instance type is g4dn.xlarge or equivalent with RTX 5090\n- [ ] Ubuntu 22.04 LTS is installed\n- [ ] Security group allows SSH (port 22) from authorized IPs\n- [ ] Elastic IP is attached for stable addressing\n\n## Implementation Details\n```bash\n# AWS CLI command to launch instance\naws ec2 run-instances \\\n  --image-id ami-0xxx # Ubuntu 22.04 LTS AMI\n  --instance-type g4dn.xlarge \\\n  --key-name suit-ai-key \\\n  --security-group-ids sg-xxx \\\n  --subnet-id subnet-xxx \\\n  --tag-specifications 'ResourceType=instance,Tags=[{Key=Name,Value=suit-ai-vision}]'\n```\n\n## Definition of Done\nInstance accessible via SSH with `ssh -i suit-ai-key.pem ubuntu@<elastic-ip>`\n\n## Metadata\n- Module: INFRA - Infrastructure & Environment\n- Epic: GPU Compute Environment\n- Story: Provision and Configure GPU Server\n- Phase: 1\n- Prerequisites: None\n- Task ID: INFRA-E01-S01-T01\n\n---\n**Branches:**\n- `vk/3328-infra-e01-s01-t0`\n",
    "branches": [
      "vk/3328-infra-e01-s01-t0"
    ]
  },
  {
    "title": "INFRA-E01-S01-T01: Provision GPU Instance",
    "status": "inreview",
    "labels": [
      "in-review",
      "infra"
    ],
    "body": "Allocate an AWS EC2 g4dn.xlarge instance with NVIDIA RTX 5090 GPU running Ubuntu 22.04 LTS. This will serve as the primary compute server for the vision pipeline.\n\n## Acceptance Criteria\n- [ ] EC2 instance is running and accessible via SSH\n- [ ] Instance type is g4dn.xlarge or equivalent with RTX 5090\n- [ ] Ubuntu 22.04 LTS is installed\n- [ ] Security group allows SSH (port 22) from authorized IPs\n- [ ] Elastic IP is attached for stable addressing\n\n## Implementation Details\n```bash\n# AWS CLI command to launch instance\naws ec2 run-instances \\\n  --image-id ami-0xxx # Ubuntu 22.04 LTS AMI\n  --instance-type g4dn.xlarge \\\n  --key-name suit-ai-key \\\n  --security-group-ids sg-xxx \\\n  --subnet-id subnet-xxx \\\n  --tag-specifications 'ResourceType=instance,Tags=[{Key=Name,Value=suit-ai-vision}]'\n```\n\n## Definition of Done\nInstance accessible via SSH with `ssh -i suit-ai-key.pem ubuntu@<elastic-ip>`\n\n## Metadata\n- Module: INFRA - Infrastructure & Environment\n- Epic: GPU Compute Environment\n- Story: Provision and Configure GPU Server\n- Phase: 1\n- Prerequisites: None\n- Task ID: INFRA-E01-S01-T01\n\n---\n**Branches:**\n- `vk/bb49-infra-e01-s01-t0`\n- `vk/a520-infra-e01-s01-t0`\n- `vk/20f3-infra-e01-s01-t0`\n",
    "branches": [
      "vk/bb49-infra-e01-s01-t0",
      "vk/a520-infra-e01-s01-t0",
      "vk/20f3-infra-e01-s01-t0"
    ]
  }
]